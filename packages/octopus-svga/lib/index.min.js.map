{"version":3,"file":"index.min.js","sources":["../../../node_modules/.pnpm/@rollup+plugin-typescript@12.1.4_rollup@4.45.1_tslib@2.8.1_typescript@5.8.3/node_modules/tslib/tslib.es6.js","../../octopus-platform/esm/index.js","../src/platform/index.ts","../src/extensions/resource-manager/index.ts","../src/extensions/svga-decoder/io/float.ts","../src/extensions/svga-decoder/io/preflight.ts","../src/shared/hash.ts","../src/extensions/svga-decoder/io/Reader.ts","../src/extensions/svga-decoder/serialization/Layout.ts","../src/extensions/svga-decoder/serialization/Transform.ts","../src/extensions/svga-decoder/serialization/ShapeArgs.ts","../src/extensions/svga-decoder/serialization/RectArgs.ts","../src/extensions/svga-decoder/serialization/EllipseArgs.ts","../src/extensions/svga-decoder/serialization/RGBAColor.ts","../src/extensions/svga-decoder/serialization/ShapeStyle.ts","../src/extensions/svga-decoder/serialization/ShapeEntity.ts","../src/extensions/svga-decoder/serialization/FrameEntity.ts","../src/extensions/svga-decoder/serialization/SpriteEntity.ts","../src/extensions/svga-decoder/serialization/MovieParams.ts","../src/extensions/svga-decoder/serialization/MovieEntity.ts","../src/shared/PointPool.ts","../src/extensions/svga-renderer/2d/index.ts","../src/extensions/svga-animator/index.ts","../src/extensions/zlib/index.ts","../src/extensions/png-encoder/crc.ts","../src/extensions/qrcode-encoder/math.ts","../src/extensions/png-encoder/index.ts","../src/extensions/qrcode-encoder/bit-buffer.ts","../src/extensions/qrcode-encoder/constants.ts","../src/extensions/qrcode-encoder/bit-byte.ts","../src/extensions/qrcode-encoder/block.ts","../src/extensions/qrcode-encoder/polynomial.ts","../src/extensions/qrcode-encoder/util.ts","../src/extensions/qrcode-encoder/index.ts","../src/core/parser/index.ts","../src/extensions/svga-decoder/index.ts","../src/core/painter/index.ts","../src/core/player/config.ts","../src/core/player/index.ts","../src/core/poster/index.ts","../src/helper/qrcode.ts","../src/helper/png.ts","../src/helper/VideoManager.ts","../src/helper/VideoEditor.ts","../src/helper/zlib.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n","const noop = (() => { });\n\nfunction delay(callback, interval) {\n    return new Promise((resolve) => setTimeout(() => resolve(callback()), interval));\n}\nasync function retry(fn, intervals = [], \n/*\n * @private 不建议外部传入\n */\ntimes = 0) {\n    try {\n        return fn();\n    }\n    catch (err) {\n        if (times >= intervals.length) {\n            throw err;\n        }\n        return delay(() => retry(fn, intervals, ++times), intervals[times]);\n    }\n}\n\n// 使用静态缓冲区，避免重复创建\nconst BUFFER_SIZE = 4096; // 更大的缓冲区，减少字符串拼接次数\nconst STATIC_BUFFER = new Uint16Array(BUFFER_SIZE); // 预分配ASCII缓冲区\n/**\n * 优化的 UTF-8 解码函数\n * 主要优化点：\n * 1. 使用静态缓冲区减少内存分配\n * 2. 批量处理 ASCII 字符\n * 3. 优化循环结构和条件判断\n * 4. 使用 Uint16Array 代替普通数组提高性能\n */\nfunction utf8(buffer, start, end) {\n    // 边界检查\n    if (start < 0 || end > buffer.length)\n        throw new RangeError(\"Index out of range\");\n    if (end - start < 1)\n        return \"\";\n    const resultParts = [];\n    let bufferPos = 0;\n    const appendBuffer = (parts) => {\n        resultParts.push(String.fromCharCode.apply(null, Array.from(parts)));\n    };\n    // 快速路径：检查是否全是 ASCII\n    let allAscii = true;\n    for (let i = start; i < end; i++) {\n        if (buffer[i] > 0x7F) {\n            allAscii = false;\n            break;\n        }\n    }\n    // 全 ASCII 优化路径\n    if (allAscii) {\n        for (let i = start; i < end; i += BUFFER_SIZE) {\n            const chunkEnd = Math.min(i + BUFFER_SIZE, end);\n            const len = chunkEnd - i;\n            // 直接复制到 Uint16Array\n            for (let j = 0; j < len; j++) {\n                STATIC_BUFFER[j] = buffer[i + j];\n            }\n            appendBuffer(STATIC_BUFFER.subarray(0, len));\n        }\n        return resultParts.join('');\n    }\n    // 混合内容处理\n    for (let i = start; i < end;) {\n        const byte = buffer[i++];\n        // ASCII 字符处理\n        if (byte < 0x80) {\n            STATIC_BUFFER[bufferPos++] = byte;\n            // 如果缓冲区满了，提交并清空\n            if (bufferPos === BUFFER_SIZE) {\n                appendBuffer(STATIC_BUFFER);\n                bufferPos = 0;\n            }\n            continue;\n        }\n        // 提交之前的 ASCII 字符\n        if (bufferPos > 0) {\n            appendBuffer(STATIC_BUFFER.subarray(0, bufferPos));\n            bufferPos = 0;\n        }\n        // 变长编码处理 - 使用查表法代替多个条件判断\n        let codePoint;\n        // 2 字节序列: 110xxxxx 10xxxxxx\n        if ((byte & 0xE0) === 0xC0 && i < end) {\n            codePoint = ((byte & 0x1F) << 6) | (buffer[i++] & 0x3F);\n        }\n        // 3 字节序列: 1110xxxx 10xxxxxx 10xxxxxx\n        else if ((byte & 0xF0) === 0xE0 && i + 1 < end) {\n            codePoint = ((byte & 0x0F) << 12) |\n                ((buffer[i++] & 0x3F) << 6) |\n                (buffer[i++] & 0x3F);\n        }\n        // 4 字节序列: 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n        else if ((byte & 0xF8) === 0xF0 && i + 2 < end) {\n            codePoint = ((byte & 0x07) << 18) |\n                ((buffer[i++] & 0x3F) << 12) |\n                ((buffer[i++] & 0x3F) << 6) |\n                (buffer[i++] & 0x3F);\n            // 处理 Unicode 代理对\n            if (codePoint > 0xFFFF) {\n                codePoint -= 0x10000;\n                STATIC_BUFFER[bufferPos++] = 0xD800 + (codePoint >> 10);\n                STATIC_BUFFER[bufferPos++] = 0xDC00 + (codePoint & 0x3FF);\n                // 检查缓冲区是否需要提交\n                if (bufferPos >= BUFFER_SIZE - 2) { // 预留空间给下一个可能的代理对\n                    appendBuffer(STATIC_BUFFER.subarray(0, bufferPos));\n                    bufferPos = 0;\n                }\n                continue;\n            }\n        }\n        // 无效的 UTF-8 序列\n        else {\n            codePoint = 0xFFFD; // Unicode 替换字符\n            // 跳过可能的后续字节\n            while (i < end && (buffer[i] & 0xC0) === 0x80)\n                i++;\n        }\n        STATIC_BUFFER[bufferPos++] = codePoint;\n        // 检查缓冲区是否需要提交\n        if (bufferPos >= BUFFER_SIZE - 3) { // 预留空间给下一个可能的多字节字符\n            appendBuffer(STATIC_BUFFER.subarray(0, bufferPos));\n            bufferPos = 0;\n        }\n    }\n    // 提交剩余字符\n    if (bufferPos > 0) {\n        appendBuffer(STATIC_BUFFER.subarray(0, bufferPos));\n    }\n    return resultParts.join('');\n}\n\nclass OctopusPlatform {\n    /**\n     * 插件列表\n     */\n    plugins = [];\n    /**\n     * 平台版本\n     */\n    platformVersion = \"0.1.2\";\n    /**\n     * 应用版本\n     */\n    version = \"\";\n    /**\n     * 全局变量\n     */\n    globals = {\n        env: \"unknown\",\n        br: null,\n        dpr: 1,\n        system: \"unknown\",\n    };\n    noop = noop;\n    retry = retry;\n    constructor(plugins, version) {\n        this.version = version || \"\";\n        this.plugins = plugins;\n        this.globals.env = this.autoEnv();\n    }\n    init() {\n        const { globals, plugins } = this;\n        const collection = new Map();\n        const names = [];\n        const installedPlugins = new Set();\n        globals.br = this.useBridge();\n        globals.dpr = this.usePixelRatio();\n        globals.system = this.useSystem();\n        for (const plugin of plugins) {\n            names.push(plugin.name);\n            collection.set(plugin.name, plugin);\n        }\n        this.usePlugins(collection, names, installedPlugins);\n        installedPlugins.clear();\n    }\n    autoEnv() {\n        // FIXME：由于抖音场景支持wx对象，所以需要放在wx对象之前检查\n        if (typeof window !== \"undefined\") {\n            return \"h5\";\n        }\n        if (typeof tt !== \"undefined\") {\n            return \"tt\";\n        }\n        if (typeof my !== \"undefined\") {\n            return \"alipay\";\n        }\n        if (typeof wx !== \"undefined\") {\n            return \"weapp\";\n        }\n        throw new Error(\"Unsupported platform！\");\n    }\n    useBridge() {\n        switch (this.globals.env) {\n            case \"alipay\":\n                return my;\n            case \"tt\":\n                return tt;\n            case \"weapp\":\n                return wx;\n        }\n        return globalThis;\n    }\n    usePixelRatio() {\n        const { env, br } = this.globals;\n        if (env === \"h5\") {\n            return devicePixelRatio;\n        }\n        if (\"getWindowInfo\" in br) {\n            return br.getWindowInfo().pixelRatio;\n        }\n        if (\"getSystemInfoSync\" in br) {\n            return br.getSystemInfoSync().pixelRatio;\n        }\n        return 1;\n    }\n    useSystem() {\n        const { env } = this.globals;\n        let system;\n        switch (env) {\n            case \"weapp\":\n                system = wx.getDeviceInfo().platform;\n                break;\n            case \"alipay\":\n                system = my.getDeviceBaseInfo().platform;\n                break;\n            case \"tt\":\n                system = tt.getDeviceInfoSync().platform;\n                break;\n            default:\n                system = \"unknown\";\n        }\n        return system.toLowerCase();\n    }\n    usePlugins(plugins, pluginNames, installedPlugins) {\n        for (const pluginName of pluginNames) {\n            if (!plugins.has(pluginName)) {\n                throw new Error(`Plugin ${pluginName} not found`);\n            }\n            if (installedPlugins.has(pluginName)) {\n                return;\n            }\n            const plugin = plugins.get(pluginName);\n            // 递归调用依赖\n            if (Array.isArray(plugin.dependencies)) {\n                for (const dependency of plugin.dependencies) {\n                    if (typeof plugins.get(dependency)?.install !== \"function\") {\n                        throw new Error(`Plugin ${pluginName} depends on plugin ${dependency}, but ${dependency} is not found`);\n                    }\n                }\n                // 递归加载依赖\n                this.usePlugins(plugins, plugin.dependencies, installedPlugins);\n            }\n            this.installPlugin(plugin);\n            installedPlugins.add(pluginName);\n        }\n    }\n    switch(env) {\n        this.globals.env = env;\n        this.init();\n    }\n}\n\n/**\n * 定义平台插件\n */\nconst definePlugin = (plugin) => plugin;\n\nfunction installPlugin(platform, plugin) {\n    const value = plugin.install.call(platform);\n    Object.defineProperty(platform, plugin.name, {\n        get: () => value,\n        enumerable: true,\n        configurable: true,\n    });\n}\n\nvar pluginSelector = definePlugin({\n    name: \"getSelector\",\n    install() {\n        const { env, br } = this.globals;\n        if (env === \"h5\") {\n            return (selector) => document.querySelector(selector);\n        }\n        return (selector, component) => {\n            let query = br.createSelectorQuery();\n            if (component) {\n                query = query.in(component);\n            }\n            return query\n                .select(selector)\n                .fields({ node: true, size: true });\n        };\n    }\n});\n\n/**\n * 通过选择器匹配获取canvas实例\n * @returns\n */\nvar pluginCanvas = definePlugin({\n    name: \"getCanvas\",\n    dependencies: [\"getSelector\"],\n    install() {\n        const { retry, getSelector } = this;\n        const { env, br, dpr } = this.globals;\n        const intervals = [50, 100, 100];\n        function initCanvas(canvas, width, height) {\n            if (!canvas) {\n                throw new Error(\"canvas not found.\");\n            }\n            // const MAX_SIZE = 1365;\n            const context = canvas.getContext(\"2d\");\n            // let virtualWidth = width * dpr;\n            // let virtualHeight = height * dpr;\n            // // 微信小程序限制canvas最大尺寸为 1365 * 1365\n            // if (\n            //   env === \"weapp\" &&\n            //   (virtualWidth > MAX_SIZE || virtualHeight > MAX_SIZE)\n            // ) {\n            //   if (virtualWidth > virtualHeight) {\n            //     virtualHeight = (virtualHeight / virtualWidth) * MAX_SIZE;\n            //     virtualWidth = MAX_SIZE;\n            //   } else {\n            //     virtualWidth = (virtualWidth / virtualHeight) * MAX_SIZE;\n            //     virtualHeight = MAX_SIZE;\n            //   }\n            // }\n            // canvas!.width = virtualWidth;\n            // canvas!.height = virtualHeight;\n            canvas.width = width * dpr;\n            canvas.height = height * dpr;\n            return { canvas, context };\n        }\n        if (env === \"h5\") {\n            return (selector) => retry(() => {\n                // FIXME: Taro 对 canvas 做了特殊处理，canvas 元素的 id 会被加上 canvas-id 的前缀\n                const canvas = (getSelector(`canvas[canvas-id=${selector.slice(1)}]`) || getSelector(selector));\n                return initCanvas(canvas, canvas?.clientWidth, canvas?.clientHeight);\n            }, intervals);\n        }\n        return (selector, component) => retry(() => new Promise((resolve, reject) => {\n            let query = getSelector(selector, component);\n            query.exec((res) => {\n                const { node, width, height } = res[0] || {};\n                try {\n                    resolve(initCanvas(node, width, height));\n                }\n                catch (e) {\n                    reject(e);\n                }\n            });\n        }), intervals);\n    },\n});\n\n/**\n * 用于处理数据解码\n * @returns\n */\nvar pluginDecode = definePlugin({\n    name: \"decode\",\n    install() {\n        const { env, br } = this.globals;\n        const b64Wrap = (b64, type = \"image/png\") => `data:${type};base64,${b64}`;\n        const decode = {\n            toBuffer(data) {\n                const { buffer, byteOffset, byteLength } = data;\n                if (buffer instanceof ArrayBuffer) {\n                    return buffer.slice(byteOffset, byteOffset + byteLength);\n                }\n                const view = new Uint8Array(byteLength);\n                view.set(data);\n                return view.buffer;\n            },\n            bytesToString(data) {\n                const chunkSize = 8192; // 安全的块大小\n                let result = \"\";\n                for (let i = 0; i < data.length; i += chunkSize) {\n                    const chunk = data.slice(i, i + chunkSize);\n                    // 在安全的块上使用 String.fromCharCode\n                    result += String.fromCharCode.apply(null, Array.from(chunk));\n                }\n                return result;\n            },\n        };\n        if (env === \"h5\") {\n            const textDecoder = new TextDecoder(\"utf-8\", { fatal: true });\n            return {\n                ...decode,\n                toDataURL: (data) => b64Wrap(btoa(decode.bytesToString(data))),\n                utf8: (data, start, end) => textDecoder.decode(data.subarray(start, end)),\n            };\n        }\n        return {\n            ...decode,\n            toDataURL: (data) => b64Wrap(br.arrayBufferToBase64(decode.toBuffer(data))),\n            utf8,\n        };\n    },\n});\n\n/**\n * 用于处理远程文件读取\n * @returns\n */\nvar pluginDownload = definePlugin({\n    name: \"remote\",\n    install() {\n        const { env, br } = this.globals;\n        const isRemote = (url) => /^(blob:)?http(s)?:\\/\\//.test(url);\n        if (env === \"h5\") {\n            return {\n                is: isRemote,\n                fetch: (url) => fetch(url).then((response) => {\n                    if (response.ok) {\n                        return response.arrayBuffer();\n                    }\n                    throw new Error(`HTTP error, status=${response.status}, statusText=${response.statusText}`);\n                }),\n            };\n        }\n        function download(url, enableCache) {\n            return new Promise((resolve, reject) => {\n                br.request({\n                    url,\n                    // @ts-ignore 支付宝小程序必须有该字段\n                    dataType: \"arraybuffer\",\n                    responseType: \"arraybuffer\",\n                    enableCache,\n                    success: (res) => resolve(res.data),\n                    fail: reject,\n                });\n            }).catch((err) => {\n                const errorMessage = err.errMsg || err.errorMessage || err.message;\n                // FIXME: 可能存在写入网络缓存空间失败的情况，此时重新下载\n                if (errorMessage.includes(\"ERR_CACHE_WRITE_FAILURE\") ||\n                    errorMessage.includes(\"ERR_CACHE_WRITE_FAILED\")) {\n                    return download(url, false);\n                }\n                throw err;\n            });\n        }\n        return {\n            is: isRemote,\n            fetch: (url) => download(url, true),\n        };\n    },\n});\n\n/**\n * 用于处理本地文件存储\n * @returns\n */\nvar pluginFsm = definePlugin({\n    name: \"local\",\n    install() {\n        const { env, br } = this.globals;\n        if (env === \"h5\" || env === \"tt\") {\n            return null;\n        }\n        const fsm = br.getFileSystemManager();\n        return {\n            exists: (filepath) => new Promise((resolve) => {\n                fsm.access({\n                    path: filepath,\n                    success: () => resolve(true),\n                    fail: () => resolve(false),\n                });\n            }),\n            write: (data, filePath) => new Promise((resolve, reject) => {\n                fsm.writeFile({\n                    filePath,\n                    data,\n                    success: () => resolve(filePath),\n                    fail: reject,\n                });\n            }),\n            read: (filePath) => new Promise((resolve, reject) => {\n                fsm.readFile({\n                    filePath,\n                    success: (res) => resolve(res.data),\n                    fail: reject,\n                });\n            }),\n            remove: (filePath) => new Promise((resolve, reject) => {\n                fsm.unlink({\n                    filePath,\n                    success: () => resolve(filePath),\n                    fail: reject,\n                });\n            }),\n        };\n    },\n});\n\n/**\n * 图片加载插件\n * @package plugin-fsm 本地文件存储能力\n * @package plugin-path 路径处理能力\n * @package plugin-decode 解码能力\n */\nvar pluginImage = definePlugin({\n    name: \"image\",\n    dependencies: [\"local\", \"decode\"],\n    install() {\n        const { local, decode } = this;\n        const { env } = this.globals;\n        let genImageSource = (data, _filepath) => (typeof data === \"string\" ? data : decode.toDataURL(data));\n        /**\n         * 加载图片\n         * @param img\n         * @param url\n         * @returns\n         */\n        function loadImage(img, url) {\n            return new Promise((resolve, reject) => {\n                img.onload = () => resolve(img);\n                img.onerror = () => reject(new Error(`SVGA LOADING FAILURE: ${url}`));\n                img.src = url;\n            });\n        }\n        function releaseImage(img) {\n            img.onload = null;\n            img.onerror = null;\n            img.src = \"\";\n        }\n        if (env === \"h5\") {\n            return {\n                create: (_) => new Image(),\n                load: (createImage, data, filepath) => {\n                    // 由于ImageBitmap在图片渲染上有优势，故优先使用\n                    if (data instanceof Uint8Array && \"createImageBitmap\" in globalThis) {\n                        return createImageBitmap(new Blob([decode.toBuffer(data)]));\n                    }\n                    if (data instanceof ImageBitmap) {\n                        return Promise.resolve(data);\n                    }\n                    return loadImage(createImage(), genImageSource(data, filepath));\n                },\n                release: releaseImage,\n            };\n        }\n        // FIXME: 支付宝小程序IDE保存临时文件会失败;抖音最大用户文件大小为10M\n        if (env === \"weapp\") {\n            genImageSource = async (data, filepath) => {\n                if (typeof data === \"string\") {\n                    return data;\n                }\n                // FIXME: IOS设备 微信小程序 Uint8Array转base64 时间较长，使用图片缓存形式速度会更快\n                return local\n                    .write(decode.toBuffer(data), filepath)\n                    .catch((ex) => {\n                    console.warn(`image write fail: ${ex.errorMessage || ex.errMsg || ex.message}`);\n                    return decode.toDataURL(data);\n                });\n            };\n        }\n        return {\n            create: (canvas) => canvas.createImage(),\n            load: async (createImage, data, filepath) => loadImage(createImage(), await genImageSource(data, filepath)),\n            release: releaseImage,\n        };\n    },\n});\n\nvar pluginNow = definePlugin({\n    name: \"now\",\n    install() {\n        const { env, br } = this.globals;\n        // performance可以提供更高精度的时间测量，且不受系统时间的调整（如更改系统时间或同步时间）的影响\n        const perf = env === \"h5\" || env === \"tt\" ? performance : br.getPerformance();\n        if (typeof perf?.now === \"function\") {\n            // 支付宝小程序的performance.now()获取的是当前时间戳，单位是微秒。\n            if (perf.now() - Date.now() > 1) {\n                return () => perf.now() / 1000;\n            }\n            // H5环境下，performance.now()获取的不是当前时间戳，而是从页面加载开始的时间戳，单位是毫秒。\n            return () => perf.now();\n        }\n        return () => Date.now();\n    },\n});\n\n/**\n * 用于创建离屏canvas\n * @returns\n */\nvar pluginOfsCanvas = definePlugin({\n    name: \"getOfsCanvas\",\n    install() {\n        const { env } = this.globals;\n        let createOffscreenCanvas;\n        if (env === \"h5\") {\n            createOffscreenCanvas = (options) => new OffscreenCanvas(options.width, options.height);\n        }\n        else if (env === \"alipay\") {\n            createOffscreenCanvas = (options) => my.createOffscreenCanvas(options);\n        }\n        else if (env === \"tt\") {\n            createOffscreenCanvas = (options) => {\n                const canvas = tt.createOffscreenCanvas();\n                canvas.width = options.width;\n                canvas.height = options.height;\n                return canvas;\n            };\n        }\n        else {\n            createOffscreenCanvas = (options) => wx.createOffscreenCanvas(options);\n        }\n        return (options) => {\n            const type = options.type || \"2d\";\n            const canvas = createOffscreenCanvas({ ...options, type });\n            const context = canvas.getContext(type);\n            return {\n                canvas,\n                context,\n            };\n        };\n    },\n});\n\n/**\n * 用于处理文件路径\n * @returns\n */\nvar pluginPath = definePlugin({\n    name: \"path\",\n    install() {\n        const { env, br } = this.globals;\n        const filename = (path) => {\n            const filepath = path.split(/\\?#/g)[0];\n            return filepath.substring(filepath.lastIndexOf(\"/\") + 1);\n        };\n        if (env === \"h5\" || env === \"tt\") {\n            return {\n                USER_DATA_PATH: \"\",\n                is: (_) => false,\n                filename,\n                resolve: (filename, prefix) => \"\",\n            };\n        }\n        const { USER_DATA_PATH } = br.env;\n        return {\n            USER_DATA_PATH,\n            is: (filepath) => filepath?.startsWith(USER_DATA_PATH),\n            filename,\n            resolve: (filename, prefix) => `${USER_DATA_PATH}/${prefix ? `${prefix}__` : \"\"}${filename}`,\n        };\n    },\n});\n\n/**\n * 用于处理requestAnimationFrame\n * @returns\n */\nvar pluginRaf = definePlugin({\n    name: \"rAF\",\n    install() {\n        const { env } = this.globals;\n        function requestAnimationFrameImpl() {\n            return (callback) => setTimeout(callback, Math.max(0, 16 - (Date.now() % 16)));\n        }\n        if (env === \"h5\") {\n            const rAF = \"requestAnimationFrame\" in globalThis\n                ? requestAnimationFrame\n                : requestAnimationFrameImpl();\n            return (_, callback) => rAF(callback);\n        }\n        return (canvas, callback) => {\n            // 检查canvas是否存在\n            try {\n                return canvas.requestAnimationFrame(callback);\n            }\n            catch (error) {\n                console.warn(error.message);\n                return requestAnimationFrameImpl()(callback);\n            }\n        };\n    },\n});\n\nvar pluginIntersectionObserver = definePlugin({\n    name: \"walkIn\",\n    install() {\n        const { env, br } = this.globals;\n        const thresholds = [0, 0.5, 1];\n        if (env === \"h5\") {\n            return (callback, selector, options = {}) => {\n                let observer = new IntersectionObserver((entries) => callback(entries[0].intersectionRatio > 0), {\n                    threshold: thresholds,\n                    root: options.root ? document.querySelector(options.root) : null,\n                });\n                if (options.observeAll) {\n                    document.querySelectorAll(selector)?.forEach((element) => observer.observe(element));\n                }\n                else {\n                    const element = document.querySelector(selector);\n                    if (element) {\n                        observer.observe(element);\n                    }\n                }\n                return () => {\n                    observer.disconnect();\n                    observer = null;\n                };\n            };\n        }\n        return (callback, selector, options = {}) => {\n            let observer = br.createIntersectionObserver(options.component, {\n                thresholds,\n                initialRatio: 0,\n                observeAll: options.observeAll,\n                // nativeMode: true,\n            });\n            if (options.root) {\n                observer.relativeTo(options.root);\n            }\n            else {\n                observer.relativeToViewport();\n            }\n            observer.observe(selector, (res) => callback(res.intersectionRatio > 0));\n            return () => {\n                observer.disconnect();\n                observer = null;\n            };\n        };\n    },\n});\n\nexport { OctopusPlatform, definePlugin, installPlugin, pluginCanvas, pluginDecode, pluginDownload, pluginFsm, pluginImage, pluginIntersectionObserver, pluginNow, pluginOfsCanvas, pluginPath, pluginRaf as pluginRAF, pluginSelector };\n//# sourceMappingURL=index.js.map\n","import {\n  type OctopusPlatformPlugins,\n  type OctopusPlatformPluginOptions,\n  OctopusPlatform,\n  installPlugin,\n  pluginSelector,\n  pluginCanvas,\n  pluginOfsCanvas,\n  pluginDecode,\n  pluginDownload,\n  pluginFsm,\n  pluginImage,\n  pluginNow,\n  pluginPath,\n  pluginRAF,\n} from \"octopus-platform\";\n\nexport type PlatformProperties =\n  | \"now\"\n  | \"path\"\n  | \"remote\"\n  | \"local\"\n  | \"decode\"\n  | \"image\"\n  | \"rAF\"\n  | \"getSelector\"\n  | \"getCanvas\"\n  | \"getOfsCanvas\";\n\nclass EnhancedPlatform extends OctopusPlatform<PlatformProperties> {\n  now!: OctopusPlatformPlugins[\"now\"];\n\n  path!: OctopusPlatformPlugins[\"path\"];\n\n  remote!: OctopusPlatformPlugins[\"remote\"];\n\n  local!: OctopusPlatformPlugins[\"local\"];\n\n  decode!: OctopusPlatformPlugins[\"decode\"];\n\n  image!: OctopusPlatformPlugins[\"image\"];\n\n  rAF!: OctopusPlatformPlugins[\"rAF\"];\n\n  getSelector!: OctopusPlatformPlugins[\"getSelector\"];\n\n  getCanvas!: OctopusPlatformPlugins[\"getCanvas\"];\n\n  getOfsCanvas!: OctopusPlatformPlugins[\"getOfsCanvas\"];\n\n  constructor() {\n    super(\n      [\n        pluginSelector,\n        pluginCanvas,\n        pluginOfsCanvas,\n        pluginDecode,\n        pluginDownload,\n        pluginFsm,\n        pluginImage,\n        pluginNow,\n        pluginPath,\n        pluginRAF,\n      ],\n      __VERSION__\n    );\n\n    this.init();\n  }\n\n  installPlugin(\n    plugin: OctopusPlatformPluginOptions<PlatformProperties>\n  ) {\n    installPlugin<PlatformProperties>(this, plugin);\n  }\n}\n\nexport const platform = new EnhancedPlatform();\n","import type { RawImage, PlatformImage, Bitmap } from \"octopus-platform\";\nimport { Painter } from \"../../core/painter\";\nimport { platform } from \"../../platform\";\nimport type { RawImages } from \"../../types\";\n\nexport class ResourceManager {\n  /**\n   * 判断是否是 ImageBitmap\n   * @param img\n   * @returns\n   */\n  private static isBitmap(img: any): boolean {\n    return platform.globals.env === \"h5\" && img instanceof ImageBitmap;\n  }\n\n  /**\n   * 释放内存资源（图片）\n   * @param img\n   */\n  private static releaseOne(img: PlatformImage | ImageBitmap) {\n    if (ResourceManager.isBitmap(img)) {\n      (img as ImageBitmap).close();\n    } else if ((img as PlatformImage).src !== \"\") {\n      // 【微信】将存在本地的文件删除，防止用户空间被占满\n      if (\n        platform.globals.env === \"weapp\" &&\n        (img as PlatformImage).src.includes(\n          platform.path.USER_DATA_PATH\n        )\n      ) {\n        platform.local!.remove((img as PlatformImage).src);\n      }\n\n      platform.image.release(img as PlatformImage);\n    }\n  }\n\n  // FIXME: 微信小程序创建调用太多createImage会导致微信/微信小程序崩溃\n  private caches: Array<PlatformImage | ImageBitmap> = [];\n\n  /**\n   * 动态素材\n   */\n  public readonly dynamicMaterials: Map<string, Bitmap> =\n    new Map();\n\n  /**\n   * 素材\n   */\n  public readonly materials: Map<string, Bitmap> = new Map();\n\n  /**\n   * 已清理Image对象的坐标\n   */\n  private point: number = 0;\n\n  constructor(private readonly painter: Painter) {}\n\n  /**\n   * 创建图片标签\n   * @returns\n   */\n  private createImage(): PlatformImage {\n    let img: PlatformImage | null = null;\n\n    if (this.point > 0) {\n      this.point--;\n      img = this.caches.shift() as PlatformImage;\n    }\n\n    if (!img) {\n      img = platform.image.create(this.painter.F!);\n    }\n\n    this.caches.push(img);\n\n    return img;\n  }\n\n  /**\n   * 将 ImageBitmap 插入到 caches\n   * @param img\n   */\n  private inertBitmapIntoCaches(\n    img: PlatformImage | ImageBitmap\n  ) {\n    if (ResourceManager.isBitmap(img)) {\n      this.caches.push(img);\n    }\n  }\n\n  /**\n   * 加载额外的图片资源\n   * @param source 资源内容/地址\n   * @param filename 文件名称\n   * @returns\n   */\n  public loadExtImage(\n    source: string | Uint8Array,\n    filename: string\n  ): Promise<PlatformImage | ImageBitmap> {\n    return platform.image\n      .load(\n        () => this.createImage(),\n        source,\n        platform.path.resolve(filename, \"ext\")\n      )\n      .then((img) => {\n        this.inertBitmapIntoCaches(img);\n\n        return img;\n      });\n  }\n\n  /**\n   * 加载图片集\n   * @param images 图片数据\n   * @param filename 文件名称\n   * @returns\n   */\n  public async loadImagesWithRecord(\n    images: RawImages,\n    filename: string,\n    type: \"normal\" | \"dynamic\" = \"normal\"\n  ): Promise<void> {\n    const imageAwaits: Promise<void>[] = [];\n    const imageFilename = `${filename.replace(/\\.svga$/g, \"\")}.png`;\n\n    Object.entries(images).forEach(([name, image]) => {\n      // 过滤 1px 透明图\n      if (image instanceof Uint8Array && image.byteLength < 70) {\n        return;\n      }\n\n      const p = platform.image\n        .load(\n          () => this.createImage(),\n          image as RawImage,\n          platform.path.resolve(\n            imageFilename,\n            type === \"dynamic\" ? `dyn_${name}` : name\n          )\n        )\n        .then((img) => {\n          this.inertBitmapIntoCaches(img);\n          if (type === \"dynamic\") {\n            this.dynamicMaterials.set(name, img);\n          } else {\n            this.materials.set(name, img);\n          }\n        });\n\n      imageAwaits.push(p);\n    });\n\n    await Promise.all(imageAwaits);\n  }\n\n  /**\n   * 释放图片资源\n   */\n  public release(): void {\n    // FIXME: 小程序 image 对象需要手动释放内存，否则可能导致小程序崩溃\n    for (const img of this.caches) {\n      ResourceManager.releaseOne(img);\n    }\n\n    this.materials.clear();\n    this.dynamicMaterials.clear();\n    // FIXME: 支付宝小程序 image 修改 src 无法触发 onload 事件\n    platform.globals.env === \"alipay\" ? this.cleanup() : this.tidyUp();\n  }\n\n  /**\n   * 整理图片资源，将重复的图片资源移除\n   */\n  private tidyUp() {\n    // 通过 Set 的去重特性，保持 caches 元素的唯一性\n    this.caches = Array.from(new Set(this.caches));\n    this.point = this.caches.length;\n  }\n\n  /**\n   * 清理图片资源\n   */\n  public cleanup(): void {\n    this.caches.length = 0;\n    this.point = 0;\n  }\n}\n","function readFloatLEImpl() {\n  // 使用静态DataView池\n  const DATA_VIEW_POOL_SIZE = 4;\n  const dataViewPool: DataView[] = Array(DATA_VIEW_POOL_SIZE)\n    .fill(0)\n    .map(() => new DataView(new ArrayBuffer(8))); // 使用8字节支持double\n  let currentViewIndex = 0;\n\n  return function readFloatLE(buf: Uint8Array, pos: number): number {\n    if (pos < 0 || pos + 4 > buf.length)\n      throw new RangeError(\"Index out of range\");\n\n    // 轮换使用DataView池中的实例\n    const view = dataViewPool[currentViewIndex];\n    currentViewIndex = (currentViewIndex + 1) % DATA_VIEW_POOL_SIZE;\n\n    // 直接设置字节，避免创建subarray\n    const u8 = new Uint8Array(view.buffer);\n    u8[0] = buf[pos];\n    u8[1] = buf[pos + 1];\n    u8[2] = buf[pos + 2];\n    u8[3] = buf[pos + 3];\n\n    return view.getFloat32(0, true);\n  };\n}\n\nexport const readFloatLE = readFloatLEImpl();\n","import { calculateHash } from \"../../../shared/hash\";\nimport Reader from \"./Reader\";\n\nexport class Preflight {\n  private caches: Map<string, any> = new Map();\n\n  private count: number = 0;\n\n  get size() {\n    return this.caches.size;\n  }\n\n  get hitCount() {\n    return this.count;\n  }\n\n  // get cache() {\n  //   return Object.fromEntries(this.caches);\n  // }\n\n  /**\n   * 计算二进制数据的哈希值\n   * @param reader Reader对象\n   * @param end 结束位置\n   * @returns 哈希值\n   */\n  calculate(reader: Reader, end: number): string {\n    // 保存原始位置\n    const { pos: startPos, buf } = reader;\n    const endPos = Math.min(end, reader.len);\n    // 采样数据以加快计算速度，同时保持足够的唯一性\n    // 对于大数据，每隔几个字节采样一次\n    const step = Math.max(1, Math.floor((endPos - startPos) / 100));\n    \n    return calculateHash(buf, startPos, endPos, step);\n  }\n\n  /**\n   * 检查是否存在缓存数据\n   * @param key 键\n   * @returns 是否存在\n   */\n  has(key: string): boolean {\n    const hit = this.caches.has(key);\n\n    if (hit) {\n      this.count++;\n    }\n\n    return hit;\n\n    // return this.caches.has(key);\n  }\n\n  /**\n   * 获取缓存数据\n   * @param key 键\n   * @returns 缓存数据\n   */\n  get(key: string): any {\n    return this.caches.get(key);\n  }\n\n  /**\n   * 设置缓存数据\n   * @param key 键\n   * @param value 缓存数据\n   */\n  set(key: string, value: any) {\n    this.caches.set(key, value);\n  }\n\n  /**\n   * 清空所有缓存数据\n   */\n  clear() {\n    this.count = 0;\n    this.caches.clear();\n  }\n}\n","/**\n * 简易的hash算法\n * @param buff \n * @param start \n * @param end \n * @param step \n * @returns \n */\nexport function calculateHash(buff: Uint8Array, start: number, end: number, step: number) {\n  // 使用简单的哈希算法\n    let hash = 0;\n\n    for (let i = start; i < end; i += step) {\n      // 简单的哈希算法，类似于字符串哈希\n      hash = (hash << 5) - hash + buff[i];\n      hash = hash & hash; // 转换为32位整数\n    }\n\n    // 添加数据长度作为哈希的一部分，增加唯一性\n    hash = (hash << 5) - hash + end - start;\n    hash = hash & hash;\n    // 转换为字符串\n    return hash.toString(36);\n}\n","import { platform } from \"../../../platform\";\nimport { readFloatLE } from \"./float\";\nimport { Preflight } from \"./preflight\";\n\nexport default class Reader {\n  // 添加静态缓存，用于常用的空数组\n  private static EMPTY_UINT8ARRAY = new Uint8Array(0);\n\n  /**\n   * Read buffer.\n   * @type {Uint8Array}\n   */\n  readonly buf: Uint8Array;\n  /**\n   * Read buffer length.\n   * @type {number}\n   */\n  readonly len: number;\n  /**\n   * Read buffer position.\n   * @type {number}\n   */\n  pos: number;\n\n  preflight = new Preflight();\n\n  /**\n   * Constructs a new reader instance using the specified buffer.\n   * @classdesc Wire format reader using `Uint8Array` if available, otherwise `Array`.\n   * @constructor\n   * @param {Uint8Array} buffer Buffer to read from\n   */\n  constructor(buffer: Uint8Array) {\n    this.buf = buffer;\n    this.pos = 0;\n    this.len = buffer.length;\n  }\n\n  private indexOutOfRange(reader: Reader, writeLength?: number) {\n    return new RangeError(\n      \"index out of range: \" +\n        reader.pos +\n        \" + \" +\n        (writeLength || 1) +\n        \" > \" +\n        reader.len\n    );\n  }\n\n  /**\n   * 将复杂逻辑分离到单独方法\n   * @returns\n   */\n  private readVarint32Slow() {\n    let byte = this.buf[this.pos++];\n    let value = byte & 0x7f;\n    let shift = 7;\n\n    // 使用do-while循环减少条件判断\n    do {\n      if (this.pos >= this.len) {\n        throw this.indexOutOfRange(this);\n      }\n\n      byte = this.buf[this.pos++];\n      value |= (byte & 0x7f) << shift;\n      shift += 7;\n    } while (byte >= 128 && shift < 32);\n\n    return value >>> 0; // 确保无符号\n  }\n\n  /**\n   * Reads a sequence of bytes preceded by its length as a varint.\n   * @param length \n   * @returns \n   */\n  end(length?: number) {\n    return length === undefined ? this.len : this.pos + length\n  }\n\n  /**\n   * Reads a varint as an unsigned 32 bit value.\n   * @function\n   * @returns {number} Value read\n   */\n  uint32() {\n    // 快速路径：大多数情况下是单字节\n    const byte = this.buf[this.pos];\n\n    if (byte < 128) {\n      this.pos++;\n\n      return byte;\n    }\n\n    // 慢速路径：多字节处理\n    return this.readVarint32Slow();\n  }\n\n  /**\n   * Reads a varint as a signed 32 bit value.\n   * @returns {number} Value read\n   */\n  int32() {\n    return this.uint32() | 0;\n  }\n\n  /**\n   * Reads a float (32 bit) as a number.\n   * @function\n   * @returns {number} Value read\n   */\n  float() {\n    const pos = this.pos + 4;\n\n    if (pos > this.len) {\n      throw this.indexOutOfRange(this, 4);\n    }\n\n    const value = readFloatLE(this.buf, this.pos);\n    this.pos = pos;\n\n    return value;\n  }\n\n  /**\n   * read bytes range\n   * @returns \n   */\n  private getBytesRange() {\n    const length = this.uint32();\n    const start = this.pos;\n    const end = start + length;\n\n    if (end > this.len) {\n      throw this.indexOutOfRange(this, length);\n    }\n\n    return [start, end, length];\n  }\n\n  /**\n   * Reads a sequence of bytes preceded by its length as a varint.\n   * @returns {Uint8Array} Value read\n   */\n  bytes() {\n    const [start, end, length] = this.getBytesRange();\n\n    this.pos += length;\n\n    if (length === 0) {\n      return Reader.EMPTY_UINT8ARRAY;\n    }\n\n    return this.buf.subarray(start, end);\n  }\n\n  /**\n   * Reads a string preceeded by its byte length as a varint.\n   * @returns {string} Value read\n   */\n  string() {\n    const [start, end] = this.getBytesRange();\n    // 直接在原始buffer上解码，避免创建中间bytes对象\n    const result = platform.decode.utf8(this.buf, start, end);\n    this.pos = end;\n\n    return result;\n  }\n\n  /**\n   * Skips the specified number of bytes if specified, otherwise skips a varint.\n   * @param {number} [length] Length if known, otherwise a varint is assumed\n   * @returns {Reader} `this`\n   */\n  skip(length?: number) {\n    if (typeof length === \"number\") {\n      if (this.pos + length > this.len) {\n        throw this.indexOutOfRange(this, length);\n      }\n\n      this.pos += length;\n\n      return this;\n    }\n    \n    // 变长整数跳过优化 - 使用位运算\n    const { buf, len } = this;\n    let pos = this.pos;\n    \n    // 一次检查多个字节，减少循环次数\n    while (pos < len) {\n      const byte = buf[pos++];\n\n      if ((byte & 0x80) === 0) {\n        this.pos = pos;\n\n        return this;\n      }\n\n      // 快速检查连续的高位字节\n      if (pos < len && (buf[pos] & 0x80) !== 0) {\n        pos++;\n\n        if (pos < len && (buf[pos] & 0x80) !== 0) {\n          pos++;\n\n          if (pos < len && (buf[pos] & 0x80) !== 0) {\n            pos++;\n\n            // 继续检查剩余字节\n            while (pos < len && (buf[pos] & 0x80) !== 0) {\n              pos++;\n\n              if (pos - this.pos >= 10) {\n                throw Error(\"invalid varint encoding\");\n              }\n            }\n\n            if (pos < len) {\n              this.pos = pos + 1;\n\n              return this;\n            }\n          }\n        }\n      }\n    }\n    \n    throw this.indexOutOfRange(this);\n  }\n\n  /**\n   * Skips the next element of the specified wire type.\n   * @param {number} wireType Wire type received\n   * @returns {Reader} `this`\n   */\n  skipType(wireType: number) {\n    switch (wireType) {\n      case 0:\n        this.skip();\n        break;\n      case 1:\n        this.skip(8);\n        break;\n      case 2:\n        this.skip(this.uint32());\n        break;\n      case 3:\n        while ((wireType = this.uint32() & 7) !== 4) {\n          this.skipType(wireType);\n        }\n        break;\n      case 5:\n        this.skip(4);\n        break;\n\n      /* istanbul ignore next */\n      default:\n        throw Error(\"invalid wire type \" + wireType + \" at offset \" + this.pos);\n    }\n\n    return this;\n  }\n}\n","import Reader from \"../io/Reader\";\nimport { PlatformVideo } from \"../../../types/video\";\n\nexport default class Layout {\n  /**\n   * Decodes a Layout message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.Layout\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.Layout} Layout\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.Rect {\n    const { preflight } = reader;\n    const end = reader.end(length);\n    const hash = preflight.calculate(reader, end);\n\n    if (preflight.has(hash)) {\n      reader.pos = end;\n      return preflight.get(hash);\n    }\n\n    const message = new Layout();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.x = reader.float();\n          break;\n        }\n        case 2: {\n          message.y = reader.float();\n          break;\n        }\n        case 3: {\n          message.width = reader.float();\n          break;\n        }\n        case 4: {\n          message.height = reader.float();\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    preflight.set(hash, Layout.format(message));\n\n    return preflight.get(hash);\n  }\n\n  static format(message: Layout): PlatformVideo.Rect {\n    const { x = 0, y = 0, width = 0, height = 0 } = message;\n\n    return { x, y, width, height };\n  }\n\n  /**\n   * Layout x.\n   * @member {number} x\n   * @memberof com.opensource.svga.Layout\n   * @instance\n   */\n  x: number = 0;\n  /**\n   * Layout y.\n   * @member {number} y\n   * @memberof com.opensource.svga.Layout\n   * @instance\n   */\n  y: number = 0;\n  /**\n   * Layout width.\n   * @member {number} width\n   * @memberof com.opensource.svga.Layout\n   * @instance\n   */\n  width: number = 0;\n  /**\n   * Layout height.\n   * @member {number} height\n   * @memberof com.opensource.svga.Layout\n   * @instance\n   */\n  height: number = 0;\n}\n","import Reader from \"../io/Reader\";\nimport { PlatformVideo } from \"../../../types/video\";\n\nexport default class Transform {\n  /**\n   * Decodes a Transform message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.Transform\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.Transform} Transform\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.Transform {\n    const end = reader.end(length);\n    const message = new Transform();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.a = reader.float();\n          break;\n        }\n        case 2: {\n          message.b = reader.float();\n          break;\n        }\n        case 3: {\n          message.c = reader.float();\n          break;\n        }\n        case 4: {\n          message.d = reader.float();\n          break;\n        }\n        case 5: {\n          message.tx = reader.float();\n          break;\n        }\n        case 6: {\n          message.ty = reader.float();\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    return message;\n  }\n\n  /**\n   * Transform a.\n   * @member {number} a\n   * @memberof com.opensource.svga.Transform\n   * @instance\n   */\n  a: number = 0;\n  /**\n   * Transform b.\n   * @member {number} b\n   * @memberof com.opensource.svga.Transform\n   * @instance\n   */\n  b: number = 0;\n  /**\n   * Transform c.\n   * @member {number} c\n   * @memberof com.opensource.svga.Transform\n   * @instance\n   */\n  c: number = 0;\n  /**\n   * Transform d.\n   * @member {number} d\n   * @memberof com.opensource.svga.Transform\n   * @instance\n   */\n  d: number = 0;\n  /**\n   * Transform tx.\n   * @member {number} tx\n   * @memberof com.opensource.svga.Transform\n   * @instance\n   */\n  tx: number = 0;\n  /**\n   * Transform ty.\n   * @member {number} ty\n   * @memberof com.opensource.svga.Transform\n   * @instance\n   */\n  ty: number = 0;\n}\n","import Reader from \"../io/Reader\";\nimport { PlatformVideo } from \"../../../types/video\";\n\n/**\n * Properties of a ShapeArgs.\n * @memberof com.opensource.svga.ShapeEntity\n * @interface IShapeArgs\n * @property {string|null} [d] ShapeArgs d\n */\nexport interface ShapeArgsProps {\n  d: string | null;\n}\n\nexport default class ShapeArgs {\n  /**\n   * Decodes a ShapeArgs message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.ShapeEntity.ShapeArgs\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.ShapeEntity.ShapeArgs} ShapeArgs\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.ShapePath {\n    const { preflight } = reader;\n    const end = reader.end(length);\n    const hash = preflight.calculate(reader, end);\n\n    if (preflight.has(hash)) {\n      reader.pos = end;\n      return preflight.get(hash);\n    }\n\n    const message = new ShapeArgs();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.d = reader.string();\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    preflight.set(hash, message);\n\n    return preflight.get(hash);\n  }\n\n  /**\n   * ShapeArgs d.\n   * @member {string} d\n   * @memberof com.opensource.svga.ShapeEntity.ShapeArgs\n   * @instance\n   */\n  d: string = \"\";\n}\n","import Reader from \"../io/Reader\";\nimport { PlatformVideo } from \"../../../types/video\";\n\n/**\n * Properties of a RectArgs.\n * @memberof com.opensource.svga.ShapeEntity\n * @interface IRectArgs\n * @property {number|null} [x] RectArgs x\n * @property {number|null} [y] RectArgs y\n * @property {number|null} [width] RectArgs width\n * @property {number|null} [height] RectArgs height\n * @property {number|null} [cornerRadius] RectArgs cornerRadius\n */\nexport interface RectArgsProps {\n  x: number | null;\n  y: number | null;\n  width: number | null;\n  height: number | null;\n  cornerRadius: number | null;\n}\n\nexport default class RectArgs {\n  /**\n   * Decodes a RectArgs message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.ShapeEntity.RectArgs\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.ShapeEntity.RectArgs} RectArgs\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.RectPath {\n    const { preflight } = reader;\n    const end = reader.end(length);\n    const hash = preflight.calculate(reader, end);\n\n    if (preflight.has(hash)) {\n      reader.pos = end;\n      return preflight.get(hash);\n    }\n\n    const message = new RectArgs();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.x = reader.float();\n          break;\n        }\n        case 2: {\n          message.y = reader.float();\n          break;\n        }\n        case 3: {\n          message.width = reader.float();\n          break;\n        }\n        case 4: {\n          message.height = reader.float();\n          break;\n        }\n        case 5: {\n          message.cornerRadius = reader.float();\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    preflight.set(hash, message);\n\n    return preflight.get(hash);\n  }\n\n  /**\n   * RectArgs x.\n   * @member {number} x\n   * @memberof com.opensource.svga.ShapeEntity.RectArgs\n   * @instance\n   */\n  x: number = 0;\n  /**\n   * RectArgs y.\n   * @member {number} y\n   * @memberof com.opensource.svga.ShapeEntity.RectArgs\n   * @instance\n   */\n  y: number = 0;\n  /**\n   * RectArgs width.\n   * @member {number} width\n   * @memberof com.opensource.svga.ShapeEntity.RectArgs\n   * @instance\n   */\n  width: number = 0;\n  /**\n   * RectArgs height.\n   * @member {number} height\n   * @memberof com.opensource.svga.ShapeEntity.RectArgs\n   * @instance\n   */\n  height: number = 0;\n  /**\n   * RectArgs cornerRadius.\n   * @member {number} cornerRadius\n   * @memberof com.opensource.svga.ShapeEntity.RectArgs\n   * @instance\n   */\n  cornerRadius: number = 0;\n}\n","import Reader from \"../io/Reader\";\nimport { PlatformVideo } from \"../../../types/video\";\n\nexport default class EllipseArgs {\n  /**\n   * Decodes an EllipseArgs message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.ShapeEntity.EllipseArgs\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.ShapeEntity.EllipseArgs} EllipseArgs\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.EllipsePath {\n    const { preflight } = reader;\n    const end = reader.end(length);\n    const hash = preflight.calculate(reader, end);\n\n    if (preflight.has(hash)) {\n      reader.pos = end;\n      return preflight.get(hash);\n    }\n\n    const message = new EllipseArgs();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.x = reader.float();\n          break;\n        }\n        case 2: {\n          message.y = reader.float();\n          break;\n        }\n        case 3: {\n          message.radiusX = reader.float();\n          break;\n        }\n        case 4: {\n          message.radiusY = reader.float();\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    preflight.set(hash, message);\n\n    return preflight.get(hash);\n  }\n\n  /**\n   * EllipseArgs x.\n   * @member {number} x\n   * @memberof com.opensource.svga.ShapeEntity.EllipseArgs\n   * @instance\n   */\n  x: number = 0;\n  /**\n   * EllipseArgs y.\n   * @member {number} y\n   * @memberof com.opensource.svga.ShapeEntity.EllipseArgs\n   * @instance\n   */\n  y: number = 0;\n  /**\n   * EllipseArgs radiusX.\n   * @member {number} radiusX\n   * @memberof com.opensource.svga.ShapeEntity.EllipseArgs\n   * @instance\n   */\n  radiusX: number = 0;\n  /**\n   * EllipseArgs radiusY.\n   * @member {number} radiusY\n   * @memberof com.opensource.svga.ShapeEntity.EllipseArgs\n   * @instance\n   */\n  radiusY: number = 0;\n}\n","import Reader from \"../io/Reader\";\nimport { PlatformVideo } from \"../../../types/video\";\n\n/**\n * Properties of a RGBAColor.\n * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n * @interface IRGBAColor\n * @property {number|null} [r] RGBAColor r\n * @property {number|null} [g] RGBAColor g\n * @property {number|null} [b] RGBAColor b\n * @property {number|null} [a] RGBAColor a\n */\nexport interface RGBAColorProps {\n  r: number | null;\n  g: number | null;\n  b: number | null;\n  a: number | null;\n}\n\nexport default class RGBAColor {\n  /**\n   * Decodes a RGBAColor message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle.RGBAColor\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.ShapeEntity.ShapeStyle.RGBAColor} RGBAColor\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.RGBA<number, number, number, number> {\n    const { preflight } = reader;\n    const end = reader.end(length);\n    const hash = preflight.calculate(reader, end);\n\n    if (preflight.has(hash)) {\n      reader.pos = end;\n      return preflight.get(hash);\n    }\n\n    const message = new RGBAColor();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.r = reader.float();\n          break;\n        }\n        case 2: {\n          message.g = reader.float();\n          break;\n        }\n        case 3: {\n          message.b = reader.float();\n          break;\n        }\n        case 4: {\n          message.a = reader.float();\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    preflight.set(hash, RGBAColor.format(message));\n\n    return preflight.get(hash);\n  }\n\n  static format(\n    message: RGBAColor\n  ): PlatformVideo.RGBA<number, number, number, number> {\n    const { r, g, b, a } = message;\n\n    return `rgba(${(r * 255) | 0}, ${(g * 255) | 0}, ${(b * 255) | 0}, ${\n      (a * 1) | 0\n    })`;\n  }\n\n  /**\n   * RGBAColor r.\n   * @member {number} r\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle.RGBAColor\n   * @instance\n   */\n  r: number = 0;\n  /**\n   * RGBAColor g.\n   * @member {number} g\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle.RGBAColor\n   * @instance\n   */\n  g: number = 0;\n  /**\n   * RGBAColor b.\n   * @member {number} b\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle.RGBAColor\n   * @instance\n   */\n  b: number = 0;\n  /**\n   * RGBAColor a.\n   * @member {number} a\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle.RGBAColor\n   * @instance\n   */\n  a: number = 0;\n}\n","import Reader from \"../io/Reader\";\nimport RGBAColor from \"./RGBAColor\";\nimport { PlatformVideo } from \"../../../types/video\";\n\nexport default class ShapeStyle {\n  /**\n   * Decodes a ShapeStyle message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.ShapeEntity.ShapeStyle} ShapeStyle\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.VideoStyles {\n    const { preflight } = reader;\n    const end = reader.end(length);\n    const hash = preflight.calculate(reader, end);\n\n    if (preflight.has(hash)) {\n      reader.pos = end;\n      return preflight.get(hash);\n    }\n\n    const message = new ShapeStyle();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.fill = RGBAColor.decode(\n            reader,\n            reader.uint32()\n          );\n          break;\n        }\n        case 2: {\n          message.stroke = RGBAColor.decode(\n            reader,\n            reader.uint32()\n          );\n          break;\n        }\n        case 3: {\n          message.strokeWidth = reader.float();\n          break;\n        }\n        case 4: {\n          message.lineCap = reader.int32();\n          break;\n        }\n        case 5: {\n          message.lineJoin = reader.int32();\n          break;\n        }\n        case 6: {\n          message.miterLimit = reader.float();\n          break;\n        }\n        case 7: {\n          message.lineDashI = reader.float();\n          break;\n        }\n        case 8: {\n          message.lineDashII = reader.float();\n          break;\n        }\n        case 9: {\n          message.lineDashIII = reader.float();\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    preflight.set(hash, ShapeStyle.format(message));\n\n    return preflight.get(hash);\n  }\n\n  static format(message: ShapeStyle): PlatformVideo.VideoStyles {\n    const { fill, stroke, strokeWidth, miterLimit, lineDashI, lineDashII, lineDashIII } = message;\n    const lineDash: number[] = [];\n    let lineCap: CanvasLineCap;\n    let lineJoin: CanvasLineJoin;\n\n    if (lineDashI > 0) {\n      lineDash.push(lineDashI);\n    }\n\n    if (lineDashII > 0) {\n      if (lineDash.length < 1) {\n        lineDash.push(0);\n      }\n\n      lineDash.push(lineDashII);\n    }\n\n    if (lineDashIII > 0) {\n      if (lineDash.length < 2) {\n        lineDash.push(0, 0);\n      }\n\n      lineDash.push(lineDashIII);\n    }\n\n    switch (message.lineCap) {\n      case PlatformVideo.LINE_CAP_CODE.BUTT:\n        lineCap = PlatformVideo.LINE_CAP.BUTT;\n        break;\n      case PlatformVideo.LINE_CAP_CODE.ROUND:\n        lineCap = PlatformVideo.LINE_CAP.ROUND;\n        break;\n      case PlatformVideo.LINE_CAP_CODE.SQUARE:\n        lineCap = PlatformVideo.LINE_CAP.SQUARE;\n        break;\n    }\n\n    switch (message.lineJoin) {\n      case PlatformVideo.LINE_JOIN_CODE.MITER:\n        lineJoin = PlatformVideo.LINE_JOIN.MITER;\n        break;\n      case PlatformVideo.LINE_JOIN_CODE.ROUND:\n        lineJoin = PlatformVideo.LINE_JOIN.ROUND;\n        break;\n      case PlatformVideo.LINE_JOIN_CODE.BEVEL:\n        lineJoin = PlatformVideo.LINE_JOIN.BEVEL;\n        break;\n    }\n\n    return {\n      lineDash,\n      fill: fill ? fill : null,\n      stroke: stroke ? stroke : null,\n      lineCap,\n      lineJoin,\n      strokeWidth,\n      miterLimit\n    }\n  }\n\n  /**\n   * ShapeStyle fill.\n   * @member {com.opensource.svga.ShapeEntity.ShapeStyle.IRGBAColor|null|undefined} fill\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @instance\n   */\n  fill: PlatformVideo.RGBA<number, number, number, number> | null = null;\n  /**\n   * ShapeStyle stroke.\n   * @member {com.opensource.svga.ShapeEntity.ShapeStyle.IRGBAColor|null|undefined} stroke\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @instance\n   */\n  stroke: PlatformVideo.RGBA<number, number, number, number> | null = null;\n  /**\n   * ShapeStyle strokeWidth.\n   * @member {number} strokeWidth\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @instance\n   */\n  strokeWidth: number = 0;\n  /**\n   * ShapeStyle lineCap.\n   * @member {com.opensource.svga.ShapeEntity.ShapeStyle.LineCap} lineCap\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @instance\n   */\n  lineCap: PlatformVideo.LINE_CAP_CODE = 0;\n  /**\n   * ShapeStyle lineJoin.\n   * @member {com.opensource.svga.ShapeEntity.ShapeStyle.LineJoin} lineJoin\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @instance\n   */\n  lineJoin: PlatformVideo.LINE_JOIN_CODE = 0;\n  /**\n   * ShapeStyle miterLimit.\n   * @member {number} miterLimit\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @instance\n   */\n  miterLimit: number = 0;\n  /**\n   * ShapeStyle lineDashI.\n   * @member {number} lineDashI\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @instance\n   */\n  lineDashI: number = 0;\n  /**\n   * ShapeStyle lineDashII.\n   * @member {number} lineDashII\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @instance\n   */\n  lineDashII: number = 0;\n  /**\n   * ShapeStyle lineDashIII.\n   * @member {number} lineDashIII\n   * @memberof com.opensource.svga.ShapeEntity.ShapeStyle\n   * @instance\n   */\n  lineDashIII: number = 0;\n}\n","import Reader from \"../io/Reader\";\nimport Transform from \"./Transform\";\nimport ShapeArgs from \"./ShapeArgs\";\nimport RectArgs from \"./RectArgs\";\nimport EllipseArgs from \"./EllipseArgs\";\nimport ShapeStyle from \"./ShapeStyle\";\nimport { PlatformVideo } from \"../../../types/video\";\n\nexport default class ShapeEntity {\n  /**\n   * Decodes a ShapeEntity message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.ShapeEntity\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.ShapeEntity} ShapeEntity\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.VideoFrameShape | null {\n    const end = reader.end(length);\n    const message = new ShapeEntity();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.type = reader.int32();\n          break;\n        }\n        case 2: {\n          message.shape = ShapeArgs.decode(reader, reader.uint32());\n          break;\n        }\n        case 3: {\n          message.rect = RectArgs.decode(reader, reader.uint32());\n          break;\n        }\n        case 4: {\n          message.ellipse = EllipseArgs.decode(\n            reader,\n            reader.uint32()\n          );\n          break;\n        }\n        case 10: {\n          message.styles = ShapeStyle.decode(\n            reader,\n            reader.uint32()\n          );\n          break;\n        }\n        case 11: {\n          message.transform = Transform.decode(reader, reader.uint32());\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    return ShapeEntity.format(message);\n  }\n\n  static format(message: ShapeEntity): PlatformVideo.VideoFrameShape | null {\n    const { type, shape, rect, ellipse, styles, transform } = message;\n\n    switch (type) {\n      case PlatformVideo.SHAPE_TYPE_CODE.SHAPE:\n        return {\n          type: PlatformVideo.SHAPE_TYPE.SHAPE,\n          path: shape!,\n          styles: styles!,\n          transform: transform!,\n        };\n      case PlatformVideo.SHAPE_TYPE_CODE.RECT:\n        return {\n          type: PlatformVideo.SHAPE_TYPE.RECT,\n          path: rect!,\n          styles: styles!,\n          transform: transform!,\n        };\n      case PlatformVideo.SHAPE_TYPE_CODE.ELLIPSE:\n        return {\n          type: PlatformVideo.SHAPE_TYPE.ELLIPSE,\n          path: ellipse!,\n          styles: styles!,\n          transform: transform!,\n        };\n      default:\n    }\n\n    return null;\n  }\n\n  /**\n   * ShapeEntity type.\n   * @member {com.opensource.svga.ShapeEntity.ShapeType} type\n   * @memberof com.opensource.svga.ShapeEntity\n   * @instance\n   */\n  type: PlatformVideo.SHAPE_TYPE_CODE = 0;\n  /**\n   * ShapeEntity shape.\n   * @member {com.opensource.svga.ShapeEntity.IShapeArgs|null|undefined} shape\n   * @memberof com.opensource.svga.ShapeEntity\n   * @instance\n   */\n  shape: PlatformVideo.ShapePath | null = null;\n  /**\n   * ShapeEntity rect.\n   * @member {com.opensource.svga.ShapeEntity.IRectArgs|null|undefined} rect\n   * @memberof com.opensource.svga.ShapeEntity\n   * @instance\n   */\n  rect: PlatformVideo.RectPath | null = null;\n  /**\n   * ShapeEntity ellipse.\n   * @member {com.opensource.svga.ShapeEntity.IEllipseArgs|null|undefined} ellipse\n   * @memberof com.opensource.svga.ShapeEntity\n   * @instance\n   */\n  ellipse: PlatformVideo.EllipsePath | null = null;\n  /**\n   * ShapeEntity styles.\n   * @member {com.opensource.svga.ShapeEntity.IShapeStyle|null|undefined} styles\n   * @memberof com.opensource.svga.ShapeEntity\n   * @instance\n   */\n  styles: PlatformVideo.VideoStyles | null = null;\n  /**\n   * ShapeEntity transform.\n   * @member {com.opensource.svga.ITransform|null|undefined} transform\n   * @memberof com.opensource.svga.ShapeEntity\n   * @instance\n   */\n  transform: PlatformVideo.Transform | null = null;\n}\n","import Reader from \"../io/Reader\";\nimport Layout from \"./Layout\";\nimport Transform from \"./Transform\";\nimport ShapeEntity from \"./ShapeEntity\";\nimport { PlatformVideo } from \"../../../types/video\";\n\nexport default class FrameEntity {\n  private static HIDDEN_FRAME: PlatformVideo.HiddenVideoFrame = {\n    alpha: 0,\n  };\n\n  /**\n   * Decodes a FrameEntity message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.FrameEntity\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.FrameEntity} FrameEntity\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.VideoFrame | PlatformVideo.HiddenVideoFrame {\n    const end = reader.end(length);\n    const message = new FrameEntity();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.alpha = reader.float();\n          break;\n        }\n        case 2: {\n          message.layout = Layout.decode(reader, reader.uint32());\n          break;\n        }\n        case 3: {\n          message.transform = Transform.decode(reader, reader.uint32());\n          break;\n        }\n        case 4: {\n          message.clipPath = reader.string();\n          break;\n        }\n        case 5: {\n          const shape = ShapeEntity.decode(reader, reader.uint32())\n\n          if (shape !== null) {\n            message.shapes.push(shape);\n          }\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    if (message.shapes.length === 0) {\n      message.shapes = reader.preflight.get(\"latest_shapes\");\n    } else {\n      reader.preflight.set(\"latest_shapes\", message.shapes);\n    }\n\n    return FrameEntity.format(message);\n  }\n\n  private static format(message: FrameEntity): PlatformVideo.VideoFrame | PlatformVideo.HiddenVideoFrame {\n    // alpha值小于 0.05 将不展示，所以不做解析处理\n    if (message.alpha < 0.05) {\n      return FrameEntity.HIDDEN_FRAME;\n    }\n\n    const { alpha, layout, transform, shapes } = message;\n\n    return {\n      alpha,\n      layout: layout!,\n      transform,\n      shapes,\n    };\n  }\n\n  /**\n   * FrameEntity shapes.\n   * @member {Array.<com.opensource.svga.IShapeEntity>} shapes\n   * @memberof com.opensource.svga.FrameEntity\n   * @instance\n   */\n  shapes: PlatformVideo.VideoFrameShape[] = [];\n  /**\n   * FrameEntity alpha.\n   * @member {number} alpha\n   * @memberof com.opensource.svga.FrameEntity\n   * @instance\n   */\n  alpha: number = 0;\n  /**\n   * FrameEntity layout.\n   * @member {com.opensource.svga.ILayout|null|undefined} layout\n   * @memberof com.opensource.svga.FrameEntity\n   * @instance\n   */\n  layout: PlatformVideo.Rect | null = null;\n  /**\n   * FrameEntity transform.\n   * @member {com.opensource.svga.ITransform|null|undefined} transform\n   * @memberof com.opensource.svga.FrameEntity\n   * @instance\n   */\n  transform: PlatformVideo.Transform | null = null;\n  /**\n   * FrameEntity clipPath.\n   * @member {string} clipPath\n   * @memberof com.opensource.svga.FrameEntity\n   * @instance\n   */\n  clipPath: string = \"\";\n}\n","import Reader from \"../io/Reader\";\nimport FrameEntity from \"./FrameEntity\";\nimport { PlatformVideo } from \"../../../types/video\";\n\nexport default class SpriteEntity {\n  /**\n   * Decodes a SpriteEntity message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.SpriteEntity\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.SpriteEntity} SpriteEntity\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.VideoSprite {\n    const end = reader.end(length);\n    const message = new SpriteEntity();\n    let tag: number;\n\n    reader.preflight.set(\"latest_shapes\", []);\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.imageKey = reader.string();\n          break;\n        }\n        case 2: {\n          if (!(message.frames && message.frames.length)) {\n            message.frames = [];\n          }\n\n          message.frames.push(FrameEntity.decode(reader, reader.uint32()));\n          break;\n        }\n        case 3: {\n          message.matteKey = reader.string();\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    return SpriteEntity.format(message);\n  }\n\n  static format(message: SpriteEntity): PlatformVideo.VideoSprite {\n    return {\n      imageKey: message.imageKey,\n      frames: message.frames,\n    };\n  }\n\n  /**\n   * SpriteEntity frames.\n   * @member {Array.<com.opensource.svga.IFrameEntity>} frames\n   * @memberof com.opensource.svga.SpriteEntity\n   * @instance\n   */\n  frames: Array<PlatformVideo.VideoFrame | PlatformVideo.HiddenVideoFrame> = [];\n  /**\n   * SpriteEntity imageKey.\n   * @member {string} imageKey\n   * @memberof com.opensource.svga.SpriteEntity\n   * @instance\n   */\n  imageKey: string = \"\";\n  /**\n   * SpriteEntity matteKey.\n   * @member {string} matteKey\n   * @memberof com.opensource.svga.SpriteEntity\n   * @instance\n   */\n  matteKey: string = \"\";\n}\n","import Reader from \"../io/Reader\";\nimport { PlatformVideo } from \"../../../types/video\";\n\nexport default class MovieParams {\n  /**\n   * Decodes a MovieParams message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.MovieParams\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.MovieParams} MovieParams\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.VideoParams {\n    const end = reader.end(length);\n    const message = new MovieParams();\n    let tag: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.viewBoxWidth = reader.float();\n          break;\n        }\n        case 2: {\n          message.viewBoxHeight = reader.float();\n          break;\n        }\n        case 3: {\n          message.fps = reader.int32();\n          break;\n        }\n        case 4: {\n          message.frames = reader.int32();\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    return message;\n  }\n\n  /**\n   * MovieParams viewBoxWidth.\n   * @member {number} viewBoxWidth\n   * @memberof com.opensource.svga.MovieParams\n   * @instance\n   */\n  viewBoxWidth: number = 0;\n  /**\n   * MovieParams viewBoxHeight.\n   * @member {number} viewBoxHeight\n   * @memberof com.opensource.svga.MovieParams\n   * @instance\n   */\n  viewBoxHeight: number = 0;\n  /**\n   * MovieParams fps.\n   * @member {number} fps\n   * @memberof com.opensource.svga.MovieParams\n   * @instance\n   */\n  fps: number = 0;\n  /**\n   * MovieParams frames.\n   * @member {number} frames\n   * @memberof com.opensource.svga.MovieParams\n   * @instance\n   */\n  frames: number = 0;\n}\n","import Reader from \"../io/Reader\";\nimport SpriteEntity from \"./SpriteEntity\";\nimport MovieParams from \"./MovieParams\";\nimport { PlatformVideo } from \"../../../types/video\";\n\nexport default class MovieEntity {\n  static EMPTY_U8 = new Uint8Array(0);\n  /**\n   * Decodes a MovieEntity message from the specified reader.\n   * @function decode\n   * @memberof com.opensource.svga.MovieEntity\n   * @static\n   * @param {$protobuf.Reader} reader Reader to decode from\n   * @param {number} [length] Message length if known beforehand\n   * @returns {com.opensource.svga.MovieEntity} MovieEntity\n   * @throws {Error} If the payload is not a reader or valid buffer\n   * @throws {$protobuf.util.ProtocolError} If required fields are missing\n   */\n  static decode(reader: Reader, length?: number): PlatformVideo.Video {\n    const end = reader.end(length);\n    const message = new MovieEntity();\n    let key: string;\n    let value: Uint8Array;\n    let end2: number;\n    let tag: number;\n    let tag2: number;\n\n    while (reader.pos < end) {\n      tag = reader.uint32();\n\n      switch (tag >>> 3) {\n        case 1: {\n          message.version = reader.string();\n          break;\n        }\n        case 2: {\n          message.params = MovieParams.decode(reader, reader.uint32());\n          break;\n        }\n        case 3: {\n          end2 = reader.uint32() + reader.pos;\n          key = \"\";\n          value = MovieEntity.EMPTY_U8;\n\n          while (reader.pos < end2) {\n            tag2 = reader.uint32();\n            switch (tag2 >>> 3) {\n              case 1:\n                key = reader.string();\n                break;\n              case 2:\n                value = reader.bytes();\n                break;\n              default:\n                reader.skipType(tag2 & 7);\n                break;\n            }\n          }\n\n          message.images[key] = value;\n          break;\n        }\n        case 4: {\n          message.sprites.push(SpriteEntity.decode(reader, reader.uint32()));\n          break;\n        }\n        default:\n          reader.skipType(tag & 7);\n          break;\n      }\n    }\n\n    return MovieEntity.format(message);\n  }\n\n  static format(message: MovieEntity): PlatformVideo.Video {\n    const { version, images, sprites } = message;\n    const { fps, frames, viewBoxWidth, viewBoxHeight } = message.params!;\n\n    return {\n      version,\n      filename: \"\",\n      locked: false,\n      dynamicElements: {},\n      size: {\n        width: viewBoxWidth,\n        height: viewBoxHeight,\n      },\n      fps,\n      frames,\n      images,\n      sprites,\n    };\n  }\n\n  /**\n   * MovieEntity version.\n   * @member {string} version\n   * @memberof com.opensource.svga.MovieEntity\n   * @instance\n   */\n  version: string = \"\";\n  /**\n   * MovieEntity params.\n   * @member {com.opensource.svga.IMovieParams|null|undefined} params\n   * @memberof com.opensource.svga.MovieEntity\n   * @instance\n   */\n  params: MovieParams | null = null;\n  /**\n   * MovieEntity images.\n   * @member {Object.<string,Uint8Array>} images\n   * @memberof com.opensource.svga.MovieEntity\n   * @instance\n   */\n  images: Record<string, Uint8Array> = {};\n  /**\n   * MovieEntity sprites.\n   * @member {Array.<com.opensource.svga.ISpriteEntity>} sprites\n   * @memberof com.opensource.svga.MovieEntity\n   * @instance\n   */\n  sprites: PlatformVideo.VideoSprite[] = [];\n}\n","export interface CurrentPoint {\n  x: number;\n  y: number;\n  x1: number;\n  y1: number;\n  x2: number;\n  y2: number;\n}\n\n/**\n * CurrentPoint对象池，用于减少对象创建和GC压力\n */\nexport class PointPool {\n  private pool: CurrentPoint[] = [];\n\n  public acquire(): CurrentPoint {\n    const { pool } = this;\n\n    return pool.length > 0\n      ? pool.pop()!\n      : { x: 0, y: 0, x1: 0, y1: 0, x2: 0, y2: 0 };\n  }\n\n  public release(point: CurrentPoint): void {\n    // 重置点的属性\n    point.x = point.y = point.x1 = point.y1 = point.x2 = point.y2 = 0;\n    this.pool.push(point);\n  }\n}\n","import { type Bitmap } from \"octopus-platform\";\nimport { PointPool, CurrentPoint } from \"../../../shared/PointPool\";\nimport {\n  PlatformVideo,\n  type TransformScale,\n  type PlatformRenderingContext2D,\n  type CanvasSize,\n  PLAYER_CONTENT_MODE\n} from \"../../../types\";\n\nexport interface ICommand {\n  command: string;\n  args: string;\n}\n\nexport class Renderer2D {\n  /**\n   * https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Paths\n   * 绘制路径的不同指令：\n   * * 直线命令\n   * - M: moveTo，移动到指定点，不绘制直线。\n   * - L: lineTo，从起始点绘制一条直线到指定点。\n   * - H: horizontal lineTo，从起始点绘制一条水平线到指定点。\n   * - V: vertical lineTo，从起始点绘制一条垂直线到指定点。\n   * - Z: closePath，从起始点绘制一条直线到路径起点，形成一个闭合路径。\n   * * 曲线命令\n   * - C: bezierCurveTo，绘制三次贝塞尔曲线。\n   * - S: smooth curveTo，绘制平滑三次贝塞尔曲线。\n   * - Q: quadraticCurveTo，绘制两次贝塞尔曲线。\n   * - T: smooth quadraticCurveTo，绘制平滑两次贝塞尔曲线。\n   * * 弧线命令\n   * - A: arcTo，从起始点绘制一条弧线到指定点。\n   */\n  private static SVG_PATH = new Set([\n    \"M\",\n    \"L\",\n    \"H\",\n    \"V\",\n    \"Z\",\n    \"C\",\n    \"S\",\n    \"Q\",\n    \"m\",\n    \"l\",\n    \"h\",\n    \"v\",\n    \"z\",\n    \"c\",\n    \"s\",\n    \"q\",\n  ]);\n\n  private static SVG_LETTER_REGEXP = /[a-zA-Z]/;\n\n  // 在Renderer2D类中添加新的解析方法\n  private static parseSVGPath(d: string): ICommand[] {\n    const { SVG_LETTER_REGEXP } = Renderer2D;\n    const result: ICommand[] = [];\n    let currentIndex = 0;\n\n    // 状态：0 - 等待命令，1 - 读取参数\n    let state = 0;\n    let currentCommand = \"\";\n    let currentArgs = \"\";\n\n    while (currentIndex < d.length) {\n      const char = d[currentIndex];\n\n      switch (state) {\n        case 0: // 等待命令\n          if (SVG_LETTER_REGEXP.test(char)) {\n            currentCommand = char;\n            state = 1;\n          }\n          break;\n        case 1: // 读取参数\n          if (SVG_LETTER_REGEXP.test(char)) {\n            // 遇到新命令，保存当前命令和参数\n            result.push({\n              command: currentCommand,\n              args: currentArgs.trim(),\n            });\n            currentCommand = char;\n            currentArgs = \"\";\n          } else {\n            currentArgs += char;\n          }\n          break;\n      }\n\n      currentIndex++;\n    }\n\n    // 处理最后一个命令\n    if (currentCommand && state === 1) {\n      result.push({\n        command: currentCommand,\n        args: currentArgs.trim(),\n      });\n    }\n\n    return result;\n  }\n\n  private static fillOrStroke(\n    context: PlatformRenderingContext2D,\n    styles?: PlatformVideo.VideoStyles\n  ): void {\n    if (styles) {\n      if (styles.fill) {\n        context.fill();\n      }\n\n      if (styles.stroke) {\n        context.stroke();\n      }\n    }\n  }\n\n  private static resetShapeStyles(\n    context: PlatformRenderingContext2D,\n    styles?: PlatformVideo.VideoStyles\n  ): void {\n    if (styles) {\n      context.strokeStyle = styles.stroke || \"transparent\";\n\n      if (styles.strokeWidth! > 0) {\n        context.lineWidth = styles.strokeWidth!;\n      }\n\n      if (styles.miterLimit! > 0) {\n        context.miterLimit = styles.miterLimit!;\n      }\n\n      if (styles.lineCap) {\n        context.lineCap = styles.lineCap;\n      }\n\n      if (styles.lineJoin) {\n        context.lineJoin = styles.lineJoin;\n      }\n\n      context.fillStyle = styles.fill || \"transparent\";\n\n      if (styles.lineDash) {\n        context.setLineDash(styles.lineDash);\n      }\n    }\n  }\n\n  /**\n   * 计算缩放比例\n   * @param contentMode\n   * @param videoSize\n   * @param canvasSize\n   * @returns\n   */\n  private static calculateScale(\n    contentMode: PLAYER_CONTENT_MODE,\n    videoSize: PlatformVideo.VideoSize,\n    canvasSize: CanvasSize\n  ): TransformScale {\n    const imageRatio = videoSize.width / videoSize.height;\n    const viewRatio = canvasSize.width / canvasSize.height;\n    const isAspectFit = contentMode === PLAYER_CONTENT_MODE.ASPECT_FIT;\n    const shouldUseWidth =\n      (imageRatio >= viewRatio && isAspectFit) ||\n      (imageRatio <= viewRatio && !isAspectFit);\n    const createTransform = (\n      scale: number,\n      translateX: number,\n      translateY: number\n    ) => ({\n      scaleX: scale,\n      scaleY: scale,\n      translateX,\n      translateY,\n    });\n\n    if (shouldUseWidth) {\n      const scale = canvasSize.width / videoSize.width;\n\n      return createTransform(\n        scale,\n        0,\n        (canvasSize.height - videoSize.height * scale) / 2\n      );\n    }\n\n    const scale = canvasSize.height / videoSize.height;\n\n    return createTransform(\n      scale,\n      (canvasSize.width - videoSize.width * scale) / 2,\n      0\n    );\n  }\n\n  private readonly pointPool: PointPool = new PointPool();\n\n  private currentPoint: CurrentPoint;\n\n  private lastResizeKey = \"\";\n\n  private globalTransform?: PlatformVideo.Transform = undefined;\n\n  constructor(private context: PlatformRenderingContext2D | null) {\n    this.currentPoint = this.pointPool.acquire();\n  }\n\n  private setTransform(transform?: PlatformVideo.Transform): void {\n    if (transform && this.context) {\n      this.context!.transform(\n        transform.a,\n        transform.b,\n        transform.c,\n        transform.d,\n        transform.tx,\n        transform.ty\n      );\n    }\n  }\n\n  private drawBezier(\n    d?: string,\n    transform?: PlatformVideo.Transform,\n    styles?: PlatformVideo.VideoStyles\n  ): void {\n    const { context, pointPool } = this;\n    this.currentPoint = pointPool.acquire();\n\n    context!.save();\n    Renderer2D.resetShapeStyles(context!, styles);\n    this.setTransform(transform);\n    context!.beginPath();\n\n    if (d) {\n      // 使用状态机解析器替代正则表达式\n      const commands = Renderer2D.parseSVGPath(d);\n\n      for (const { command, args } of commands) {\n        if (Renderer2D.SVG_PATH.has(command)) {\n          this.drawBezierElement(\n            this.currentPoint,\n            command,\n            args.split(/[\\s,]+/).filter(Boolean)\n          );\n        }\n      }\n    }\n\n    Renderer2D.fillOrStroke(context!, styles);\n    pointPool.release(this.currentPoint);\n    context!.restore();\n  }\n\n  private drawBezierElement(\n    currentPoint: CurrentPoint,\n    method: string,\n    args: string[]\n  ): void {\n    const { context } = this;\n\n    switch (method) {\n      case \"M\":\n        currentPoint.x = +args[0];\n        currentPoint.y = +args[1];\n        context!.moveTo(currentPoint.x, currentPoint.y);\n        break;\n      case \"m\":\n        currentPoint.x += +args[0];\n        currentPoint.y += +args[1];\n        context!.moveTo(currentPoint.x, currentPoint.y);\n        break;\n      case \"L\":\n        currentPoint.x = +args[0];\n        currentPoint.y = +args[1];\n        context!.lineTo(currentPoint.x, currentPoint.y);\n        break;\n      case \"l\":\n        currentPoint.x += +args[0];\n        currentPoint.y += +args[1];\n        context!.lineTo(currentPoint.x, currentPoint.y);\n        break;\n      case \"H\":\n        currentPoint.x = +args[0];\n        context!.lineTo(currentPoint.x, currentPoint.y);\n        break;\n      case \"h\":\n        currentPoint.x += +args[0];\n        context!.lineTo(currentPoint.x, currentPoint.y);\n        break;\n      case \"V\":\n        currentPoint.y = +args[0];\n        context!.lineTo(currentPoint.x, currentPoint.y);\n        break;\n      case \"v\":\n        currentPoint.y += +args[0];\n        context!.lineTo(currentPoint.x, currentPoint.y);\n        break;\n      case \"C\":\n        currentPoint.x1 = +args[0];\n        currentPoint.y1 = +args[1];\n        currentPoint.x2 = +args[2];\n        currentPoint.y2 = +args[3];\n        currentPoint.x = +args[4];\n        currentPoint.y = +args[5];\n        context!.bezierCurveTo(\n          currentPoint.x1,\n          currentPoint.y1,\n          currentPoint.x2,\n          currentPoint.y2,\n          currentPoint.x,\n          currentPoint.y\n        );\n        break;\n      case \"c\":\n        currentPoint.x1 = currentPoint.x + +args[0];\n        currentPoint.y1 = currentPoint.y + +args[1];\n        currentPoint.x2 = currentPoint.x + +args[2];\n        currentPoint.y2 = currentPoint.y + +args[3];\n        currentPoint.x += +args[4];\n        currentPoint.y += +args[5];\n        context!.bezierCurveTo(\n          currentPoint.x1,\n          currentPoint.y1,\n          currentPoint.x2,\n          currentPoint.y2,\n          currentPoint.x,\n          currentPoint.y\n        );\n        break;\n      case \"S\":\n        if (\n          currentPoint.x1 !== undefined &&\n          currentPoint.y1 !== undefined &&\n          currentPoint.x2 !== undefined &&\n          currentPoint.y2 !== undefined\n        ) {\n          currentPoint.x1 = currentPoint.x - currentPoint.x2 + currentPoint.x;\n          currentPoint.y1 = currentPoint.y - currentPoint.y2 + currentPoint.y;\n          currentPoint.x2 = +args[0];\n          currentPoint.y2 = +args[1];\n          currentPoint.x = +args[2];\n          currentPoint.y = +args[3];\n          context!.bezierCurveTo(\n            currentPoint.x1,\n            currentPoint.y1,\n            currentPoint.x2,\n            currentPoint.y2,\n            currentPoint.x,\n            currentPoint.y\n          );\n        } else {\n          currentPoint.x1 = +args[0];\n          currentPoint.y1 = +args[1];\n          currentPoint.x = +args[2];\n          currentPoint.y = +args[3];\n          context!.quadraticCurveTo(\n            currentPoint.x1,\n            currentPoint.y1,\n            currentPoint.x,\n            currentPoint.y\n          );\n        }\n        break;\n      case \"s\":\n        if (\n          currentPoint.x1 !== undefined &&\n          currentPoint.y1 !== undefined &&\n          currentPoint.x2 !== undefined &&\n          currentPoint.y2 !== undefined\n        ) {\n          currentPoint.x1 = currentPoint.x - currentPoint.x2 + currentPoint.x;\n          currentPoint.y1 = currentPoint.y - currentPoint.y2 + currentPoint.y;\n          currentPoint.x2 = currentPoint.x + +args[0];\n          currentPoint.y2 = currentPoint.y + +args[1];\n          currentPoint.x += +args[2];\n          currentPoint.y += +args[3];\n          context!.bezierCurveTo(\n            currentPoint.x1,\n            currentPoint.y1,\n            currentPoint.x2,\n            currentPoint.y2,\n            currentPoint.x,\n            currentPoint.y\n          );\n        } else {\n          currentPoint.x1 = currentPoint.x + +args[0];\n          currentPoint.y1 = currentPoint.y + +args[1];\n          currentPoint.x += +args[2];\n          currentPoint.y += +args[3];\n          context!.quadraticCurveTo(\n            currentPoint.x1,\n            currentPoint.y1,\n            currentPoint.x,\n            currentPoint.y\n          );\n        }\n        break;\n      case \"Q\":\n        currentPoint.x1 = +args[0];\n        currentPoint.y1 = +args[1];\n        currentPoint.x = +args[2];\n        currentPoint.y = +args[3];\n        context!.quadraticCurveTo(\n          currentPoint.x1,\n          currentPoint.y1,\n          currentPoint.x,\n          currentPoint.y\n        );\n        break;\n      case \"q\":\n        currentPoint.x1 = currentPoint.x + +args[0];\n        currentPoint.y1 = currentPoint.y + +args[1];\n        currentPoint.x += +args[2];\n        currentPoint.y += +args[3];\n        context!.quadraticCurveTo(\n          currentPoint.x1,\n          currentPoint.y1,\n          currentPoint.x,\n          currentPoint.y\n        );\n        break;\n      case \"Z\":\n      case \"z\":\n        context!.closePath();\n        break;\n    }\n  }\n\n  private drawEllipse(\n    x: number,\n    y: number,\n    radiusX: number,\n    radiusY: number,\n    transform?: PlatformVideo.Transform,\n    styles?: PlatformVideo.VideoStyles\n  ): void {\n    const { context } = this;\n\n    context!.save();\n    Renderer2D.resetShapeStyles(context!, styles);\n    this.setTransform(transform);\n\n    x -= radiusX;\n    y -= radiusY;\n\n    const w = radiusX * 2;\n    const h = radiusY * 2;\n    const kappa = 0.5522848;\n    const ox = (w / 2) * kappa;\n    const oy = (h / 2) * kappa;\n    const xe = x + w;\n    const ye = y + h;\n    const xm = x + w / 2;\n    const ym = y + h / 2;\n\n    context!.beginPath();\n    context!.moveTo(x, ym);\n    context!.bezierCurveTo(x, ym - oy, xm - ox, y, xm, y);\n    context!.bezierCurveTo(xm + ox, y, xe, ym - oy, xe, ym);\n    context!.bezierCurveTo(xe, ym + oy, xm + ox, ye, xm, ye);\n    context!.bezierCurveTo(xm - ox, ye, x, ym + oy, x, ym);\n\n    Renderer2D.fillOrStroke(context!, styles);\n    context!.restore();\n  }\n\n  private drawRect(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    cornerRadius: number,\n    transform?: PlatformVideo.Transform,\n    styles?: PlatformVideo.VideoStyles\n  ): void {\n    const { context } = this;\n\n    context!.save();\n    Renderer2D.resetShapeStyles(context!, styles);\n    this.setTransform(transform);\n\n    let radius = cornerRadius;\n\n    if (width < 2 * radius) {\n      radius = width / 2;\n    }\n\n    if (height < 2 * radius) {\n      radius = height / 2;\n    }\n\n    context!.beginPath();\n    context!.moveTo(x + radius, y);\n    context!.arcTo(x + width, y, x + width, y + height, radius);\n    context!.arcTo(x + width, y + height, x, y + height, radius);\n    context!.arcTo(x, y + height, x, y, radius);\n    context!.arcTo(x, y, x + width, y, radius);\n    context!.closePath();\n\n    Renderer2D.fillOrStroke(context!, styles);\n    context!.restore();\n  }\n\n  private drawShape(shape: PlatformVideo.VideoFrameShape): void {\n    const { type, path, transform, styles } = shape;\n\n    switch (type) {\n      case PlatformVideo.SHAPE_TYPE.SHAPE:\n        this.drawBezier(path.d, transform, styles);\n        break;\n      case PlatformVideo.SHAPE_TYPE.ELLIPSE:\n        this.drawEllipse(\n          path.x ?? 0,\n          path.y ?? 0,\n          path.radiusX ?? 0,\n          path.radiusY ?? 0,\n          transform,\n          styles\n        );\n        break;\n      case PlatformVideo.SHAPE_TYPE.RECT:\n        this.drawRect(\n          path.x ?? 0,\n          path.y ?? 0,\n          path.width ?? 0,\n          path.height ?? 0,\n          path.cornerRadius ?? 0,\n          transform,\n          styles\n        );\n        break;\n    }\n  }\n\n  private drawSprite(\n    frame: PlatformVideo.VideoFrame | PlatformVideo.HiddenVideoFrame,\n    bitmap?: Bitmap,\n    dynamicElement?: Bitmap\n  ): void {\n    if (frame.alpha === 0) return;\n\n    const { context } = this;\n    const { alpha, transform, layout, shapes } =\n      frame as PlatformVideo.VideoFrame;\n    const { a = 1, b = 0, c = 0, d = 1, tx = 0, ty = 0 } = transform ?? {};\n\n    context!.save();\n    this.setTransform(this.globalTransform);\n    context!.globalAlpha = alpha;\n    context!.transform(a, b, c, d, tx, ty);\n\n    if (bitmap) {\n      context!.drawImage(\n        bitmap as CanvasImageSource,\n        0,\n        0,\n        layout.width,\n        layout.height\n      );\n    }\n\n    if (dynamicElement) {\n      context!.drawImage(\n        dynamicElement as CanvasImageSource,\n        (layout.width - dynamicElement.width) / 2,\n        (layout.height - dynamicElement.height) / 2\n      );\n    }\n\n    for (let i = 0; i < shapes.length; i++) {\n      this.drawShape(shapes[i]);\n    }\n\n    context!.restore();\n  }\n\n  /**\n   * 调整画布尺寸\n   * @param contentMode\n   * @param videoSize\n   * @param canvasSize\n   * @returns\n   */\n  public resize(\n    contentMode: PLAYER_CONTENT_MODE,\n    videoSize: PlatformVideo.VideoSize,\n    canvasSize: CanvasSize\n  ): void {\n    const { width: canvasWidth, height: canvasHeight } = canvasSize;\n    const { width: videoWidth, height: videoHeight } = videoSize;\n    const resizeKey = `${contentMode}-${videoWidth}-${videoHeight}-${canvasWidth}-${canvasHeight}`;\n    const lastTransform = this.globalTransform;\n\n    if (this.lastResizeKey === resizeKey && lastTransform) {\n      return;\n    }\n\n    let scale: TransformScale = {\n      scaleX: 1,\n      scaleY: 1,\n      translateX: 0,\n      translateY: 0,\n    };\n\n    if (contentMode === PLAYER_CONTENT_MODE.FILL) {\n      scale.scaleX = canvasWidth / videoWidth;\n      scale.scaleY = canvasHeight / videoHeight;\n    } else {\n      scale = Renderer2D.calculateScale(contentMode, videoSize, canvasSize);\n    }\n\n    this.lastResizeKey = resizeKey;\n    this.globalTransform = {\n      a: scale.scaleX,\n      b: 0.0,\n      c: 0.0,\n      d: scale.scaleY,\n      tx: scale.translateX,\n      ty: scale.translateY,\n    };\n  }\n\n  public render(\n    videoEntity: PlatformVideo.Video,\n    materials: Map<string, Bitmap>,\n    dynamicMaterials: Map<string, Bitmap>,\n    currentFrame: number,\n    head: number,\n    tail: number\n  ): void {\n    let sprite: PlatformVideo.VideoSprite;\n    let imageKey: string;\n    let bitmap: Bitmap | undefined;\n    let dynamicElement: Bitmap | undefined;\n\n    for (let i = head; i < tail; i++) {\n      sprite = videoEntity.sprites[i];\n      imageKey = sprite.imageKey;\n      bitmap = materials.get(imageKey);\n      dynamicElement = dynamicMaterials.get(imageKey);\n\n      this.drawSprite(sprite.frames[currentFrame], bitmap, dynamicElement);\n    }\n  }\n\n  public destroy() {\n    this.globalTransform = undefined;\n    this.lastResizeKey = \"\";\n    this.context = null;\n  }\n}\n","import { platform } from \"../../platform\";\n\n/**\n * 动画控制器\n */\nexport class Animator {\n  /**\n   * 动画是否执行\n   */\n  private isRunning = false;\n  /**\n   * 动画开始时间\n   */\n  private startTime = 0;\n  /**\n   * 动画持续时间\n   */\n  private duration: number = 0;\n  /**\n   * 循环播放开始帧与动画开始帧之间的时间偏差\n   */\n  private loopStart: number = 0;\n  /**\n   * 动画暂停时的时间偏差\n   */\n  private pauseTime: number = 0;\n  /**\n   * 循环持续时间\n   */\n  private loopDuration: number = 0;\n\n  public onAnimate: (callback: () => void) => number = platform.noop<number>;\n\n  /* ---- 事件钩子 ---- */\n  public onStart: () => void = platform.noop;\n  public onUpdate: (timePercent: number) => void = platform.noop;\n  public onEnd: () => void = platform.noop;\n\n  /**\n   * 设置动画的必要参数\n   * @param duration\n   * @param loopStart\n   * @param loop\n   * @param fillValue\n   */\n  public setConfig(\n    duration: number,\n    loopStart: number,\n    loop: number,\n    fillValue: number\n  ) {\n    this.duration = duration;\n    this.loopStart = loopStart;\n    this.loopDuration = duration * loop + fillValue - loopStart;\n  }\n\n  public start(): void {\n    this.isRunning = true;\n    this.startTime = platform.now();\n    this.pauseTime = 0;\n    this.onStart();\n    this.doFrame();\n  }\n\n  public resume(): boolean {\n    if (this.startTime === 0) {\n      return false;\n    }\n\n    this.isRunning = true;\n    this.doFrame();\n    return true;\n  }\n\n  public pause(): boolean {\n    if (this.startTime === 0) {\n      return false;\n    }\n\n    this.isRunning = false;\n    // 设置暂停的位置\n    this.pauseTime =\n      (platform.now() - this.startTime) % this.duration;\n    return true;\n  }\n\n  public stop(): void {\n    this.isRunning = false;\n    this.startTime = 0;\n  }\n\n  private doFrame(): void {\n    if (this.isRunning) {\n      this.doDeltaTime(platform.now() - this.startTime);\n      if (this.isRunning) {\n        this.onAnimate(() => this.doFrame());\n      }\n    }\n  }\n\n  private doDeltaTime(deltaTime: number): void {\n    const { duration, loopStart, pauseTime, loopDuration } = this;\n    // 本轮动画已消耗的时间比例（Percentage of speed time）\n    let percent: number;\n    let ended = false;\n\n    // 运行时间 大于等于 循环持续时间\n    if (deltaTime >= loopDuration) {\n      // 动画已结束\n      percent = 1.0;\n      ended = true;\n      this.stop();\n    } else {\n      // 本轮动画已消耗的时间比例 = 本轮动画已消耗的时间 / 动画持续时间\n      percent = ((deltaTime + loopStart + pauseTime) % duration) / duration;\n    }\n\n    this.onUpdate(percent);\n    if (!this.isRunning && ended) {\n      this.onEnd();\n    }\n  }\n}\n","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\n\n// aliases for shorter compressed code (most minifers don't do this)\nconst u8 = Uint8Array, u16 = Uint16Array, i32 = Int32Array;\n\n// fixed length extra bits\nconst fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n\n// fixed distance extra bits\nconst fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n\n// code length index map\nconst clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n\n// get base, reverse index map from extra bits\nconst freb = (eb: Uint8Array, start: number) => {\n  const b = new u16(31);\n  for (let i = 0; i < 31; ++i) {\n    b[i] = start += 1 << eb[i - 1];\n  }\n  // numbers here are at max 18 bits\n  const r = new i32(b[30]);\n  for (let i = 1; i < 30; ++i) {\n    for (let j = b[i]; j < b[i + 1]; ++j) {\n      r[j] = ((j - b[i]) << 5) | i;\n    }\n  }\n  return { b, r };\n}\n\nconst { b: fl, r: revfl } = freb(fleb, 2);\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nconst { b: fd, r: revfd } = freb(fdeb, 0);\n\n// map of value to reverse (assuming 16 bits)\nconst rev = new u16(32768);\nfor (let i = 0; i < 32768; ++i) {\n  // reverse table algorithm from SO\n  let x = ((i & 0xAAAA) >> 1) | ((i & 0x5555) << 1);\n  x = ((x & 0xCCCC) >> 2) | ((x & 0x3333) << 2);\n  x = ((x & 0xF0F0) >> 4) | ((x & 0x0F0F) << 4);\n  rev[i] = (((x & 0xFF00) >> 8) | ((x & 0x00FF) << 8)) >> 1;\n}\n\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nconst hMap = ((cd: Uint8Array, mb: number, r: 0 | 1) => {\n  const s = cd.length;\n  // index\n  let i = 0;\n  // u16 \"map\": index -> # of codes with bit length = index\n  const l = new u16(mb);\n  // length of cd must be 288 (total # of codes)\n  for (; i < s; ++i) {\n    if (cd[i]) ++l[cd[i] - 1];\n  }\n  // u16 \"map\": index -> minimum code for bit length = index\n  const le = new u16(mb);\n  for (i = 1; i < mb; ++i) {\n    le[i] = (le[i - 1] + l[i - 1]) << 1;\n  }\n  let co: Uint16Array;\n  if (r) {\n    // u16 \"map\": index -> number of actual bits, symbol for code\n    co = new u16(1 << mb);\n    // bits to remove for reverser\n    const rvb = 15 - mb;\n    for (i = 0; i < s; ++i) {\n      // ignore 0 lengths\n      if (cd[i]) {\n        // num encoding both symbol and bits read\n        const sv = (i << 4) | cd[i];\n        // free bits\n        const r = mb - cd[i];\n        // start value\n        let v = le[cd[i] - 1]++ << r;\n        // m is end value\n        for (const m = v | ((1 << r) - 1); v <= m; ++v) {\n          // every 16 bit value starting with the code yields the same result\n          co[rev[v] >> rvb] = sv;\n        }\n      }\n    }\n  } else {\n    co = new u16(s);\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        co[i] = rev[le[cd[i] - 1]++] >> (15 - cd[i]);\n      }\n    }\n  }\n  return co;\n});\n\n// fixed length tree\nconst flt = new u8(288);\nfor (let i = 0; i < 144; ++i) flt[i] = 8;\nfor (let i = 144; i < 256; ++i) flt[i] = 9;\nfor (let i = 256; i < 280; ++i) flt[i] = 7;\nfor (let i = 280; i < 288; ++i) flt[i] = 8;\n// fixed distance tree\nconst fdt = new u8(32);\nfor (let i = 0; i < 32; ++i) fdt[i] = 5;\n// fixed length map\nconst flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nconst fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n\n// find max of array\nconst max = (a: Uint8Array | number[]) => {\n  let m = a[0];\n  for (let i = 1; i < a.length; ++i) {\n    if (a[i] > m) m = a[i];\n  }\n  return m;\n};\n\n// read d, starting at bit p and mask with m\nconst bits = (d: Uint8Array, p: number, m: number) => {\n  const o = (p / 8) | 0;\n  return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n}\n\n// read d, starting at bit p continuing for at least 16 bits\nconst bits16 = (d: Uint8Array, p: number) => {\n  const o = (p / 8) | 0;\n  return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n}\n\n// get end of byte\nconst shft = (p: number) => ((p + 7) / 8) | 0;\n\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nconst slc = (v: Uint8Array, s: number, e?: number) => {\n  if (s == null || s < 0) s = 0;\n  if (e == null || e > v.length) e = v.length;\n  // can't use .constructor in case user-supplied\n  return new u8(v.subarray(s, e));\n}\n\n// inflate state\ntype InflateState = {\n  // lmap\n  l?: Uint16Array;\n  // dmap\n  d?: Uint16Array;\n  // lbits\n  m?: number;\n  // dbits\n  n?: number;\n  // final\n  f?: number;\n  // pos\n  p?: number;\n  // byte\n  b?: number;\n  // lstchk\n  i: number;\n};\n\n// error codes\nconst ec = [\n  'unexpected EOF',\n  'invalid block type',\n  'invalid length/literal',\n  'invalid distance',\n  'stream finished',\n  'no stream handler',\n  , // determined by compression function\n  'no callback',\n  'invalid UTF-8 data',\n  'extra field too long',\n  'date not in range 1980-2099',\n  'filename too long',\n  'stream finishing',\n  'invalid zip data'\n  // determined by unknown compression method\n];\n\n/**\n * An error generated within this library\n */\nexport interface FlateError extends Error {\n  /**\n   * The code associated with this error\n   */\n  code: number;\n};\n\nconst err = (ind: number, msg?: string | 0, nt?: 1) => {\n  const e: Partial<FlateError> = new Error(msg || ec[ind]);\n  e.code = ind;\n  if (Error.captureStackTrace) Error.captureStackTrace(e, err);\n  if (!nt) throw e;\n  return e as FlateError;\n}\n\n// expands raw DEFLATE data\nconst inflt = (dat: Uint8Array, st: InflateState, buf?: Uint8Array, dict?: Uint8Array) => {\n  // source length       dict length\n  const sl = dat.length, dl = dict ? dict.length : 0;\n  if (!sl || st.f && !st.l) return buf || new u8(0);\n  const noBuf = !buf;\n  // have to estimate size\n  const resize = noBuf || st.i != 2;\n  // no state\n  const noSt = st.i;\n  // Assumes roughly 33% compression ratio average\n  if (noBuf) buf = new u8(sl * 3);\n  // ensure buffer can fit at least l elements\n  const cbuf = (l: number) => {\n    let bl = buf!.length;\n    // need to increase size to fit\n    if (l > bl) {\n      // Double or set to necessary, whichever is greater\n      const nbuf = new u8(Math.max(bl * 2, l));\n      nbuf.set(buf!);\n      buf = nbuf;\n    }\n  };\n  //  last chunk         bitpos           bytes\n  let final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n  // total bits\n  const tbts = sl * 8;\n  do {\n    if (!lm) {\n      // BFINAL - this is only 1 when last chunk is next\n      final = bits(dat, pos, 1);\n      // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n      const type = bits(dat, pos + 1, 3);\n      pos += 3;\n      if (!type) {\n        // go to end of byte boundary\n        const s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n        if (t > sl) {\n          if (noSt) err(0);\n          break;\n        }\n        // ensure size\n        if (resize) cbuf(bt + l);\n        // Copy over uncompressed data\n        buf!.set(dat.subarray(s, t), bt);\n        // Get new bitpos, update byte count\n        st.b = bt += l, st.p = pos = t * 8, st.f = final;\n        continue;\n      }\n      else if (type == 1) lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n      else if (type == 2) {\n        //  literal                            lengths\n        const hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n        const tl = hLit + bits(dat, pos + 5, 31) + 1;\n        pos += 14;\n        // length+distance tree\n        const ldt = new u8(tl);\n        // code length tree\n        const clt = new u8(19);\n        for (let i = 0; i < hcLen; ++i) {\n          // use index map to get real code\n          clt[clim[i]] = bits(dat, pos + i * 3, 7);\n        }\n        pos += hcLen * 3;\n        // code lengths bits\n        const clb = max(clt), clbmsk = (1 << clb) - 1;\n        // code lengths map\n        const clm = hMap(clt, clb, 1);\n        for (let i = 0; i < tl;) {\n          const r = clm[bits(dat, pos, clbmsk)];\n          // bits read\n          pos += r & 15;\n          // symbol\n          const s = r >> 4;\n          // code length to copy\n          if (s < 16) {\n            ldt[i++] = s;\n          } else {\n            //  copy   count\n            let c = 0, n = 0;\n            if (s == 16) n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n            else if (s == 17) n = 3 + bits(dat, pos, 7), pos += 3;\n            else if (s == 18) n = 11 + bits(dat, pos, 127), pos += 7;\n            while (n--) ldt[i++] = c;\n          }\n        }\n        //    length tree                 distance tree\n        const lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n        // max length bits\n        lbt = max(lt)\n        // max dist bits\n        dbt = max(dt);\n        lm = hMap(lt, lbt, 1);\n        dm = hMap(dt, dbt, 1);\n      } else err(1);\n      if (pos > tbts) {\n        if (noSt) err(0);\n        break;\n      }\n    }\n    // Make sure the buffer can hold this + the largest possible addition\n    // Maximum chunk size (practically, theoretically infinite) is 2^17\n    if (resize) cbuf(bt + 131072);\n    const lms = (1 << lbt!) - 1, dms = (1 << dbt!) - 1;\n    let lpos = pos;\n    for (;; lpos = pos) {\n      // bits read, code\n      const c = lm![bits16(dat, pos) & lms], sym = c >> 4;\n      pos += c & 15;\n      if (pos > tbts) {\n        if (noSt) err(0);\n        break;\n      }\n      if (!c) err(2);\n      if (sym < 256) buf![bt++] = sym;\n      else if (sym == 256) {\n        lpos = pos, lm = undefined;\n        break;\n      } else {\n        let add = sym - 254;\n        // no extra bits needed if less\n        if (sym > 264) {\n          // index\n          const i = sym - 257, b = fleb[i];\n          add = bits(dat, pos, (1 << b) - 1) + fl[i];\n          pos += b;\n        }\n        // dist\n        const d = dm![bits16(dat, pos) & dms], dsym = d >> 4;\n        if (!d) err(3);\n        pos += d & 15;\n        let dt = fd[dsym];\n        if (dsym > 3) {\n          const b = fdeb[dsym];\n          dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n        }\n        if (pos > tbts) {\n          if (noSt) err(0);\n          break;\n        }\n        if (resize) cbuf(bt + 131072);\n        const end = bt + add;\n        if (bt < dt) {\n          const shift = dl - dt, dend = Math.min(dt, end);\n          if (shift + bt < 0) err(3);\n          for (; bt < dend; ++bt) buf![bt] = dict![shift + bt];\n        }\n        for (; bt < end; ++bt) buf![bt] = buf![bt - dt];\n      }\n    }\n    st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n    if (lm) final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n  } while (!final)\n  // don't reallocate for streams or user buffers\n  return bt != buf!.length && noBuf ? slc(buf!, 0, bt) : buf!.subarray(0, bt);\n}\n\n// starting at p, write the minimum number of bits that can hold v to d\nconst wbits = (d: Uint8Array, p: number, v: number) => {\n  v <<= p & 7;\n  const o = (p / 8) | 0;\n  d[o] |= v;\n  d[o + 1] |= v >> 8;\n}\n\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nconst wbits16 = (d: Uint8Array, p: number, v: number) => {\n  v <<= p & 7;\n  const o = (p / 8) | 0;\n  d[o] |= v;\n  d[o + 1] |= v >> 8;\n  d[o + 2] |= v >> 16;\n}\n\ntype HuffNode = {\n  // symbol\n  s: number;\n  // frequency\n  f: number;\n  // left child\n  l?: HuffNode;\n  // right child\n  r?: HuffNode;\n};\n\n// creates code lengths from a frequency table\nconst hTree = (d: Uint16Array, mb: number) => {\n  // Need extra info to make a tree\n  const t: HuffNode[] = [];\n  for (let i = 0; i < d.length; ++i) {\n    if (d[i]) t.push({ s: i, f: d[i] });\n  }\n  const s = t.length;\n  const t2 = t.slice();\n  if (!s) return { t: et, l: 0 };\n  if (s == 1) {\n    const v = new u8(t[0].s + 1);\n    v[t[0].s] = 1;\n    return { t: v, l: 1 };\n  }\n  t.sort((a, b) => a.f - b.f);\n  // after i2 reaches last ind, will be stopped\n  // freq must be greater than largest possible number of symbols\n  t.push({ s: -1, f: 25001 });\n  let l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n  t[0] = { s: -1, f: l.f + r.f, l, r };\n  // efficient algorithm from UZIP.js\n  // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n  // symbols that combined have high freq, will start processing i2 (high-freq,\n  // non-composite) symbols instead\n  // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n  while (i1 != s - 1) {\n    l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n    r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n    t[i1++] = { s: -1, f: l.f + r.f, l, r };\n  }\n  let maxSym = t2[0].s;\n  for (let i = 1; i < s; ++i) {\n    if (t2[i].s > maxSym) maxSym = t2[i].s;\n  }\n  // code lengths\n  const tr = new u16(maxSym + 1);\n  // max bits in tree\n  let mbt = ln(t[i1 - 1], tr, 0);\n  if (mbt > mb) {\n    // more algorithms from UZIP.js\n    // TODO: find out how this code works (debt)\n    //  ind    debt\n    let i = 0, dt = 0;\n    //    left            cost\n    const lft = mbt - mb, cst = 1 << lft;\n    t2.sort((a, b) => tr[b.s] - tr[a.s] || a.f - b.f);\n    for (; i < s; ++i) {\n      const i2 = t2[i].s;\n      if (tr[i2] > mb) {\n        dt += cst - (1 << (mbt - tr[i2]));\n        tr[i2] = mb;\n      } else break;\n    }\n    dt >>= lft;\n    while (dt > 0) {\n      const i2 = t2[i].s;\n      if (tr[i2] < mb) dt -= 1 << (mb - tr[i2]++ - 1);\n      else ++i;\n    }\n    for (; i >= 0 && dt; --i) {\n      const i2 = t2[i].s;\n      if (tr[i2] == mb) {\n        --tr[i2];\n        ++dt;\n      }\n    }\n    mbt = mb;\n  }\n  return { t: new u8(tr), l: mbt };\n}\n// get the max length and assign length codes\nconst ln = (n: HuffNode, l: Uint16Array, d: number): number => {\n  return n.s == -1\n    ? Math.max(ln(n.l!, l, d + 1), ln(n.r!, l, d + 1))\n    : (l[n.s] = d);\n}\n\n// length codes generation\nconst lc = (c: Uint8Array) => {\n  let s = c.length;\n  // Note that the semicolon was intentional\n  while (s && !c[--s]);\n  const cl = new u16(++s);\n  //  ind      num         streak\n  let cli = 0, cln = c[0], cls = 1;\n  const w = (v: number) => { cl[cli++] = v; }\n  for (let i = 1; i <= s; ++i) {\n    if (c[i] == cln && i != s)\n      ++cls;\n    else {\n      if (!cln && cls > 2) {\n        for (; cls > 138; cls -= 138) w(32754);\n        if (cls > 2) {\n          w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n          cls = 0;\n        }\n      } else if (cls > 3) {\n        w(cln), --cls;\n        for (; cls > 6; cls -= 6) w(8304);\n        if (cls > 2) w(((cls - 3) << 5) | 8208), cls = 0;\n      }\n      while (cls--) w(cln);\n      cls = 1;\n      cln = c[i];\n    }\n  }\n  return { c: cl.subarray(0, cli), n: s };\n}\n\n// calculate the length of output from tree, code lengths\nconst clen = (cf: Uint16Array, cl: Uint8Array) => {\n  let l = 0;\n  for (let i = 0; i < cl.length; ++i) l += cf[i] * cl[i];\n  return l;\n}\n\n// writes a fixed block\n// returns the new bit pos\nconst wfblk = (out: Uint8Array, pos: number, dat: Uint8Array) => {\n  // no need to write 00 as type: TypedArray defaults to 0\n  const s = dat.length;\n  const o = shft(pos + 2);\n  out[o] = s & 255;\n  out[o + 1] = s >> 8;\n  out[o + 2] = out[o] ^ 255;\n  out[o + 3] = out[o + 1] ^ 255;\n  for (let i = 0; i < s; ++i) out[o + i + 4] = dat[i];\n  return (o + 4 + s) * 8;\n}\n\n// writes a block\nconst wblk = (dat: Uint8Array, out: Uint8Array, final: number, syms: Int32Array, lf: Uint16Array, df: Uint16Array, eb: number, li: number, bs: number, bl: number, p: number) => {\n  wbits(out, p++, final);\n  ++lf[256];\n  const { t: dlt, l: mlb } = hTree(lf, 15);\n  const { t: ddt, l: mdb } = hTree(df, 15);\n  const { c: lclt, n: nlc } = lc(dlt);\n  const { c: lcdt, n: ndc } = lc(ddt);\n  const lcfreq = new u16(19);\n  for (let i = 0; i < lclt.length; ++i) ++lcfreq[lclt[i] & 31];\n  for (let i = 0; i < lcdt.length; ++i) ++lcfreq[lcdt[i] & 31];\n  const { t: lct, l: mlcb } = hTree(lcfreq, 7);\n  let nlcc = 19;\n  for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc);\n  const flen = (bl + 5) << 3;\n  const ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n  const dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + 2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18];\n  if (bs >= 0 && flen <= ftlen && flen <= dtlen) return wfblk(out, p, dat.subarray(bs, bs + bl));\n  let lm: Uint16Array, ll: Uint8Array, dm: Uint16Array, dl: Uint8Array;\n  wbits(out, p, 1 + (dtlen < ftlen as unknown as number)), p += 2;\n  if (dtlen < ftlen) {\n    lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n    const llm = hMap(lct, mlcb, 0);\n    wbits(out, p, nlc - 257);\n    wbits(out, p + 5, ndc - 1);\n    wbits(out, p + 10, nlcc - 4);\n    p += 14;\n    for (let i = 0; i < nlcc; ++i) wbits(out, p + 3 * i, lct[clim[i]]);\n    p += 3 * nlcc;\n    const lcts = [lclt, lcdt];\n    for (let it = 0; it < 2; ++it) {\n      const clct = lcts[it];\n      for (let i = 0; i < clct.length; ++i) {\n        const len = clct[i] & 31;\n        wbits(out, p, llm[len]), p += lct[len];\n        if (len > 15) wbits(out, p, (clct[i] >> 5) & 127), p += clct[i] >> 12;\n      }\n    }\n  } else {\n    lm = flm, ll = flt, dm = fdm, dl = fdt;\n  }\n  for (let i = 0; i < li; ++i) {\n    const sym = syms[i];\n    if (sym > 255) {\n      const len = (sym >> 18) & 31;\n      wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n      if (len > 7) wbits(out, p, (sym >> 23) & 31), p += fleb[len];\n      const dst = sym & 31;\n      wbits16(out, p, dm[dst]), p += dl[dst];\n      if (dst > 3) wbits16(out, p, (sym >> 5) & 8191), p += fdeb[dst];\n    } else {\n      wbits16(out, p, lm[sym]), p += ll[sym];\n    }\n  }\n  wbits16(out, p, lm[256]);\n  return p + ll[256];\n}\n\n// deflate options (nice << 13) | chain\nconst deo = /*#__PURE__*/ new i32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n\n// empty\nconst et = /*#__PURE__*/new u8(0);\n\ntype DeflateState = {\n  // head\n  h?: Uint16Array;\n  // prev\n  p?: Uint16Array;\n  // index\n  i?: number;\n  // end index\n  z?: number;\n  // wait index\n  w?: number;\n  // remainder byte info\n  r?: number;\n  // last chunk\n  l: number;\n};\n\n// compresses data into a raw DEFLATE buffer\nconst dflt = (dat: Uint8Array, lvl: number, plvl: number, pre: number, post: number, st: DeflateState) => {\n  const s = st.z || dat.length;\n  const o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n  // writing to this writes to the output buffer\n  const w = o.subarray(pre, o.length - post);\n  const lst = st.l;\n  let pos = (st.r || 0) & 7;\n  if (lvl) {\n    if (pos) w[0] = st.r! >> 3;\n    const opt = deo[lvl - 1];\n    const n = opt >> 13, c = opt & 8191;\n    const msk = (1 << plvl) - 1;\n    //    prev 2-byte val map    curr 2-byte val map\n    const prev = st.p || new u16(32768), head = st.h || new u16(msk + 1);\n    const bs1 = Math.ceil(plvl / 3), bs2 = 2 * bs1;\n    const hsh = (i: number) => (dat[i] ^ (dat[i + 1] << bs1) ^ (dat[i + 2] << bs2)) & msk;\n    // 24576 is an arbitrary number of maximum symbols per block\n    // 424 buffer for last block\n    const syms = new i32(25000);\n    // length/literal freq   distance freq\n    const lf = new u16(288), df = new u16(32);\n    //  l/lcnt  exbits  index          l/lind  waitdx          blkpos\n    let lc = 0, eb = 0, i = st.i || 0, li = 0, wi = st.w || 0, bs = 0;\n    for (; i + 2 < s; ++i) {\n      // hash value\n      const hv = hsh(i);\n      // index mod 32768    previous index mod\n      let imod = i & 32767, pimod = head[hv];\n      prev[imod] = pimod;\n      head[hv] = imod;\n      // We always should modify head and prev, but only add symbols if\n      // this data is not yet processed (\"wait\" for wait index)\n      if (wi <= i) {\n        // bytes remaining\n        const rem = s - i;\n        if ((lc > 7000 || li > 24576) && (rem > 423 || !lst)) {\n          pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n          li = lc = eb = 0, bs = i;\n          for (let j = 0; j < 286; ++j) lf[j] = 0;\n          for (let j = 0; j < 30; ++j) df[j] = 0;\n        }\n        //  len    dist   chain\n        let l = 2, d = 0, ch = c, dif = imod - pimod & 32767;\n        if (rem > 2 && hv == hsh(i - dif)) {\n          const maxn = Math.min(n, rem) - 1;\n          const maxd = Math.min(32767, i);\n          // max possible length\n          // not capped at dif because decompressors implement \"rolling\" index population\n          const ml = Math.min(258, rem);\n          while (dif <= maxd && --ch && imod != pimod) {\n            if (dat[i + l] == dat[i + l - dif]) {\n              let nl = 0;\n              for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl);\n              if (nl > l) {\n                l = nl, d = dif;\n                // break out early when we reach \"nice\" (we are satisfied enough)\n                if (nl > maxn) break;\n                // now, find the rarest 2-byte sequence within this\n                // length of literals and search for that instead.\n                // Much faster than just using the start\n                const mmd = Math.min(dif, nl - 2);\n                let md = 0;\n                for (let j = 0; j < mmd; ++j) {\n                  const ti = i - dif + j & 32767;\n                  const pti = prev[ti];\n                  const cd = ti - pti & 32767;\n                  if (cd > md) md = cd, pimod = ti;\n                }\n              }\n            }\n            // check the previous match\n            imod = pimod, pimod = prev[imod];\n            dif += imod - pimod & 32767;\n          }\n        }\n        // d will be nonzero only when a match was found\n        if (d) {\n          // store both dist and len data in one int32\n          // Make sure this is recognized as a len/dist with 28th bit (2^28)\n          syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n          const lin = revfl[l] & 31, din = revfd[d] & 31;\n          eb += fleb[lin] + fdeb[din];\n          ++lf[257 + lin];\n          ++df[din];\n          wi = i + l;\n          ++lc;\n        } else {\n          syms[li++] = dat[i];\n          ++lf[dat[i]];\n        }\n      }\n    }\n    for (i = Math.max(i, wi); i < s; ++i) {\n      syms[li++] = dat[i];\n      ++lf[dat[i]];\n    }\n    pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n    if (!lst) {\n      st.r = (pos & 7) | w[(pos / 8) | 0] << 3;\n      // shft(pos) now 1 less if pos & 7 != 0\n      pos -= 7;\n      st.h = head, st.p = prev, st.i = i, st.w = wi;\n    }\n  } else {\n    for (let i = st.w || 0; i < s + lst; i += 65535) {\n      // end\n      let e = i + 65535;\n      if (e >= s) {\n        // write final block\n        w[(pos / 8) | 0] = lst;\n        e = s;\n      }\n      pos = wfblk(w, pos + 1, dat.subarray(i, e));\n    }\n    st.i = s;\n  }\n  return slc(o, 0, pre + shft(pos) + post);\n}\n\n// crc check\ntype CRCV = {\n  p(d: Uint8Array): void;\n  d(): number;\n};\n\n// Adler32\nconst adler = (): CRCV => {\n  let a = 1, b = 0;\n  return {\n    p(d) {\n      // closures have awful performance\n      let n = a, m = b;\n      const l = d.length | 0;\n      for (let i = 0; i != l;) {\n        const e = Math.min(i + 2655, l);\n        for (; i < e; ++i) m += n += d[i];\n        n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n      }\n      a = n, b = m;\n    },\n    d() {\n      a %= 65521, b %= 65521;\n      return (a & 255) << 24 | (a & 0xFF00) << 8 | (b & 255) << 8 | (b >> 8);\n    }\n  }\n}\n\n/**\n * Options for compressing data into a DEFLATE format\n */\nexport interface DeflateOptions {\n  /**\n   * The level of compression to use, ranging from 0-9.\n   * \n   * 0 will store the data without compression.\n   * 1 is fastest but compresses the worst, 9 is slowest but compresses the best.\n   * The default level is 6.\n   * \n   * Typically, binary data benefits much more from higher values than text data.\n   * In both cases, higher values usually take disproportionately longer than the reduction in final size that results.\n   * \n   * For example, a 1 MB text file could:\n   * - become 1.01 MB with level 0 in 1ms\n   * - become 400 kB with level 1 in 10ms\n   * - become 320 kB with level 9 in 100ms\n   */\n  level?: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9;\n  /**\n   * The memory level to use, ranging from 0-12. Increasing this increases speed and compression ratio at the cost of memory.\n   * \n   * Note that this is exponential: while level 0 uses 4 kB, level 4 uses 64 kB, level 8 uses 1 MB, and level 12 uses 16 MB.\n   * It is recommended not to lower the value below 4, since that tends to hurt performance.\n   * In addition, values above 8 tend to help very little on most data and can even hurt performance.\n   * \n   * The default value is automatically determined based on the size of the input data.\n   */\n  mem?: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12;\n  /**\n   * A buffer containing common byte sequences in the input data that can be used to significantly improve compression ratios.\n   * \n   * Dictionaries should be 32kB or smaller and include strings or byte sequences likely to appear in the input.\n   * The decompressor must supply the same dictionary as the compressor to extract the original data.\n   * \n   * Dictionaries only improve aggregate compression ratio when reused across multiple small inputs. They should typically not be used otherwise.\n   * \n   * Avoid using dictionaries with GZIP and ZIP to maximize software compatibility.\n   */\n  dictionary?: Uint8Array;\n};\n\n/**\n * Options for compressing data into a Zlib format\n */\nexport interface ZlibOptions extends DeflateOptions {}\n\n/**\n * Options for decompressing DEFLATE data\n */\nexport interface InflateOptions {\n  /**\n   * The dictionary used to compress the original data. If no dictionary was used during compression, this option has no effect.\n   * \n   * Supplying the wrong dictionary during decompression usually yields corrupt output or causes an invalid distance error.\n   */\n  dictionary?: Uint8Array;\n  /**\n   * The buffer into which to write the decompressed data. Saves memory if you know the decompressed size in advance.\n   * \n   * Note that if the decompression result is larger than the size of this buffer, it will be truncated to fit.\n   */\n  out?: Uint8Array;\n}\n\n/**\n * Options for decompressing Zlib data\n */\nexport interface UnzlibOptions extends InflateOptions {}\n\n// deflate with opts\nconst dopt = (dat: Uint8Array, opt: DeflateOptions, pre: number, post: number, st?: DeflateState) => {\n  if (!st) {\n    st = { l: 1 };\n    if (opt.dictionary) {\n      const dict = opt.dictionary.subarray(-32768);\n      const newDat = new u8(dict.length + dat.length);\n      newDat.set(dict);\n      newDat.set(dat, dict.length);\n      dat = newDat;\n      st.w = dict.length;\n    }\n  }\n  return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? (st.l ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : 20) : (12 + opt.mem), pre, post, st);\n}\n\n// write bytes\nconst wbytes = (d: Uint8Array, b: number, v: number) => {\n  for (; v; ++b) d[b] = v, v >>>= 8;\n}\n\n// zlib header\nconst zlh = (c: Uint8Array, o: ZlibOptions) => {\n  const lv = o.level ?? 0, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n  c[0] = 120, c[1] = (fl << 6) | ((o.dictionary ?? 0) && 32);\n  c[1] |= 31 - ((c[0] << 8) | c[1]) % 31;\n  if (o.dictionary) {\n    const h = adler();\n    h.p(o.dictionary);\n    wbytes(c, 2, h.d());\n  }\n}\n\n// zlib start\nconst zls = (d: Uint8Array, dict?: unknown) => {\n  if ((d[0] & 15) != 8 || (d[0] >> 4) > 7 || ((d[0] << 8 | d[1]) % 31)) err(6, 'invalid zlib data');\n  if ((d[1] >> 5 & 1) == +!dict) err(6, 'invalid zlib data: ' + (d[1] & 32 ? 'need' : 'unexpected') + ' dictionary');\n  return (d[1] >> 3 & 4) + 2;\n}\n\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data: Uint8Array, opts: ZlibOptions = {}) {\n  const a = adler();\n  a.p(data);\n  const d = dopt(data, opts, opts.dictionary ? 6 : 2, 4);\n  return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data: Uint8Array, opts: UnzlibOptions = {}) {\n  return inflt(data.subarray(zls(data, opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n","import { platform } from \"../../platform\";\n\nexport class CRC32 {\n  // CRC32 Table 初始化\n  private static table = Uint32Array.from(Array(256), (_, i) => {\n    let c = i;\n\n    for (let j = 0; j < 8; j++) {\n      c = (c & 1) ? (0xedb88320 ^ (c >>> 1)) : (c >>> 1);\n    }\n\n    return c >>> 0;\n  });\n\n  private static WHITE_COLOR: number = 0xffffffff;\n\n  private readonly caches = new Map<string, number>();\n\n  calculate(buff: Uint8Array): number {\n    if (!(buff instanceof Uint8Array)) {\n      throw new TypeError('Input must be a Uint8Array');\n    }\n\n    const { caches } = this;\n    const key = platform.decode.bytesToString(buff);\n  \n    if (caches.has(key)) {\n      return caches.get(key)!;\n    }\n\n    let crc = CRC32.WHITE_COLOR;\n    // 使用位运算优化\n    for (let i = 0; i < buff.length; i++) {\n      crc = (crc >>> 8) ^ CRC32.table[(crc ^ buff[i]) & 0xff];\n    }\n\n    caches.set(key, (crc ^ CRC32.WHITE_COLOR) >>> 0);\n\n    return caches.get(key) as number;\n  }\n\n  clear(){\n    this.caches.clear();\n  }\n}","// ---------------------------------------------------------------------\n// QRMath\n// ---------------------------------------------------------------------\n\nconst EXP_TABLE = new Array(256);\nconst LOG_TABLE = new Array(256);\n\n// initialize tables\nfor (let i = 0; i < 8; i++) {\n  EXP_TABLE[i] = 1 << i;\n}\n\nfor (let i = 8; i < 256; i++) {\n  EXP_TABLE[i] = EXP_TABLE[i - 4] ^ EXP_TABLE[i - 5] ^ EXP_TABLE[i - 6] ^ EXP_TABLE[i - 8];\n}\n\nfor (let i = 0; i < 255; i++) {\n  LOG_TABLE[EXP_TABLE[i]] = i;\n}\n\nexport const QRMath = {\n  glog(n: number): number {\n    if (n < 1) {\n      throw new Error(`glog(${n})`);\n    }\n\n    return LOG_TABLE[n];\n  },\n\n  gexp(n: number): number {\n    if (n < 0) {\n      n = 255 + (n % 255);\n    } else if (n > 255) {\n      n %= 255;\n    }\n\n    return EXP_TABLE[n];\n  }\n}\n","// import { zlibSync } from \"fflate\";\nimport { zlibSync } from \"../zlib\";\nimport { CRC32 } from \"./crc\";\n\nexport class PNGEncoder {\n  private readonly view: DataView;\n\n  private crc32 = new CRC32();\n\n  constructor(private readonly width: number, private readonly height: number) {\n    this.view = new DataView(new ArrayBuffer(4 * width * height));\n  }\n\n  private createChunk(type: string, data: Uint8Array): Uint8Array {\n    // 长度（4字节，大端序）\n    const length = new Uint8Array(4);\n    new DataView(length.buffer).setUint32(0, data.length, false);\n\n    // 块类型（4字节， ASCII）\n    const chunkType = Uint8Array.from(type, c => c.charCodeAt(0));\n\n    // 计算 CRC32 校验（类型 + 数据）\n    const partialChunk = new Uint8Array(chunkType.length + data.length);\n    partialChunk.set(chunkType);\n    partialChunk.set(data, chunkType.length);\n    \n    const crc = new Uint8Array(4);\n    new DataView(crc.buffer).setUint32(0, this.crc32.calculate(partialChunk) >>> 0, false);\n\n    // 汇总成完整的chunk数据\n    const result = new Uint8Array(length.length + partialChunk.length + crc.length);\n    result.set(length);\n    result.set(partialChunk, length.length);\n    result.set(crc, length.length + partialChunk.length);\n\n    return result;\n  }\n\n  private createIHDRChunk(): Uint8Array {\n    const ihdrData = new Uint8Array(13);\n    const view = new DataView(ihdrData.buffer);\n\n    // 宽度\n    view.setUint32(0, this.width, false);\n    // 高度\n    view.setUint32(4, this.height, false);\n    // 位深度\n    view.setUint8(8, 8);\n    // 颜色类型\n    view.setUint8(9, 6);\n    // 压缩方法\n    view.setUint8(10, 0);\n    // 过滤器方法\n    view.setUint8(11, 0);\n    // 交错方法\n    view.setUint8(12, 0);\n\n    return this.createChunk(\"IHDR\", ihdrData);\n  }\n\n  private createIDATChunk(): Uint8Array {\n    const { width, height } = this;\n    const validRowSize = width * 4;\n    // 每行开头添加一位过滤头数据\n    const rowSize = validRowSize + 1;\n    const data = new Uint8Array(rowSize * height);\n    // 将Uint32数据转换为Uint8数据\n    const pixelsData = new Uint8Array(this.view.buffer);\n    let startIdx: number;\n    let srcStart: number;\n\n    for (let y = 0; y < height; y++) {\n      startIdx = y * rowSize;\n      data[startIdx] = 0x00; // 过滤头\n      // ✅ 复制预先转换好的 RGBA 数据\n      srcStart = y * validRowSize; // Uint32 => 每个元素占 4 字节\n      data.set(pixelsData.subarray(srcStart, srcStart + validRowSize), startIdx + 1);\n    }\n\n    // 使用 zlib 进行压缩, 平衡压缩率有利于提升文件生成速度\n    return this.createChunk(\"IDAT\", zlibSync(data));\n  }\n\n  public setPixel(x: number, y: number, pixel: number): void {\n    this.view.setUint32((y * this.width + x) * 4, pixel, false);\n  }\n\n  public write(pixels: Uint8Array | Uint8ClampedArray): this {\n    const { width, height } = this;\n    let pos: number;\n    let r: number;\n    let g: number;\n    let b: number;\n    let a: number;\n    let pixel: number;\n\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        pos = (y * width + x) * 4;\n        r = pixels[pos];\n        g = pixels[pos + 1];\n        b = pixels[pos + 2];\n        a = pixels[pos + 3];\n        pixel = ((r << 24) | (g << 16) | (b << 8) | a) >>> 0;\n        this.setPixel(x, y, pixel);\n      }\n    }\n\n    return this;\n  }\n\n  public flush(): Uint8Array {\n    // 预先创建所有块\n    const iHDRChunk = this.createIHDRChunk();\n    const iDATChunk = this.createIDATChunk();\n    const iENDChunk = this.createChunk(\"IEND\", new Uint8Array(0));\n    \n    // 一次性分配内存（直接计算总大小）\n    const pngData = new Uint8Array(8 + iHDRChunk.length + iDATChunk.length + iENDChunk.length);\n    \n    /* ------ 按顺序写入数据 ------ */\n\n    // 1. 写入文件头（固定 8 字节）\n    let offset = 0;\n    pngData.set(new Uint8Array([137, 80, 78, 71, 13, 10, 26, 10]), offset);\n    // 2. 写入IHDR块\n    offset += 8;\n    pngData.set(iHDRChunk, offset);\n    // 3. 写入IDAT块\n    offset += iHDRChunk.length;\n    pngData.set(iDATChunk, offset);\n    // 4. 写入IEND块\n    offset += iDATChunk.length;\n    pngData.set(iENDChunk, offset);\n    \n    /* ------ 清空 CRC32 缓存 ------ */\n    this.crc32.clear();\n\n    return pngData;\n  }\n}\n","// ---------------------------------------------------------------------\n// qrBitBuffer\n// ---------------------------------------------------------------------\n\nexport class BitBuffer {\n  public buffer: number[] = [];\n\n  public lengthInBits = 0;\n\n  public getAt(i: number): boolean {\n    const bufIndex = ~~(i / 8);\n\n    return ((this.buffer[bufIndex] >>> (7 - (i % 8))) & 1) === 1;\n  }\n\n  public put(num: number, length: number): void {\n    for (let i = 0; i < length; i++) {\n      this.putBit(((num >>> (length - i - 1)) & 1) === 1);\n    }\n  }\n\n  public putBit(bit: boolean): void {\n    const { lengthInBits: len, buffer } = this;\n    const bufIndex = ~~(len / 8);\n\n    if (buffer.length <= bufIndex) {\n      buffer.push(0);\n    }\n\n    if (bit) {\n      buffer[bufIndex] |= 0x80 >>> len % 8;\n    }\n\n    this.lengthInBits += 1;\n  }\n}\n","// ---------------------------------------------------------------------\n// QRMode\n// ---------------------------------------------------------------------\n\nexport const QRMode = {\n  MODE_NUMBER: 1 << 0,\n  MODE_ALPHA_NUM: 1 << 1,\n  MODE_8BIT_BYTE: 1 << 2,\n  MODE_KANJI: 1 << 3,\n}\n\n// ---------------------------------------------------------------------\n// QRErrorCorrectLevel\n// ---------------------------------------------------------------------\n\nexport const QRErrorCorrectLevel = {\n  L: 1,\n  M: 0,\n  Q: 3,\n  H: 2,\n}\n\n// ---------------------------------------------------------------------\n// QRMaskPattern\n// ---------------------------------------------------------------------\n\nexport const QRMaskPattern = {\n  PATTERN000: 0,\n  PATTERN001: 1,\n  PATTERN010: 2,\n  PATTERN011: 3,\n  PATTERN100: 4,\n  PATTERN101: 5,\n  PATTERN110: 6,\n  PATTERN111: 7,\n}\n","// ---------------------------------------------------------------------\n// qr8BitByte\n// ---------------------------------------------------------------------\n\nimport { BitBuffer } from \"./bit-buffer\";\nimport { QRMode } from \"./constants\";\n\nexport class BitByte {\n  private readonly bytes: number[];\n\n  constructor(data: string) {\n    let parsedData: number[][] = [];\n\n    // Added to support UTF-8 Characters\n    for (let i = 0; i < data.length; i++) {\n      const byteArray: number[] = [];\n      const code = data.charCodeAt(i);\n\n      if (code > 0x10000) {\n        byteArray[0] = 0xf0 | ((code & 0x1c0000) >>> 18);\n        byteArray[1] = 0x80 | ((code & 0x3f000) >>> 12);\n        byteArray[2] = 0x80 | ((code & 0xfc0) >>> 6);\n        byteArray[3] = 0x80 | (code & 0x3f);\n      } else if (code > 0x800) {\n        byteArray[0] = 0xe0 | ((code & 0xf000) >>> 12);\n        byteArray[1] = 0x80 | ((code & 0xfc0) >>> 6);\n        byteArray[2] = 0x80 | (code & 0x3f);\n      } else if (code > 0x80) {\n        byteArray[0] = 0xc0 | ((code & 0x7c0) >>> 6);\n        byteArray[1] = 0x80 | (code & 0x3f);\n      } else {\n        byteArray[0] = code;\n      }\n\n      // Fix Unicode corruption bug\n      parsedData.push(byteArray);\n    }\n\n    this.bytes = parsedData.flat(1);\n\n    const { bytes } = this;\n    if (bytes.length !== data.length) {\n      bytes.unshift(191);\n      bytes.unshift(187);\n      bytes.unshift(239);\n    }\n  }\n\n  public get mode(): number {\n    return QRMode.MODE_8BIT_BYTE;\n  }\n\n  public get length(): number {\n    return this.bytes.length;\n  }\n\n  public write(buff: BitBuffer): void {\n    const { bytes } = this;\n\n    for (let i = 0; i < bytes.length; i++) {\n      buff.put(bytes[i], 8);\n    }\n  }\n}\n","// ---------------------------------------------------------------------\n// QRRSBlock\n// ---------------------------------------------------------------------\n\nimport { QRErrorCorrectLevel } from \"./constants\";\n\nexport interface RSBlockCount {\n  totalCount: number;\n  dataCount: number;\n}\n\nconst RS_BLOCK_TABLE = [\n  [1, 26, 19],\n  [1, 26, 16],\n  [1, 26, 13],\n  [1, 26, 9],\n  [1, 44, 34],\n  [1, 44, 28],\n  [1, 44, 22],\n  [1, 44, 16],\n  [1, 70, 55],\n  [1, 70, 44],\n  [2, 35, 17],\n  [2, 35, 13],\n  [1, 100, 80],\n  [2, 50, 32],\n  [2, 50, 24],\n  [4, 25, 9],\n  [1, 134, 108],\n  [2, 67, 43],\n  [2, 33, 15, 2, 34, 16],\n  [2, 33, 11, 2, 34, 12],\n  [2, 86, 68],\n  [4, 43, 27],\n  [4, 43, 19],\n  [4, 43, 15],\n  [2, 98, 78],\n  [4, 49, 31],\n  [2, 32, 14, 4, 33, 15],\n  [4, 39, 13, 1, 40, 14],\n  [2, 121, 97],\n  [2, 60, 38, 2, 61, 39],\n  [4, 40, 18, 2, 41, 19],\n  [4, 40, 14, 2, 41, 15],\n  [2, 146, 116],\n  [3, 58, 36, 2, 59, 37],\n  [4, 36, 16, 4, 37, 17],\n  [4, 36, 12, 4, 37, 13],\n  [2, 86, 68, 2, 87, 69],\n  [4, 69, 43, 1, 70, 44],\n  [6, 43, 19, 2, 44, 20],\n  [6, 43, 15, 2, 44, 16],\n  [4, 101, 81],\n  [1, 80, 50, 4, 81, 51],\n  [4, 50, 22, 4, 51, 23],\n  [3, 36, 12, 8, 37, 13],\n  [2, 116, 92, 2, 117, 93],\n  [6, 58, 36, 2, 59, 37],\n  [4, 46, 20, 6, 47, 21],\n  [7, 42, 14, 4, 43, 15],\n  [4, 133, 107],\n  [8, 59, 37, 1, 60, 38],\n  [8, 44, 20, 4, 45, 21],\n  [12, 33, 11, 4, 34, 12],\n  [3, 145, 115, 1, 146, 116],\n  [4, 64, 40, 5, 65, 41],\n  [11, 36, 16, 5, 37, 17],\n  [11, 36, 12, 5, 37, 13],\n  [5, 109, 87, 1, 110, 88],\n  [5, 65, 41, 5, 66, 42],\n  [5, 54, 24, 7, 55, 25],\n  [11, 36, 12],\n  [5, 122, 98, 1, 123, 99],\n  [7, 73, 45, 3, 74, 46],\n  [15, 43, 19, 2, 44, 20],\n  [3, 45, 15, 13, 46, 16],\n  [1, 135, 107, 5, 136, 108],\n  [10, 74, 46, 1, 75, 47],\n  [1, 50, 22, 15, 51, 23],\n  [2, 42, 14, 17, 43, 15],\n  [5, 150, 120, 1, 151, 121],\n  [9, 69, 43, 4, 70, 44],\n  [17, 50, 22, 1, 51, 23],\n  [2, 42, 14, 19, 43, 15],\n  [3, 141, 113, 4, 142, 114],\n  [3, 70, 44, 11, 71, 45],\n  [17, 47, 21, 4, 48, 22],\n  [9, 39, 13, 16, 40, 14],\n  [3, 135, 107, 5, 136, 108],\n  [3, 67, 41, 13, 68, 42],\n  [15, 54, 24, 5, 55, 25],\n  [15, 43, 15, 10, 44, 16],\n  [4, 144, 116, 4, 145, 117],\n  [17, 68, 42],\n  [17, 50, 22, 6, 51, 23],\n  [19, 46, 16, 6, 47, 17],\n  [2, 139, 111, 7, 140, 112],\n  [17, 74, 46],\n  [7, 54, 24, 16, 55, 25],\n  [34, 37, 13],\n  [4, 151, 121, 5, 152, 122],\n  [4, 75, 47, 14, 76, 48],\n  [11, 54, 24, 14, 55, 25],\n  [16, 45, 15, 14, 46, 16],\n  [6, 147, 117, 4, 148, 118],\n  [6, 73, 45, 14, 74, 46],\n  [11, 54, 24, 16, 55, 25],\n  [30, 46, 16, 2, 47, 17],\n  [8, 132, 106, 4, 133, 107],\n  [8, 75, 47, 13, 76, 48],\n  [7, 54, 24, 22, 55, 25],\n  [22, 45, 15, 13, 46, 16],\n  [10, 142, 114, 2, 143, 115],\n  [19, 74, 46, 4, 75, 47],\n  [28, 50, 22, 6, 51, 23],\n  [33, 46, 16, 4, 47, 17],\n  [8, 152, 122, 4, 153, 123],\n  [22, 73, 45, 3, 74, 46],\n  [8, 53, 23, 26, 54, 24],\n  [12, 45, 15, 28, 46, 16],\n  [3, 147, 117, 10, 148, 118],\n  [3, 73, 45, 23, 74, 46],\n  [4, 54, 24, 31, 55, 25],\n  [11, 45, 15, 31, 46, 16],\n  [7, 146, 116, 7, 147, 117],\n  [21, 73, 45, 7, 74, 46],\n  [1, 53, 23, 37, 54, 24],\n  [19, 45, 15, 26, 46, 16],\n  [5, 145, 115, 10, 146, 116],\n  [19, 75, 47, 10, 76, 48],\n  [15, 54, 24, 25, 55, 25],\n  [23, 45, 15, 25, 46, 16],\n  [13, 145, 115, 3, 146, 116],\n  [2, 74, 46, 29, 75, 47],\n  [42, 54, 24, 1, 55, 25],\n  [23, 45, 15, 28, 46, 16],\n  [17, 145, 115],\n  [10, 74, 46, 23, 75, 47],\n  [10, 54, 24, 35, 55, 25],\n  [19, 45, 15, 35, 46, 16],\n  [17, 145, 115, 1, 146, 116],\n  [14, 74, 46, 21, 75, 47],\n  [29, 54, 24, 19, 55, 25],\n  [11, 45, 15, 46, 46, 16],\n  [13, 145, 115, 6, 146, 116],\n  [14, 74, 46, 23, 75, 47],\n  [44, 54, 24, 7, 55, 25],\n  [59, 46, 16, 1, 47, 17],\n  [12, 151, 121, 7, 152, 122],\n  [12, 75, 47, 26, 76, 48],\n  [39, 54, 24, 14, 55, 25],\n  [22, 45, 15, 41, 46, 16],\n  [6, 151, 121, 14, 152, 122],\n  [6, 75, 47, 34, 76, 48],\n  [46, 54, 24, 10, 55, 25],\n  [2, 45, 15, 64, 46, 16],\n  [17, 152, 122, 4, 153, 123],\n  [29, 74, 46, 14, 75, 47],\n  [49, 54, 24, 10, 55, 25],\n  [24, 45, 15, 46, 46, 16],\n  [4, 152, 122, 18, 153, 123],\n  [13, 74, 46, 32, 75, 47],\n  [48, 54, 24, 14, 55, 25],\n  [42, 45, 15, 32, 46, 16],\n  [20, 147, 117, 4, 148, 118],\n  [40, 75, 47, 7, 76, 48],\n  [43, 54, 24, 22, 55, 25],\n  [10, 45, 15, 67, 46, 16],\n  [19, 148, 118, 6, 149, 119],\n  [18, 75, 47, 31, 76, 48],\n  [34, 54, 24, 34, 55, 25],\n  [20, 45, 15, 61, 46, 16],\n];\n\nexport class RSBlock {\n  private getRSBlockTable(typeNumber: number, errorCorrectLevel: number): number[] {\n    const { L, M, Q, H } = QRErrorCorrectLevel;\n    const pos = (typeNumber - 1) * 4;\n\n    switch (errorCorrectLevel) {\n      case L:\n        return RS_BLOCK_TABLE[pos + 0];\n      case M:\n        return RS_BLOCK_TABLE[pos + 1];\n      case Q:\n        return RS_BLOCK_TABLE[pos + 2];\n      case H:\n        return RS_BLOCK_TABLE[pos + 3];\n      default:\n        throw new Error(`bad rs block @ typeNumber:${typeNumber}/errorCorrectLevel: ${errorCorrectLevel}`);\n    }\n  }\n\n  public getRSBlocks(typeNumber: number, errorCorrectLevel: number): RSBlockCount[] {\n    const rsBlock = this.getRSBlockTable(typeNumber, errorCorrectLevel);\n    const length = rsBlock.length / 3;\n    const list: RSBlockCount[] = [];\n\n    for (let i = 0; i < length; i++) {\n      const count = rsBlock[i * 3];\n      const totalCount = rsBlock[i * 3 + 1];\n      const dataCount = rsBlock[i * 3 + 2];\n\n      for (let j = 0; j < count; j++) {\n        list.push({ totalCount, dataCount });\n      }\n    }\n\n    return list;\n  }\n}\n","// ---------------------------------------------------------------------\n// Polynomial\n// ---------------------------------------------------------------------\n\nimport { QRMath } from \"./math\";\n\nexport class Polynomial {\n  private readonly num: number[];\n\n  constructor(num: number[], shift: number) {\n    const { length } = num;\n\n    if (length === undefined) {\n      throw new Error(`${length}/${shift}`);\n    }\n\n    let offset = 0;\n    while (offset < length && num[offset] === 0) {\n      offset++;\n    }\n    \n    const len = length - offset;\n    this.num = new Array(len + shift);\n    for (let i = 0; i < len; i++) {\n      this.num[i] = num[i + offset];\n    }\n  }\n\n  public get length(): number {\n    return this.num.length;\n  }\n\n  public getAt(i: number): number {\n    return this.num[i];\n  }\n\n  public multiply(e: Polynomial): Polynomial {\n    const { glog, gexp } = QRMath;\n    const num: number[] = [];\n\n    for (let i = 0; i < this.length; i++) {\n      for (let j = 0; j < e.length; j++) {\n        num[i + j] ^= gexp(glog(this.getAt(i)) + glog(e.getAt(j)));\n      }\n    }\n\n    return new Polynomial(num, 0);\n  }\n\n  public mod(e: Polynomial): Polynomial {\n    if (this.length - e.length < 0) {\n      return this;\n    }\n\n    const { glog, gexp } = QRMath;\n    const ratio = glog(this.getAt(0)) - glog(e.getAt(0));\n    const num: number[] = [];\n\n    for (var i = 0; i < this.length; i++) {\n      const n = this.getAt(i);\n\n      num[i] = i < e.length ? n ^ gexp(glog(e.getAt(i)) + ratio) : n;\n    }\n\n    // recursive call\n    return new Polynomial(num, 0).mod(e);\n  }\n}\n","import { QRCode } from \".\";\nimport { Polynomial } from \"./polynomial\";\nimport { QRMaskPattern, QRMode } from \"./constants\";\nimport { QRMath } from \"./math\";\n\nconst PATTERN_POSITION_TABLE = [\n  [],\n  [6, 18],\n  [6, 22],\n  [6, 26],\n  [6, 30],\n  [6, 34],\n  [6, 22, 38],\n  [6, 24, 42],\n  [6, 26, 46],\n  [6, 28, 50],\n  [6, 30, 54],\n  [6, 32, 58],\n  [6, 34, 62],\n  [6, 26, 46, 66],\n  [6, 26, 48, 70],\n  [6, 26, 50, 74],\n  [6, 30, 54, 78],\n  [6, 30, 56, 82],\n  [6, 30, 58, 86],\n  [6, 34, 62, 90],\n  [6, 28, 50, 72, 94],\n  [6, 26, 50, 74, 98],\n  [6, 30, 54, 78, 102],\n  [6, 28, 54, 80, 106],\n  [6, 32, 58, 84, 110],\n  [6, 30, 58, 86, 114],\n  [6, 34, 62, 90, 118],\n  [6, 26, 50, 74, 98, 122],\n  [6, 30, 54, 78, 102, 126],\n  [6, 26, 52, 78, 104, 130],\n  [6, 30, 56, 82, 108, 134],\n  [6, 34, 60, 86, 112, 138],\n  [6, 30, 58, 86, 114, 142],\n  [6, 34, 62, 90, 118, 146],\n  [6, 30, 54, 78, 102, 126, 150],\n  [6, 24, 50, 76, 102, 128, 154],\n  [6, 28, 54, 80, 106, 132, 158],\n  [6, 32, 58, 84, 110, 136, 162],\n  [6, 26, 54, 82, 110, 138, 166],\n  [6, 30, 58, 86, 114, 142, 170],\n];\nconst G15 =\n  (1 << 10) | (1 << 8) | (1 << 5) | (1 << 4) | (1 << 2) | (1 << 1) | (1 << 0);\nconst G18 =\n  (1 << 12) |\n  (1 << 11) |\n  (1 << 10) |\n  (1 << 9) |\n  (1 << 8) |\n  (1 << 5) |\n  (1 << 2) |\n  (1 << 0);\nconst G15_MASK = (1 << 14) | (1 << 12) | (1 << 10) | (1 << 4) | (1 << 1);\nconst genBCHDigit = (data: number) => data === 0 ? 0 : Math.log2(data);\nconst BCH_G15 = genBCHDigit(G15);\nconst BCH_G18 = genBCHDigit(G18);\n\n// ---------------------------------------------------------------------\n// QRUtil\n// ---------------------------------------------------------------------\n\nexport const Util = {\n  getBCHTypeInfo(data: number): number {\n    let d = data << 10;\n\n    while (genBCHDigit(d) - BCH_G15 >= 0) {\n      d ^= G15 << (genBCHDigit(d) - BCH_G15);\n    }\n\n    return ((data << 10) | d) ^ G15_MASK;\n  },\n\n  getBCHTypeNumber(data: number): number {\n    let d = data << 12;\n\n    while (genBCHDigit(d) - BCH_G18 >= 0) {\n      d ^= G18 << (genBCHDigit(d) - BCH_G18);\n    }\n\n    return (data << 12) | d;\n  },\n\n  getPatternPosition(typeNumber: number): number[] {\n    return PATTERN_POSITION_TABLE[typeNumber - 1];\n  },\n\n  getMaskFunction(maskPattern: number): (i: number, j: number) => boolean {\n    const {\n      PATTERN000,\n      PATTERN001,\n      PATTERN010,\n      PATTERN011,\n      PATTERN100,\n      PATTERN101,\n      PATTERN110,\n      PATTERN111,\n    } = QRMaskPattern;\n\n    switch (maskPattern) {\n      case PATTERN000:\n        return (i: number, j: number) => (i + j) % 2 === 0;\n      case PATTERN001:\n        return (i: number) => i % 2 === 0;\n      case PATTERN010:\n        return (_i: number, j: number) => j % 3 === 0;\n      case PATTERN011:\n        return (i: number, j: number) => (i + j) % 3 === 0;\n      case PATTERN100:\n        return (i: number, j: number) => (~~(i / 2) + ~~(j / 3)) % 2 === 0;\n      case PATTERN101:\n        return (i: number, j: number) => ((i * j) % 2) + ((i * j) % 3) === 0;\n      case PATTERN110:\n        return (i: number, j: number) =>\n          (((i * j) % 2) + ((i * j) % 3)) % 2 === 0;\n      case PATTERN111:\n        return (i: number, j: number) =>\n          (((i * j) % 3) + ((i + j) % 2)) % 2 === 0;\n      default:\n        throw new Error(`bad maskPattern: ${maskPattern}`);\n    }\n  },\n\n  getErrorCorrectPolynomial(errorCorrectLength: number): Polynomial {\n    let a = new Polynomial([1], 0);\n\n    for (let i = 0; i < errorCorrectLength; i++) {\n      a = a.multiply(new Polynomial([1, QRMath.gexp(i)], 0));\n    }\n\n    return a;\n  },\n\n  getLengthInBits(mode: number, type: number): number {\n    const { MODE_NUMBER, MODE_ALPHA_NUM, MODE_8BIT_BYTE, MODE_KANJI } = QRMode;\n\n    if (type < 1 || type > 40) {\n      throw new Error(`type: ${type}`);\n    }\n\n    if (type >= 1 && type < 10) {\n      // 1 - 9\n\n      switch (mode) {\n        case MODE_NUMBER:\n          return 10;\n        case MODE_ALPHA_NUM:\n          return 9;\n        case MODE_8BIT_BYTE:\n          return 8;\n        case MODE_KANJI:\n          return 8;\n        default:\n      }\n    }\n\n    if (type < 27) {\n      // 10 - 26\n\n      switch (mode) {\n        case MODE_NUMBER:\n          return 12;\n        case MODE_ALPHA_NUM:\n          return 11;\n        case MODE_8BIT_BYTE:\n          return 16;\n        case MODE_KANJI:\n          return 10;\n        default:\n      }\n    }\n\n    if (type <= 40) {\n      // 27 - 40\n\n      switch (mode) {\n        case MODE_NUMBER:\n          return 14;\n        case MODE_ALPHA_NUM:\n          return 13;\n        case MODE_8BIT_BYTE:\n          return 16;\n        case MODE_KANJI:\n          return 12;\n        default:\n      }\n    }\n\n    throw new Error(`mode: ${mode}`);\n  },\n\n  getLostPoint(qr: QRCode): number {\n    const moduleCount = qr.getModuleCount();\n    let lostPoint = 0;\n\n    // LEVEL1\n\n    for (let row = 0; row < moduleCount; row++) {\n      for (let col = 0; col < moduleCount; col++) {\n        const dark = qr.isDark(row, col);\n        let sameCount = 0;\n\n        for (let r = -1; r <= 1; r++) {\n          const nRow = row + r;\n          if (nRow < 0 || moduleCount <= nRow) continue;\n\n          for (let c = -1; c <= 1; c++) {\n            const nCol = col + c;\n            if (nCol < 0 || moduleCount <= nCol) continue;\n            if (r === 0 && c === 0) continue;\n            if (dark === qr.isDark(nRow, nCol)) {\n              sameCount++;\n            }\n          }\n        }\n\n        if (sameCount > 5) {\n          lostPoint += sameCount + 3 - 5;\n        }\n      }\n    }\n\n    // LEVEL2\n\n    for (let row = 0; row < moduleCount - 1; row++) {\n      for (let col = 0; col < moduleCount - 1; col++) {\n        let count = 0;\n\n        if (qr.isDark(row, col)) count++;\n        if (qr.isDark(row + 1, col)) count++;\n        if (qr.isDark(row, col + 1)) count++;\n        if (qr.isDark(row + 1, col + 1)) count++;\n        if (count === 0 || count === 4) {\n          lostPoint += 3;\n        }\n      }\n    }\n\n    // LEVEL3\n\n    for (let row = 0; row < moduleCount; row++) {\n      for (let col = 0; col < moduleCount - 6; col++) {\n        if (\n          qr.isDark(row, col) &&\n          !qr.isDark(row, col + 1) &&\n          qr.isDark(row, col + 2) &&\n          qr.isDark(row, col + 3) &&\n          qr.isDark(row, col + 4) &&\n          !qr.isDark(row, col + 5) &&\n          qr.isDark(row, col + 6)\n        ) {\n          lostPoint += 40;\n        }\n      }\n    }\n\n    for (let col = 0; col < moduleCount; col++) {\n      for (let row = 0; row < moduleCount - 6; row++) {\n        if (\n          qr.isDark(row, col) &&\n          !qr.isDark(row + 1, col) &&\n          qr.isDark(row + 2, col) &&\n          qr.isDark(row + 3, col) &&\n          qr.isDark(row + 4, col) &&\n          !qr.isDark(row + 5, col) &&\n          qr.isDark(row + 6, col)\n        ) {\n          lostPoint += 40;\n        }\n      }\n    }\n\n    // LEVEL4\n\n    let darkCount = 0;\n    for (let col = 0; col < moduleCount; col++) {\n      for (let row = 0; row < moduleCount; row++) {\n        if (qr.isDark(row, col)) {\n          darkCount++;\n        }\n      }\n    }\n\n    const ratio =\n      Math.abs((100 * darkCount) / Math.pow(moduleCount, 2) - 50) / 5;\n\n    return lostPoint + ratio * 10;\n  },\n};\n","// ---------------------------------------------------------------------\n//\n// QR Code Generator for JavaScript\n//\n// Copyright (c) 2025 LiHZSky\n//\n// URL: http://www.d-project.com/\n//\n// Licensed under the MIT license:\n// http://www.opensource.org/licenses/mit-license.php\n//\n// The word 'QR Code' is registered trademark of\n// DENSO WAVE INCORPORATED\n//\n// ---------------------------------------------------------------------\n\nimport { BitBuffer } from \"./bit-buffer\";\nimport { BitByte } from \"./bit-byte\";\nimport { RSBlock, RSBlockCount } from \"./block\";\nimport { QRErrorCorrectLevel } from \"./constants\";\nimport { Polynomial } from \"./polynomial\";\nimport { Util } from \"./util\";\n\nconst PAD0 = 0xec;\nconst PAD1 = 0x11;\n\n/**\n * QRCode实现\n * https://www.cnblogs.com/leestar54/p/15782929.html\n * @param typeNumber 1 to 40\n * @param errorCorrectLevel 'L','M','Q','H'\n */\nexport class QRCode {\n  private readonly errorCorrectLevel: number;\n\n  private modules: boolean[][] = [];\n\n  private moduleCount = 0;\n\n  private dataCache: number[] | null = null;\n\n  private dataList: BitByte[] = [];\n\n  constructor(\n    private readonly typeNumber: number,\n    errorCorrectLevel: \"L\" | \"M\" | \"Q\" | \"H\"\n  ) {\n    this.errorCorrectLevel = QRErrorCorrectLevel[errorCorrectLevel];\n  }\n\n  private makeImpl(test: boolean, maskPattern: number): void {\n    this.moduleCount = this.typeNumber * 4 + 17;\n    this.modules = ((moduleCount: number) => {\n      const modules: boolean[][] = [];\n\n      // 预设一个 moduleCount * moduleCount 的空白矩阵\n      for (let row = 0; row < moduleCount; row++) {\n        modules[row] = [];\n\n        for (let col = 0; col < moduleCount; col++) {\n          modules[row][col] = null as unknown as boolean;\n        }\n      }\n\n      return modules;\n    })(this.moduleCount);;\n\n    const count = this.moduleCount - 7;\n\n    this.setupPositionProbePattern(0, 0);\n    this.setupPositionProbePattern(count, 0);\n    this.setupPositionProbePattern(0, count);\n    this.setupPositionAdjustPattern();\n    this.setupTimingPattern();\n    this.setupTypeInfo(test, maskPattern);\n\n    if (this.typeNumber >= 7) {\n      this.setupTypeNumber(test);\n    }\n\n    if (this.dataCache === null) {\n      this.dataCache = this.createData(\n        this.typeNumber,\n        this.errorCorrectLevel,\n        this.dataList\n      );\n    }\n\n    this.mapData(this.dataCache, maskPattern);\n  }\n\n  private setupPositionProbePattern(row: number, col: number): void {\n    const { modules, moduleCount } = this;\n\n    for (let r = -1; r <= 7; r++) {\n      const nr = row + r;\n      if (nr <= -1 || moduleCount <= nr) continue;\n\n      for (let c = -1; c <= 7; c++) {\n        const nc = col + c;\n        if (nc <= -1 || moduleCount <= nc) continue;\n\n        modules[nr][nc] =\n          (r >= 0 && r <= 6 && (c === 0 || c === 6)) ||\n          (c >= 0 && c <= 6 && (r === 0 || r === 6)) ||\n          (r >= 2 && r <= 4 && c >= 2 && c <= 4);\n      }\n    }\n  }\n\n  private setupPositionAdjustPattern(): void {\n    const { typeNumber, modules } = this;\n    const pos = Util.getPatternPosition(typeNumber);\n    const { length } = pos;\n\n    for (let i = 0; i < length; i++) {\n      for (let j = 0; j < length; j++) {\n        const row = pos[i];\n        const col = pos[j];\n\n        if (modules[row][col] != null) continue;\n\n        for (let r = -2; r <= 2; r++) {\n          for (let c = -2; c <= 2; c++) {\n            modules[row + r][col + c] =\n              r === -2 || r === 2 || c === -2 || c === 2 || (r === 0 && c === 0);\n          }\n        }\n      }\n    }\n  }\n\n  private setupTimingPattern(): void {\n    const { moduleCount, modules } = this;\n    const count = moduleCount - 8;\n\n    for (let r = 8; r < count; r++) {\n      if (modules[r][6] != null) continue;\n\n      modules[r][6] = r % 2 === 0;\n    }\n\n    for (let c = 8; c < count; c++) {\n      if (modules[6][c] != null) continue;\n\n      modules[6][c] = c % 2 === 0;\n    }\n  }\n\n  private setupTypeInfo(test: boolean, maskPattern: number): void {\n    const { errorCorrectLevel, modules, moduleCount } = this;\n    const data = (errorCorrectLevel << 3) | maskPattern;\n    const bits = Util.getBCHTypeInfo(data);\n\n    // vertical\n    for (let i = 0; i < 15; i++) {\n      const mod = !test && ((bits >> i) & 1) === 1;\n\n      if (i < 6) {\n        modules[i][8] = mod;\n      } else if (i < 8) {\n        modules[i + 1][8] = mod;\n      } else {\n        modules[moduleCount - 15 + i][8] = mod;\n      }\n    }\n\n    // horizontal\n    for (let i = 0; i < 15; i++) {\n      const mod = !test && ((bits >> i) & 1) === 1;\n\n      if (i < 8) {\n        modules[8][moduleCount - i - 1] = mod;\n      } else if (i < 9) {\n        modules[8][15 - i] = mod;\n      } else {\n        modules[8][15 - i - 1] = mod;\n      }\n    }\n\n    // fixed module\n    modules[moduleCount - 8][8] = !test;\n  }\n\n  private getBestMaskPattern(): number {\n    let minLostPoint = 0;\n    let pattern = 0;\n\n    for (let i = 0; i < 8; i++) {\n      this.makeImpl(true, i);\n\n      const lostPoint = Util.getLostPoint(this);\n      if (i === 0 || minLostPoint > lostPoint) {\n        minLostPoint = lostPoint;\n        pattern = i;\n      }\n    }\n\n    return pattern;\n  }\n\n  private setupTypeNumber(test: boolean): void {\n    const { typeNumber, modules, moduleCount } = this;\n    const bits = Util.getBCHTypeNumber(typeNumber);\n\n    for (let i = 0; i < 18; i++) {\n      const mod = !test && ((bits >> i) & 1) === 1;\n\n      modules[~~(i / 3)][(i % 3) + moduleCount - 8 - 3] = mod;\n      modules[(i % 3) + moduleCount - 8 - 3][~~(i / 3)] = mod;\n    }\n  }\n\n  private createData(\n    typeNumber: number,\n    errorCorrectLevel: number,\n    dataList: BitByte[]\n  ): number[] {\n    const rsBlocks = new RSBlock().getRSBlocks(typeNumber, errorCorrectLevel);\n    const buffer = new BitBuffer();\n\n    for (let i = 0; i < dataList.length; i++) {\n      const data = dataList[i];\n\n      buffer.put(data.mode, 4);\n      buffer.put(data.length, Util.getLengthInBits(data.mode, typeNumber));\n      data.write(buffer);\n    }\n\n    // calc num max data.\n    let totalDataCount = 0;\n    for (let i = 0; i < rsBlocks.length; i++) {\n      totalDataCount += rsBlocks[i].dataCount;\n    }\n\n    const totalCount = totalDataCount * 8;\n    if (buffer.lengthInBits > totalCount) {\n      throw new Error(\n        `code length overflow. (${buffer.lengthInBits} > ${totalCount})`\n      );\n    }\n\n    // end code\n    if (buffer.lengthInBits + 4 <= totalCount) {\n      buffer.put(0, 4);\n    }\n\n    // padding\n    while (buffer.lengthInBits % 8 !== 0) {\n      buffer.putBit(false);\n    }\n\n    // padding\n    while (true) {\n      if (buffer.lengthInBits >= totalCount) {\n        break;\n      }\n      buffer.put(PAD0, 8);\n\n      if (buffer.lengthInBits >= totalCount) {\n        break;\n      }\n      buffer.put(PAD1, 8);\n    }\n\n    return this.createBytes(buffer, rsBlocks);\n  }\n\n  private mapData(data: number[], maskPattern: number): void {\n    const { modules, moduleCount } = this;\n    const maskFunc = Util.getMaskFunction(maskPattern);\n    let inc = -1;\n    let row = moduleCount - 1;\n    let bitIndex = 7;\n    let byteIndex = 0;\n\n    for (let col = row; col > 0; col -= 2) {\n      if (col === 6) col -= 1;\n\n      while (true) {\n        for (let c = 0; c < 2; c++) {\n          if (modules[row][col - c] == null) {\n            let dark = false;\n\n            if (byteIndex < data.length) {\n              dark = ((data[byteIndex] >>> bitIndex) & 1) === 1;\n            }\n\n            if (maskFunc(row, col - c)) {\n              dark = !dark;\n            }\n\n            modules[row][col - c] = dark;\n            bitIndex--;\n\n            if (bitIndex === -1) {\n              byteIndex++;\n              bitIndex = 7;\n            }\n          }\n        }\n\n        row += inc;\n\n        if (row < 0 || moduleCount <= row) {\n          row -= inc;\n          inc = -inc;\n          break;\n        }\n      }\n    }\n  }\n\n  private createBytes(\n    bitBuffer: BitBuffer,\n    rsBlocks: RSBlockCount[]\n  ): number[] {\n    const dcdata: number[][] = [];\n    const ecdata: number[][] = [];\n    let offset = 0;\n    let maxDcCount = 0;\n    let maxEcCount = 0;\n\n    for (let r = 0; r < rsBlocks.length; r++) {\n      const dcCount = rsBlocks[r].dataCount;\n      const ecCount = rsBlocks[r].totalCount - dcCount;\n\n      maxDcCount = Math.max(maxDcCount, dcCount);\n      maxEcCount = Math.max(maxEcCount, ecCount);\n\n      dcdata[r] = [];\n\n      for (let i = 0; i < dcCount; i++) {\n        dcdata[r][i] = 0xff & bitBuffer.buffer[i + offset];\n      }\n\n      offset += dcCount;\n\n      const rsPoly = Util.getErrorCorrectPolynomial(ecCount);\n      const rawPoly = new Polynomial(dcdata[r], rsPoly.length - 1);\n      const modPoly = rawPoly.mod(rsPoly);\n\n      ecdata[r] = new Array(rsPoly.length - 1);\n      for (let i = 0; i < ecdata[r].length; i++) {\n        const modIndex = i + modPoly.length - ecdata[r].length;\n\n        ecdata[r][i] = modIndex >= 0 ? modPoly.getAt(modIndex) : 0;\n      }\n    }\n\n    let totalCodeCount = 0;\n    for (let i = 0; i < rsBlocks.length; i++) {\n      totalCodeCount += rsBlocks[i].totalCount;\n    }\n\n    const data = new Array(totalCodeCount);\n    let index = 0;\n\n    for (let i = 0; i < maxDcCount; i++) {\n      for (let r = 0; r < rsBlocks.length; r++) {\n        if (i < dcdata[r].length) {\n          data[index++] = dcdata[r][i];\n        }\n      }\n    }\n\n    for (let i = 0; i < maxEcCount; i++) {\n      for (let r = 0; r < rsBlocks.length; r++) {\n        if (i < ecdata[r].length) {\n          data[index++] = ecdata[r][i];\n        }\n      }\n    }\n\n    return data;\n  }\n\n  public isDark(row: number, col: number): boolean {\n    const { moduleCount } = this;\n\n    if (row < 0 || moduleCount <= row || col < 0 || moduleCount <= col) {\n      throw new Error(`${row}, ${col}`);\n    }\n\n    return this.modules[row][col];\n  }\n\n  public addData(data: string): void {\n    this.dataList.push(new BitByte(data));\n    this.dataCache = null;\n  }\n\n  public getModuleCount(): number {\n    return this.moduleCount;\n  }\n\n  public make(): void {\n    this.makeImpl(false, this.getBestMaskPattern());\n  }\n}\n","// import { unzlibSync } from \"fflate\";\nimport { unzlibSync, createVideoEntity } from \"../../extensions\";\nimport { platform } from \"../../platform\";\nimport type { PlatformVideo } from \"../../types\";\n\n/**\n * SVGA 下载解析器\n */\nexport class Parser {\n  /**\n   * 解压视频源文件\n   * @param data\n   * @returns\n   */\n  static decompress(data: ArrayBufferLike): ArrayBufferLike {\n    return unzlibSync(new Uint8Array(data)).buffer;\n  }\n\n  /**\n   * 解析视频实体\n   * @param data 视频二进制数据\n   * @param url 视频地址\n   * @param needDecompress 是否解压\n   * @returns\n   */\n  static parseVideo(\n    data: ArrayBufferLike,\n    url: string,\n    needDecompress: boolean = true\n  ): PlatformVideo.Video {\n    return createVideoEntity(\n      new Uint8Array(needDecompress ? this.decompress(data) : data),\n      platform.path.filename(url)\n    );\n  }\n\n  /**\n   * 读取文件资源\n   * @param url 文件资源地址\n   * @returns\n   */\n  static async download(url: string): Promise<ArrayBuffer> {\n    const { globals, remote, path, local } = platform;\n    const { env } = globals;\n    const supportLocal = env !== \"h5\" && env !== \"tt\";\n    const filepath = path.is(url)\n        ? url\n        : path.resolve(path.filename(url));\n\n    // 本地读取\n    if (supportLocal) {\n      if (await local!.exists(filepath)) {\n        return local!.read(filepath);\n      }\n    }\n\n    // 远程读取\n    const buff = await remote.fetch(url);\n\n    // 本地缓存\n    if (supportLocal) {\n      try {\n        await local!.write(buff, filepath);\n      } catch (ex) {\n        // eslint-disable-next-line no-console\n        console.error(ex);\n      }\n    }\n\n    return buff;\n  }\n\n  /**\n   * 通过 url 下载并解析 SVGA 文件\n   * @param url SVGA 文件的下载链接\n   * @returns Promise<SVGA 数据源\n   */\n  static async load(url: string): Promise<PlatformVideo.Video> {\n    return Parser.parseVideo((await Parser.download(url))!, url);\n  }\n}\n","// import benchmark from \"octopus-benchmark\";\nimport Reader from \"./io/Reader\";\nimport { MovieEntity } from \"./serialization\";\n\nexport type * from \"./serialization\";\n\nexport function createVideoEntity(data: Uint8Array, filename: string) {\n  if (data instanceof Uint8Array) {\n    const reader = new Reader(data);\n    const video = MovieEntity.decode(reader);\n\n    // benchmark.log('preflight cache size', reader.preflight.size);\n    // benchmark.log('preflight hit count', reader.preflight.hitCount);\n    video.filename = filename;\n    reader.preflight.clear();\n\n    return video;\n  }\n\n  throw new Error(\"Invalid data type\");\n}\n","import type { PlatformCanvas, PlatformOffscreenCanvas } from \"octopus-platform\";\nimport { platform } from \"../../platform\";\nimport type { PainterActionModel, PainterMode } from \"../../types\";\n\nconst { noop } = platform;\n\nexport class Painter {\n  /**\n   * 主屏的 Canvas 元素\n   * Front Screen\n   */\n  public F: PlatformCanvas | PlatformOffscreenCanvas | null = null;\n  /**\n   * 主屏的 Context 对象\n   * Front Context\n   */\n  public FC:\n    | CanvasRenderingContext2D\n    | OffscreenCanvasRenderingContext2D\n    | null = null;\n  /**\n   * 副屏的 Canvas 元素\n   * Background Screen\n   */\n  public B: PlatformCanvas | PlatformOffscreenCanvas | null = null;\n  /**\n   * 副屏的 Context 对象\n   * Background Context\n   */\n  public BC:\n    | CanvasRenderingContext2D\n    | OffscreenCanvasRenderingContext2D\n    | null = null;\n  /**\n   * 画布的宽度\n   */\n  public W: number;\n  /**\n   * 画布的高度\n   */\n  public H: number;\n  /**\n   * 粉刷模式\n   */\n  private model: PainterActionModel = {} as PainterActionModel;\n\n  /**\n   *\n   * @param mode\n   *  - poster: 海报模式\n   *  - animation: 动画模式\n   *  - 默认为 animation\n   * @param W 海报模式必须传入\n   * @param H 海报模式必须传入\n   */\n  constructor(\n    private readonly mode: PainterMode = \"animation\",\n    width = 0,\n    height = 0\n  ) {\n    const { dpr } = platform.globals;\n\n    this.W = width * dpr;\n    this.H = height * dpr;\n  }\n\n  /**\n   * 设置 Canvas 的处理模式\n   * - C：代表 Canvas\n   * - O：代表 OffscreenCanvas\n   */\n  private setActionModel(type: \"C\" | \"O\"): void {\n    const { model } = this;\n    const { env } = platform.globals;\n\n    // set type\n    model.type = type;\n\n    // set clear\n    if (\n      type === \"O\" &&\n      // OffscreenCanvas 在 Firefox 浏览器无法被清理历史内容\n      env === \"h5\" &&\n      navigator.userAgent.includes(\"Firefox\")\n    ) {\n      model.clear = \"CR\";\n    } else if ((type === \"O\" && env === \"tt\") || env === \"alipay\") {\n      model.clear = \"CL\";\n    } else {\n      model.clear = \"RE\";\n    }\n  }\n\n  /**\n   * 注册画笔，根据环境判断生成最优的绘制方式\n   * @param selector\n   * @param ofsSelector\n   * @param component\n   */\n  public async register(\n    selector: string,\n    ofsSelector?: string,\n    component?: any\n  ) {\n    const { model, mode } = this;\n    const { getCanvas, getOfsCanvas } = platform;\n    const { env } = platform.globals;\n    // #region set main screen implement\n    // -------- 创建主屏 ---------\n    if (\n      mode === \"poster\" &&\n      (env !== \"h5\" || \"OffscreenCanvas\" in globalThis)\n    ) {\n      const { W, H } = this;\n      const { canvas, context } = getOfsCanvas({ width: W, height: H });\n\n      this.F = canvas;\n      this.FC = context;\n      this.setActionModel(\"O\");\n    } else {\n      const { canvas, context } = await getCanvas(selector, component);\n      const { width, height } = canvas;\n      // 添加主屏\n      this.F = canvas;\n      this.FC = context;\n      this.setActionModel(\"C\");\n\n      if (mode === \"poster\") {\n        canvas.width = this.W;\n        canvas.height = this.H;\n      } else {\n        this.W = width;\n        this.H = height;\n      }\n    }\n    // #endregion set main screen implement\n\n    // #region clear main screen implement\n    // ------- 生成主屏清理函数 -------\n    // FIXME:【支付宝小程序】无法通过改变尺寸来清理画布\n    if (model.clear === \"CL\") {\n      this.clearContainer = () => {\n        const { W, H, FC } = this;\n\n        FC!.clearRect(0, 0, W, H);\n      };\n    } else {\n      this.clearContainer = () => {\n        const { W, H, F } = this;\n\n        F!.width = W;\n        F!.height = H;\n      };\n    }\n    // #endregion clear main screen implement\n\n    if (mode === \"poster\") {\n      this.B = this.F;\n      this.BC = this.FC;\n      this.clearSecondary = this.stick = noop;\n    } else {\n      // #region set secondary screen implement\n      // ------- 创建副屏 ---------\n      const { W, H } = this;\n      let ofsResult;\n\n      if (typeof ofsSelector === \"string\" && ofsSelector !== \"\") {\n        ofsResult = await getCanvas(ofsSelector, component);\n        ofsResult.canvas.width = W;\n        ofsResult.canvas.height = H;\n        this.setActionModel(\"C\");\n      } else {\n        ofsResult = getOfsCanvas({ width: W, height: H });\n        this.setActionModel(\"O\");\n      }\n\n      this.B = ofsResult.canvas;\n      this.BC = ofsResult.context;\n      // #endregion set secondary screen implement\n\n      // #region clear secondary screen implement\n      // ------- 生成副屏清理函数 --------\n      switch (model.clear) {\n        case \"CR\":\n          this.clearSecondary = () => {\n            const { W, H } = this;\n            // FIXME:【支付宝小程序】频繁创建新的 OffscreenCanvas 会出现崩溃现象\n            const { canvas, context } = getOfsCanvas({ width: W, height: H });\n\n            this.B = canvas;\n            this.BC = context;\n          };\n          break;\n        case \"CL\":\n          this.clearSecondary = () => {\n            const { W, H, BC } = this;\n            // FIXME:【支付宝小程序】无法通过改变尺寸来清理画布，无论是Canvas还是OffscreenCanvas\n            BC!.clearRect(0, 0, W, H);\n          };\n          break;\n        default:\n          this.clearSecondary = () => {\n            const { W, H, B } = this;\n          \n            B!.width = W;\n            B!.height = H;\n          };\n      }\n      // #endregion clear secondary screen implement\n    }\n  }\n\n  public clearContainer: () => void = noop;\n\n  public clearSecondary: () => void = noop;\n\n  public stick() {\n    const { W, H,FC, BC, mode } = this;\n\n    if (mode !== \"poster\") {\n      FC!.drawImage(BC!.canvas, 0, 0, W, H);\n    }\n  }\n\n  /**\n   * 销毁画笔\n   */\n  public destroy() {\n    this.clearContainer();\n    this.clearSecondary();\n    this.F = this.FC = this.B = this.BC = null;\n    this.clearContainer = this.clearSecondary = this.stick = noop;\n  }\n}\n","import {\n  type PlatformVideo,\n  type PlayerConfig,\n  PLAYER_FILL_MODE,\n  PLAYER_PLAY_MODE,\n  PLAYER_CONTENT_MODE,\n} from \"../../types\";\n\nexport class Config {\n  /**\n   * 最后停留的目标模式，类似于 animation-fill-mode，默认值 forwards。\n   */\n  public fillMode = PLAYER_FILL_MODE.BACKWARDS;\n  /**\n   * 播放模式，默认值 forwards\n   */\n  public playMode = PLAYER_PLAY_MODE.FORWARDS;\n  /**\n   * 填充模式，类似于 content-mode。\n   */\n  public contentMode = PLAYER_CONTENT_MODE.FILL;\n  /**\n   * 开始播放的帧，默认值 0\n   */\n  public startFrame = 0;\n  /**\n   * 结束播放的帧，默认值 0\n   */\n  public endFrame = 0;\n  /**\n   * 循环播放的开始帧，默认值 0\n   */\n  public loopStartFrame = 0;\n  /**\n   * 循环次数，默认值 0（无限循环）\n   */\n  public loop = 0;\n\n  public register(config: Partial<PlayerConfig>) {\n    if (typeof config.loop === \"number\" && config.loop >= 0) {\n      this.loop = config.loop;\n    }\n\n    if (\n      config.fillMode &&\n      [\n        PLAYER_FILL_MODE.FORWARDS,\n        PLAYER_FILL_MODE.BACKWARDS,\n        PLAYER_FILL_MODE.NONE,\n      ].includes(config.fillMode)\n    ) {\n      this.fillMode = config.fillMode;\n    }\n\n    if (\n      config.playMode &&\n      [PLAYER_PLAY_MODE.FORWARDS, PLAYER_PLAY_MODE.FALLBACKS].includes(\n        config.playMode\n      )\n    ) {\n      this.playMode = config.playMode;\n    }\n\n    if (typeof config.startFrame === \"number\" && config.startFrame >= 0) {\n      this.startFrame = config.startFrame;\n    }\n\n    if (typeof config.endFrame === \"number\" && config.endFrame >= 0) {\n      this.endFrame = config.endFrame;\n    }\n\n    if (\n      typeof config.loopStartFrame === \"number\" &&\n      config.loopStartFrame >= 0\n    ) {\n      this.loopStartFrame = config.loopStartFrame;\n    }\n\n    if (typeof config.contentMode === \"string\") {\n      this.contentMode = config.contentMode;\n    }\n  }\n\n  public setItem<T extends keyof PlayerConfig>(key: T, value: PlayerConfig[T]) {\n    this.register({ [key]: value });\n  }\n\n  public getConfig(entity: PlatformVideo.Video) {\n    const { playMode, loopStartFrame, startFrame, endFrame, fillMode, loop } =\n      this;\n    const { fps, sprites } = entity;\n    let { frames } = entity;\n    const spriteCount = sprites.length;\n    const start = startFrame > 0 ? startFrame : 0;\n    const end = endFrame > 0 && endFrame < frames ? endFrame : frames;\n    // 每帧持续的时间\n    const frameDuration = 1000 / fps;\n\n    if (start > end) {\n      throw new Error(\"StartFrame should greater than EndFrame\");\n    }\n\n    // 更新活动帧总数\n    if (end < frames) {\n      frames = end - start;\n    } else if (start > 0) {\n      frames -= start;\n    }\n\n    const duration = Math.floor(frames * frameDuration * 10 ** 6) / 10 ** 6;\n    let currFrame = 0;\n    let extFrame = 0;\n    let loopStart: number;\n\n    // 顺序播放/倒叙播放\n    if (playMode === PLAYER_PLAY_MODE.FORWARDS) {\n      // 重置为开始帧\n      currFrame = Math.max(loopStartFrame, startFrame);\n      if (fillMode === PLAYER_FILL_MODE.FORWARDS) {\n        extFrame = 1;\n      }\n      loopStart =\n        loopStartFrame > start ? (loopStartFrame - start) * frameDuration : 0;\n    } else {\n      // 重置为开始帧\n      currFrame = Math.min(loopStartFrame, end - 1);\n      if (fillMode === PLAYER_FILL_MODE.BACKWARDS) {\n        extFrame = 1;\n      }\n      loopStart =\n        loopStartFrame < end ? (end - loopStartFrame) * frameDuration : 0;\n    }\n\n    return {\n      currFrame,\n      startFrame: start,\n      endFrame: end,\n      totalFrame: frames,\n      spriteCount,\n      aniConfig: {\n        // 单个周期的运行时长\n        duration,\n        // 第一个周期开始时间偏移量\n        loopStart,\n        // 循环次数\n        loop: loop === 0 ? Infinity : loop,\n        // 最后一帧不在周期内，需要单独计算\n        fillValue: extFrame * frameDuration,\n      },\n    };\n  }\n}\n","import type { PlatformCanvas } from \"octopus-platform\";\nimport { platform } from \"../../platform\";\nimport { Painter } from \"../painter\";\nimport { Config } from \"./config\";\nimport { Animator, Renderer2D, ResourceManager } from \"../../extensions\";\nimport {\n  type PlatformVideo,\n  type PlayerConfigOptions,\n  type PlayerConfig,\n  type PlayerEventCallback,\n  type PlayerProcessEventCallback,\n  PLAYER_PLAY_MODE,\n  PLAYER_FILL_MODE,\n} from \"../../types\";\n\n/**\n * SVGA 播放器\n */\nexport class Player {\n  /**\n   * SVGA 元数据\n   * Video Entity\n   */\n  private entity: PlatformVideo.Video | undefined;\n\n  /**\n   * 当前配置项\n   */\n  private readonly config = new Config();\n\n  /**\n   * 资源管理器\n   */\n  public resource: ResourceManager | null = null;\n\n  /**\n   * 刷头实例\n   */\n  public readonly painter = new Painter();\n\n  /**\n   * 动画实例\n   */\n  private readonly animator: Animator = new Animator();\n\n  /**\n   * 渲染器实例\n   */\n  private renderer: Renderer2D | null = null;\n\n  /**\n   * 设置配置项\n   * @param options 可配置项\n   * @property container 主屏，播放动画的 Canvas 元素\n   * @property secondary 副屏，播放动画的 Canvas 元素\n   * @property loop 循环次数，默认值 0（无限循环）\n   * @property fillMode 最后停留的目标模式，类似于 animation-fill-mode，接受值 forwards 和 fallbacks，默认值 forwards。\n   * @property playMode 播放模式，接受值 forwards 和 fallbacks ，默认值 forwards。\n   * @property startFrame 单个循环周期内开始播放的帧数，默认值 0\n   * @property endFrame 单个循环周期内结束播放的帧数，默认值 0\n   * @property loopStartFrame 循环播放的开始帧，仅影响第一个周期的开始帧，默认值 0\n   * @property enableInObserver 是否启用 IntersectionObserver 监听容器是否处于浏览器视窗内，默认值 false\n   */\n  public async setConfig(\n    options: string | PlayerConfigOptions,\n    component?: any\n  ): Promise<void> {\n    const config: PlayerConfigOptions =\n      typeof options === \"string\" ? { container: options } : options;\n    const { container, secondary } = config;\n\n    this.config.register(config);\n    // 监听容器是否处于浏览器视窗内\n    // this.setIntersectionObserver()\n    await this.painter.register(container, secondary, component);\n    this.renderer = new Renderer2D(this.painter.BC!);\n    this.resource = new ResourceManager(this.painter);\n    this.animator.onAnimate = platform.rAF.bind(\n      null,\n      this.painter.F as PlatformCanvas\n    );\n  }\n\n  /**\n   * 更新配置\n   * @param key\n   * @param value\n   */\n  public setItem<T extends keyof PlayerConfig>(\n    key: T,\n    value: PlayerConfig[T]\n  ): void {\n    this.config.setItem<T>(key, value);\n  }\n\n  /**\n   * 装载 SVGA 数据元\n   * @param videoEntity SVGA 数据源\n   * @returns Promise<void>\n   */\n  public async mount(videoEntity: PlatformVideo.Video): Promise<void> {\n    if (!videoEntity) throw new Error(\"videoEntity undefined\");\n\n    const { images, filename } = videoEntity;\n\n    this.animator!.stop();\n    this.painter.clearSecondary();\n    this.resource!.release();\n    this.entity = videoEntity;\n\n    await this.resource!.loadImagesWithRecord(images, filename);\n  }\n\n  /**\n   * 开始播放事件回调\n   * @param frame\n   */\n  public onStart?: PlayerEventCallback;\n  /**\n   * 重新播放事件回调\n   * @param frame\n   */\n  public onResume?: PlayerEventCallback;\n  /**\n   * 暂停播放事件回调\n   * @param frame\n   */\n  public onPause?: PlayerEventCallback;\n  /**\n   * 停止播放事件回调\n   * @param frame\n   */\n  public onStop?: PlayerEventCallback;\n  /**\n   * 播放中事件回调\n   * @param percent\n   * @param frame\n   * @param frames\n   */\n  public onProcess?: PlayerProcessEventCallback;\n  /**\n   * 结束播放事件回调\n   * @param frame\n   */\n  public onEnd?: PlayerEventCallback;\n\n  /**\n   * 开始播放\n   */\n  public start(): void {\n    this.startAnimation();\n    this.onStart?.();\n  }\n\n  /**\n   * 重新播放\n   */\n  public resume(): void {\n    if (this.animator.resume()) {\n      this.onResume?.();\n    }\n  }\n\n  /**\n   * 暂停播放\n   */\n  public pause(): void {\n    if (this.animator.pause()) {\n      this.onPause?.();\n    }\n  }\n\n  /**\n   * 停止播放\n   */\n  public stop(): void {\n    this.animator.stop();\n    this.painter.clearContainer();\n    this.painter.clearSecondary();\n    this.onStop?.();\n  }\n\n  /**\n   * 销毁实例\n   */\n  public destroy(): void {\n    this.animator.stop();\n    this.painter.destroy();\n    this.renderer?.destroy();\n    this.resource?.release();\n    this.resource?.cleanup();\n    this.entity = undefined;\n  }\n\n  /**\n   * 跳转到指定帧\n   * @param frame 目标帧\n   * @param andPlay 是否立即播放\n   */\n  public stepToFrame(frame: number, andPlay = false) {\n    if (!this.entity || frame < 0 || frame >= this.entity.frames) return;\n\n    this.pause();\n    this.config.loopStartFrame = frame;\n    if (andPlay) {\n      this.start();\n    }\n  }\n\n  /**\n   * 跳转到指定百分比\n   * @param percent 目标百分比\n   * @param andPlay 是否立即播放\n   */\n  public stepToPercentage(percent: number, andPlay: boolean = false) {\n    if (!this.entity) return;\n\n    const { frames } = this.entity;\n    let frame = percent < 0 ? 0 : Math.round(percent * frames);\n\n    if (frame >= frames) {\n      frame = frames - 1;\n    }\n\n    debugger;\n    this.stepToFrame(frame, andPlay);\n  }\n\n  /**\n   * 开始绘制动画\n   */\n  private startAnimation(): void {\n    const { entity, config, animator, painter, renderer, resource } = this;\n    const { W, H } = painter;\n    const { fillMode, playMode, contentMode } = config;\n    const {\n      currFrame,\n      startFrame,\n      endFrame,\n      totalFrame,\n      spriteCount,\n      aniConfig,\n    } = config.getConfig(entity!);\n    const { duration, loopStart, loop, fillValue } = aniConfig;\n    const isReverseMode = playMode === PLAYER_PLAY_MODE.FALLBACKS;\n\n    // 当前帧\n    let currentFrame = currFrame;\n    // 片段绘制结束位置\n    let tail = 0;\n    let nextTail: number;\n    // 上一帧\n    let latestFrame: number;\n    // 下一帧\n    let nextFrame: number;\n    // 精确帧\n    let exactFrame: number;\n    // 当前已完成的百分比\n    let percent: number;\n    // 是否还有剩余时间\n    let hasRemained: boolean;\n\n    // 更新动画基础信息\n    animator.setConfig(duration, loopStart, loop, fillValue);\n    renderer!.resize(contentMode, entity!.size, { width: W, height: H });\n\n    // 分段渲染函数\n    const MAX_DRAW_TIME_PER_FRAME = 8;\n    const MAX_ACCELERATE_DRAW_TIME_PER_FRAME = 3;\n    const MAX_DYNAMIC_CHUNK_SIZE = 34;\n    const MIN_DYNAMIC_CHUNK_SIZE = 1;\n    // 动态调整每次绘制的块大小\n    let dynamicChunkSize = 4; // 初始块大小\n    let startTime: number;\n    let chunk: number;\n    let elapsed: number;\n    // 使用`指数退避算法`平衡渲染速度和流畅度\n    const patchDraw = (before: () => void) => {\n      startTime = platform.now();\n      before();\n\n      while (tail < spriteCount) {\n        // 根据当前块大小计算nextTail\n        chunk = Math.min(dynamicChunkSize, spriteCount - tail);\n        nextTail = (tail + chunk) | 0;\n        renderer!.render(\n          entity!,\n          resource!.materials,\n          resource!.dynamicMaterials,\n          currentFrame,\n          tail,\n          nextTail\n        );\n        tail = nextTail;\n        // 动态调整块大小\n        elapsed = platform.now() - startTime;\n\n        if (elapsed < MAX_ACCELERATE_DRAW_TIME_PER_FRAME) {\n          dynamicChunkSize = Math.min(\n            dynamicChunkSize * 2,\n            MAX_DYNAMIC_CHUNK_SIZE\n          ); // 加快绘制\n        } else if (elapsed > MAX_DRAW_TIME_PER_FRAME) {\n          dynamicChunkSize = Math.max(\n            dynamicChunkSize / 2,\n            MIN_DYNAMIC_CHUNK_SIZE\n          ); // 减慢绘制\n          break;\n        }\n      }\n    };\n\n    // 动画绘制过程\n    animator.onUpdate = (timePercent: number) => {\n      patchDraw(() => {\n        percent = isReverseMode ? 1 - timePercent : timePercent;\n        exactFrame = percent * totalFrame;\n\n        if (isReverseMode) {\n          nextFrame =\n            (timePercent === 0 ? endFrame : Math.ceil(exactFrame)) - 1;\n          // FIXME: 倒序会有一帧的偏差，需要校准当前帧\n          percent = currentFrame / totalFrame;\n        } else {\n          nextFrame = timePercent === 1 ? startFrame : Math.floor(exactFrame);\n        }\n\n        hasRemained = currentFrame === nextFrame;\n      });\n\n      if (hasRemained) return;\n\n      painter.clearContainer();\n      painter.stick();\n      painter.clearSecondary();\n      latestFrame = currentFrame;\n      currentFrame = nextFrame;\n      tail = 0;\n      this.onProcess?.(~~(percent * 100) / 100, latestFrame);\n    };\n    animator.onStart = () => {\n      entity!.locked = true;\n    };\n    animator.onEnd = () => {\n      entity!.locked = false;\n      // 如果不保留最后一帧渲染，则清空画布\n      if (fillMode === PLAYER_FILL_MODE.NONE) {\n        painter.clearContainer();\n      }\n\n      this.onEnd?.();\n    };\n    animator.start();\n  }\n}\n","import { Renderer2D, ResourceManager } from \"../../extensions\";\nimport { Painter } from \"../painter\";\nimport {\n  type PlatformVideo,\n  type PosterConfig,\n  type PosterConfigOptions,\n  PLAYER_CONTENT_MODE,\n} from \"../../types\";\n\nexport class Poster {\n  /**\n   * SVGA 元数据\n   * Video Entity\n   */\n  private entity: PlatformVideo.Video | undefined;\n\n  /**\n   * 海报配置项\n   */\n  private readonly config: PosterConfig = {\n    /**\n     * 主屏，绘制海报的 Canvas 元素\n     */\n    container: \"\",\n    /**\n     * 填充模式，类似于 content-mode。\n     */\n    contentMode: PLAYER_CONTENT_MODE.FILL,\n    /**\n     * 绘制成海报的帧，默认是0。\n     */\n    frame: 0,\n  };\n\n  /**\n   * 是否配置完成\n   */\n  private isConfigured = false;\n\n  /**\n   * 刷头实例\n   */\n  public readonly painter: Painter;\n\n  /**\n   * 资源管理器\n   */\n  public resource: ResourceManager | null = null;\n\n  /**\n   * 渲染器实例\n   */\n  private renderer: Renderer2D | null = null;\n\n  constructor(width: number, height: number) {\n    this.painter = new Painter(\"poster\", width, height);\n  }\n\n  /**\n   * 注册 SVGA 海报\n   * @param selector 容器选择器\n   * @param component 组件\n   */\n  private async register(\n    selector: string = \"\",\n    component?: any\n  ): Promise<void> {\n    await this.painter.register(selector, \"\", component);\n    this.renderer = new Renderer2D(this.painter.BC!);\n    this.resource = new ResourceManager(this.painter);\n  }\n\n  /**\n   * 设置配置项\n   * @param options 可配置项\n   */\n  public async setConfig(\n    options: string | PosterConfigOptions = {},\n    component?: any\n  ): Promise<void> {\n    if (typeof options === \"string\") {\n      this.config.container = options;\n    } else {\n      Object.assign(this.config, options);\n    }\n\n    this.isConfigured = true;\n    await this.register(this.config.container, component);\n  }\n\n  /**\n   * 修改内容模式\n   * @param contentMode\n   */\n  public setContentMode(contentMode: PLAYER_CONTENT_MODE): void {\n    this.config.contentMode = contentMode;\n  }\n\n  /**\n   * 设置当前帧\n   * @param frame\n   */\n  public setFrame(frame: number): void {\n    this.config.frame = frame;\n  }\n\n  /**\n   * 装载 SVGA 数据元\n   * @param videoEntity SVGA 数据源\n   * @param currFrame\n   * @returns\n   */\n  public async mount(videoEntity: PlatformVideo.Video): Promise<void> {\n    if (!videoEntity) {\n      throw new Error(\"videoEntity undefined\");\n    }\n\n    if (!this.isConfigured) {\n      await this.register();\n      this.isConfigured = true;\n    }\n\n    const { images, filename } = videoEntity;\n\n    this.painter.clearContainer();\n    this.resource!.release();\n    this.entity = videoEntity;\n\n    await this.resource!.loadImagesWithRecord(images, filename);\n  }\n\n  /**\n   * 绘制海报\n   */\n  public draw(): void {\n    if (!this.entity) return;\n\n    const { painter, renderer, resource, entity, config } = this;\n\n    renderer!.resize(config.contentMode, entity!.size, painter.F!);\n    renderer!.render(\n      entity!,\n      resource!.materials,\n      resource!.dynamicMaterials,\n      config.frame,\n      0,\n      entity!.sprites.length\n    );\n  }\n\n  /**\n   * 获取海报的 ImageData 数据\n   */\n  public toImageData(): ImageData {\n    const { FC, W: width, H: height } = this.painter;\n\n    return FC!.getImageData(0, 0, width, height);\n  }\n\n  /**\n   * 销毁海报\n   */\n  public destroy(): void {\n    this.painter.destroy();\n    this.renderer?.destroy();\n    this.resource?.release();\n    this.resource?.cleanup();\n    this.entity = undefined;\n  }\n}\n","import { platform } from \"../platform\";\nimport { PNGEncoder, QRCode } from \"../extensions\";\n\nexport interface IQrCodeImgOptions {\n  /**\n   * 二维码内容\n   */\n  code: string;\n  /**\n   * 二维码的大小\n   */\n  size: number;\n  /**\n   * 二维码的码元 二维码横向有多少个小点（1 - 40）\n   */\n  typeNumber?: number;\n  /**\n   * 二维码的纠错等级\n   * L: 7%（错误字码在 7% 以内可被修正, 容错率较低不建议使用）\n   * M: 15%（错误字码在 15% 以内可被修正, 容错率较低不建议使用）\n   * Q: 25%（错误字码在 25% 以内可被修正）\n   * H: 30%（错误字码在 30% 以内可被修正）\n   */\n  correctLevel?: \"L\" | \"M\" | \"Q\" | \"H\";\n  /**\n   * 二维码颜色，仅支持 六位的十六进制颜色值，暂不支持透明色 (仅对二维码生效)\n   */\n  codeColor?: string;\n  /**\n   * 二维码背景颜色，仅支持 六位的十六进制 颜色值。暂不支持透明色 (仅对二维码生效)\n   */\n  backgroundColor?: string;\n}\n\nfunction parseOptions(options: IQrCodeImgOptions) {\n  const typeNumber = options.typeNumber ?? 4;\n  const correctLevel = options.correctLevel ?? \"H\";\n  const codeColor = options.codeColor ?? \"#000000\";\n  const backgroundColor = options.backgroundColor ?? \"#FFFFFF\";\n\n  return {\n    code: options.code,\n    size: options.size,\n    typeNumber,\n    correctLevel,\n    codeColor,\n    backgroundColor,\n  };\n}\n\nconst calcCellSizeAndPadding = (moduleCount: number, size: number) => {\n  const cellSize = ~~(size / moduleCount);\n\n  return {\n    padding: ~~((size - moduleCount * cellSize) / 2),\n    cellSize: cellSize || 2,\n  };\n};\n\nexport function generateImageBufferFromCode(options: IQrCodeImgOptions) {\n  const { code, typeNumber, correctLevel, size, codeColor, backgroundColor } =\n    parseOptions(options);\n  let qr: QRCode;\n\n  try {\n    qr = new QRCode(typeNumber, correctLevel);\n    qr.addData(code);\n    qr.make();\n  } catch (e) {\n    if (typeNumber >= 40) {\n      throw new Error(\"Text too long to encode\");\n    }\n\n    return arguments.callee({\n      code,\n      size,\n      correctLevel,\n      typeNumber: typeNumber + 1,\n      codeColor,\n      backgroundColor,\n    });\n  }\n\n  // calc cellsize and margin\n  const moduleCount = qr.getModuleCount();\n  const { padding, cellSize } = calcCellSizeAndPadding(moduleCount, size);\n  const max = moduleCount * cellSize + padding;\n  const CODE_COLOR = +`${codeColor.replace(\"#\", \"0x\")}FF`;\n  const BACKGROUND_COLOR = +`${backgroundColor.replace(\"#\", \"0x\")}FF`;\n  const png = new PNGEncoder(size, size);\n\n  for (let y = 0; y < size; y++) {\n    for (let x = 0; x < size; x++) {\n      if (padding <= x && x < max && padding <= y && y < max) {\n        const c = ~~((x - padding) / cellSize);\n        const r = ~~((y - padding) / cellSize);\n\n        png.setPixel(x, y, qr.isDark(r, c) ? CODE_COLOR : BACKGROUND_COLOR);\n      } else {\n        png.setPixel(x, y, BACKGROUND_COLOR);\n      }\n    }\n  }\n\n  return png.flush();\n}\n\nexport function generateImageFromCode(options: IQrCodeImgOptions) {\n  const buff = generateImageBufferFromCode(options);\n\n  return platform.decode.toDataURL(buff);\n}\n","import { platform } from \"../platform\";\nimport { PNGEncoder } from \"../extensions\";\n\nexport function createBufferOfImageData(imageData: ImageData) {\n  const { width, height, data } = imageData;\n\n  return new PNGEncoder(width, height).write(data).flush();\n}\n\n/**\n * @deprecated 请使用 createBufferOfImageData 代替，此方法可能在后续版本中移除\n */\nexport const getBufferFromImageData = createBufferOfImageData;\n\nexport function createImageDataUrl(imageData: ImageData) {\n  const buff = createBufferOfImageData(imageData);\n\n  return platform.decode.toDataURL(buff);\n}\n\n/**\n * @deprecated 请使用 createImageDataUrl 代替，此方法可能在后续版本中移除\n */\nexport const getDataURLFromImageData = createImageDataUrl;\n","import { platform } from \"../platform\";\nimport { Parser } from \"../core/parser\";\nimport type { PlatformVideo } from \"../types/video\";\n\nexport interface Bucket {\n  // 远程地址\n  origin: string;\n  // 本地地址\n  local: string;\n  // 实例\n  entity: PlatformVideo.Video | null;\n  // 下载实例中\n  promise: Promise<ArrayBufferLike> | null;\n}\n\nexport interface NeedUpdatePoint {\n  action: \"remove\" | \"add\";\n  start: number;\n  end: number;\n}\n\nexport type LoadMode = \"fast\" | \"whole\";\n\nexport interface VideoManagerOptions {\n  preprocess: (bucket: Bucket) => Promise<ArrayBufferLike>;\n  postprocess: (\n    bucket: Bucket,\n    buff: ArrayBufferLike\n  ) => Promise<PlatformVideo.Video> | PlatformVideo.Video;\n  cleanup: (buckets: Bucket[]) => Promise<void> | void;\n}\n\nexport class VideoManager {\n  /**\n   * 视频池的当前指针位置\n   */\n  private point: number = 0;\n  /**\n   * 视频的最大留存数量，其他视频将放在磁盘上缓存\n   */\n  private maxRemain: number = 3;\n  /**\n   * 留存视频的开始指针位置\n   */\n  private remainStart: number = 0;\n  /**\n   * 留存视频的结束指针位置\n   */\n  private remainEnd: number = 0;\n  /**\n   * 视频加载模式\n   * - 快速加载模式：可保证当前视频加载完成后，尽快播放；其他请求将使用Promise的方式保存在bucket中，以供后续使用\n   * - 完整加载模式：可保证所有视频加载完成，确保播放切换的流畅性\n   */\n  private loadMode: LoadMode = \"fast\";\n  /**\n   * 视频池的所有数据\n   */\n  private buckets: Bucket[] = [];\n\n  private readonly options: VideoManagerOptions = {\n    /**\n     * 预处理动效数据\n     * @param url\n     * @returns\n     */\n    preprocess: (bucket: Bucket) => Parser.download(bucket.origin),\n    /**\n     * 后处理动效数据\n     * @param bucket\n     * @param data\n     * @returns\n     */\n    postprocess: (bucket: Bucket, data: ArrayBufferLike) =>\n      Parser.parseVideo(data, bucket.origin, true),\n    /**\n     * 清理数据\n     * @param buckets\n     * @returns\n     */\n    cleanup: (buckets: Bucket[]) => {\n      const { globals, local, path } = platform;\n\n      buckets.forEach((bucket: Bucket) => {\n        if (path.is(bucket.local)) {\n          local!.remove(bucket.local);\n        }\n      });\n    },\n  };\n\n  /**\n   * 获取视频池大小\n   */\n  get size(): number {\n    return this.buckets.length;\n  }\n\n  constructor(loadMode: LoadMode, options?: Partial<VideoManagerOptions>) {\n    if (typeof loadMode === \"string\") {\n      this.loadMode = loadMode;\n    }\n\n    Object.assign(this.options, options);\n  }\n\n  /**\n   * 更新留存指针位置\n   */\n  private updateRemainRange(\n    point: number,\n    maxRemain: number,\n    totalCount: number\n  ): void {\n    if (point < 0) {\n      this.point = 0;\n    } else if (point >= totalCount) {\n      this.point = totalCount - 1;\n    } else {\n      this.point = point;\n    }\n\n    if (this.loadMode === \"whole\") {\n      this.remainStart = 0;\n      this.remainEnd = totalCount;\n    } else {\n      if (maxRemain < 1) {\n        this.maxRemain = 1;\n      } else if (maxRemain > totalCount) {\n        this.maxRemain = totalCount;\n      } else {\n        this.maxRemain = maxRemain;\n      }\n\n      this.remainStart = this.point - Math.floor(this.maxRemain / 2);\n      if (this.remainStart < 0) {\n        this.remainStart = totalCount + this.remainStart;\n      }\n\n      this.remainEnd = this.remainStart + this.maxRemain;\n      if (this.remainEnd > totalCount) {\n        this.remainEnd = this.remainEnd % totalCount;\n      }\n    }\n  }\n\n  /**\n   * 指针是否在留存空间内\n   * @param point\n   * @returns\n   */\n  private includeRemainRange(point: number): boolean {\n    if (this.remainStart < this.remainEnd) {\n      return point >= this.remainStart && point < this.remainEnd;\n    }\n\n    if (this.remainStart > this.remainEnd) {\n      return point >= this.remainStart || point < this.remainEnd;\n    }\n\n    return true;\n  }\n\n  private async downloadAndParseVideo(\n    bucket: Bucket,\n    needParse?: false\n  ): Promise<ArrayBuffer>;\n  private async downloadAndParseVideo(\n    bucket: Bucket,\n    needParse: true\n  ): Promise<PlatformVideo.Video>;\n  private async downloadAndParseVideo(\n    bucket: Bucket,\n    needParse: boolean = false\n  ) {\n    const { options } = this;\n    const data = await options.preprocess(bucket);\n\n    if (needParse) {\n      return options.postprocess(bucket, data);\n    }\n\n    return data;\n  }\n\n  /**\n   * 创建bucket\n   * @param url 远程地址\n   * @param point 指针位置\n   * @param needDownloadAndParse 是否需要下载并解析\n   * @returns\n   */\n  private async createBucket(\n    url: string,\n    point: number,\n    needDownloadAndParse: boolean\n  ): Promise<Bucket> {\n    const { path } = platform;\n    const bucket: Bucket = {\n      origin: url,\n      local: path.resolve(path.filename(url)),\n      entity: null,\n      promise: null,\n    };\n\n    this.buckets[point] = bucket;\n    if (needDownloadAndParse) {\n      bucket.entity = await this.downloadAndParseVideo(bucket, true);\n    } else if (this.includeRemainRange(point)) {\n      bucket.promise = this.downloadAndParseVideo(bucket);\n    }\n\n    return bucket;\n  }\n\n  /**\n   * 预加载视频到本地磁盘中\n   * @param urls 视频远程地址\n   * @param point 当前指针位置\n   * @param maxRemain 最大留存数量\n   */\n  async prepare(\n    urls: string[],\n    point: number = 0,\n    maxRemain: number = 3\n  ): Promise<void> {\n    this.updateRemainRange(point, maxRemain, urls.length);\n\n    const { loadMode, point: currentPoint } = this;\n    // 优先加载当前动效\n    const preloadBucket: Bucket = await this.createBucket(\n      urls[currentPoint],\n      currentPoint,\n      true\n    );\n\n    await Promise.all(\n      urls.map((url: string, index: number) => {\n        // 当前帧的视频已经预加载到内存中\n        if (index === currentPoint) {\n          return preloadBucket;\n        }\n\n        return this.createBucket(url, index, loadMode === \"whole\");\n      })\n    );\n  }\n\n  /**\n   * 获取当前帧的bucket\n   * @returns\n   */\n  async get(): Promise<Bucket> {\n    const bucket = this.buckets[this.point];\n\n    if (bucket.promise) {\n      bucket.entity = await bucket.promise.then((data: ArrayBufferLike) =>\n        this.options.postprocess(bucket, data)\n      );\n      bucket.promise = null;\n    } else if (!bucket.entity) {\n      bucket.entity = await this.downloadAndParseVideo(bucket, true);\n    }\n\n    return bucket;\n  }\n\n  /**\n   * 获取当前的指针位置\n   * @returns\n   */\n  getPoint(): number {\n    return this.point;\n  }\n\n  /**\n   * 获取指定位置的bucket\n   * @param pos\n   * @returns\n   */\n  async go(point: number): Promise<Bucket> {\n    const { size, buckets, loadMode } = this;\n\n    if (point < 0 || point >= size) {\n      return buckets[this.point];\n    }\n\n    this.updateRemainRange(point, this.maxRemain, buckets.length);\n    if (loadMode === \"fast\" && this.maxRemain !== buckets.length) {\n      buckets.forEach((bucket: Bucket, index: number) => {\n        if (this.includeRemainRange(index)) {\n          if (bucket.entity === null && bucket.promise === null) {\n            bucket.promise = this.downloadAndParseVideo(bucket);\n          }\n        } else {\n          bucket.entity = null;\n          bucket.promise = null;\n        }\n      });\n    }\n\n    return this.get();\n  }\n\n  /**\n   * 清理所有的bucket\n   * @returns\n   */\n  async clear(needRemoveFiles: boolean = true): Promise<void> {\n    const { buckets } = this;\n\n    this.point = 0;\n    this.remainStart = 0;\n    this.remainEnd = 0;\n    this.maxRemain = 3;\n    this.buckets = [];\n\n    if (needRemoveFiles) {\n      await this.options.cleanup(buckets);\n    }\n  }\n}\n","import type { RawImage, PlatformImage } from \"octopus-platform\";\nimport { platform } from \"../platform\";\nimport { Parser } from \"../core/parser\";\nimport { generateImageBufferFromCode, IQrCodeImgOptions } from \"./qrcode\";\nimport { createBufferOfImageData } from \"./png\";\nimport type { ResourceManager } from \"../extensions\";\nimport type { Painter } from \"../core/painter\";\nimport type { PlatformVideo, PlatformRenderingContext2D } from \"../types\";\n\ninterface VideoEditorOptions {\n  // 模式: R 替换, A 追加\n  mode?: \"R\" | \"A\";\n}\n\nexport class VideoEditor {\n  constructor(\n    private readonly painter: Painter,\n    private readonly resource: ResourceManager,\n    private readonly entity: PlatformVideo.Video\n  ) {}\n\n  private async set(\n    key: string,\n    value: RawImage,\n    mode: VideoEditorOptions[\"mode\"] = \"R\"\n  ) {\n    const { entity, resource } = this;\n\n    if (mode === \"A\") {\n      await resource.loadImagesWithRecord(\n        { [key]: value },\n        entity.filename,\n        \"dynamic\"\n      );\n    } else {\n      entity.images[key] = value;\n    }\n  }\n\n  /**\n   * 获取自定义编辑器\n   * @returns\n   */\n  getContext() {\n    return this.painter.BC;\n  }\n\n  /**\n   * 是否是有效的Key\n   * @param key\n   * @returns\n   */\n  hasValidKey(key: string): boolean {\n    const { images } = this.entity;\n\n    if (typeof Object.hasOwn === \"function\") {\n      return Object.hasOwn(images, key);\n    }\n\n    return Object.prototype.hasOwnProperty.call(images, key);\n  }\n\n  /**\n   * 加载并缓存图片\n   * @param source\n   * @param url\n   * @returns\n   */\n  loadImage(\n    source: Uint8Array | string,\n    url: string\n  ): Promise<PlatformImage | ImageBitmap> {\n    return this.resource.loadExtImage(source, platform.path.filename(url));\n  }\n\n  /**\n   * 创建画布图片\n   * @param key\n   * @param context\n   * @param options\n   * @returns\n   */\n  async setCanvas(\n    key: string,\n    context: PlatformRenderingContext2D,\n    options?: VideoEditorOptions & { width?: number; height?: number }\n  ) {\n    if (this.entity.locked) return;\n\n    const { canvas } = context;\n    const width = options?.width ?? canvas.width;\n    const height = options?.height ?? canvas.height;\n    const imageData = context.getImageData(0, 0, width, height);\n\n    await this.set(\n      key,\n      new Uint8Array(createBufferOfImageData(imageData)),\n      options?.mode\n    );\n  }\n\n  /**\n   * 创建二进制图片\n   * @param key\n   * @param buff\n   * @param options\n   * @returns\n   */\n  async setImage(key: string, url: string, options?: VideoEditorOptions) {\n    if (this.entity.locked) return;\n\n    if (url.startsWith(\"data:image\")) {\n      await this.set(key, url, options?.mode);\n    } else {\n      await this.set(\n        key,\n        new Uint8Array(await Parser.download(url)),\n        options?.mode\n      );\n    }\n  }\n\n  /**\n   * 创建二维码图片\n   * @param key\n   * @param code\n   * @param options\n   * @returns\n   */\n  async setQRCode(\n    key: string,\n    code: string,\n    options: VideoEditorOptions & Omit<IQrCodeImgOptions, \"code\">\n  ) {\n    if (this.entity.locked) return;\n\n    await this.set(\n      key,\n      new Uint8Array(generateImageBufferFromCode({ ...options, code })),\n      options?.mode\n    );\n  }\n}\n","/**\n * 检查数据是否为zlib压缩格式\n * @param data 待检查的二进制数据\n * @returns 是否为zlib压缩格式\n */\nexport function isZlibCompressed(data: Uint8Array): boolean {\n  // 检查数据长度是否足够（至少需要2字节头部和4字节ADLER-32校验和）\n  if (data.length < 6) {\n    return false\n  }\n\n  // 获取CMF和FLG字节\n  const cmf = data[0]\n  const flg = data[1]\n\n  // 检查CMF的压缩方法（低4位为8表示DEFLATE）\n  // eslint-disable-next-line no-bitwise\n  if ((cmf & 0x0F) !== 8) {\n    return false\n  }\n\n  // 检查窗口大小（高4位通常为7，但不是严格要求）\n  // 这里不强制检查，因为理论上可以是其他值\n\n  // 验证头部校验（CMF * 256 + FLG必须是31的倍数）\n  if (((cmf * 256 + flg) % 31) !== 0) {\n    return false\n  }\n\n  // 检查字典标志位（如果设置了字典，需要额外验证，但这种情况很少见）\n  // eslint-disable-next-line no-bitwise\n  const fdict = (flg & 0x20) !== 0\n  if (fdict) {\n    // 标准zlib压缩通常不使用预定义字典\n    // 这里假设不使用字典，若检测到字典标志则认为不是标准zlib格式\n    return false\n  }\n\n  // 尝试提取ADLER-32校验和并验证其格式\n  // 虽然无法验证校验和值（需要解压后计算），但可以检查其是否为合理的数值\n  const adler32Bytes = data.slice(-4)\n\n  if (adler32Bytes.length !== 4) {\n    return false\n  }\n\n  // eslint-disable-next-line no-bitwise\n  const adler32 = (adler32Bytes[0] << 24) | (adler32Bytes[1] << 16) | (adler32Bytes[2] << 8) | adler32Bytes[3]\n\n  // 有效的ADLER-32值应大于0（除非是空数据）\n  if (data.length > 2 && adler32 === 0) {\n    return false\n  }\n\n  // 所有检查都通过，数据可能是zlib压缩格式\n  return true\n}\n"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","SuppressedError","noop","EnhancedPlatform","_OctopusPlatform","_this","_classCallCheck","_callSuper","this","pluginSelector","pluginCanvas","pluginOfsCanvas","pluginDecode","pluginDownload","pluginFsm","pluginImage","pluginNow","pluginPath","pluginRAF","__VERSION__","init","_inherits","_createClass","key","plugin","installPlugin","platform","ResourceManager","painter","caches","dynamicMaterials","Map","materials","point","img","shift","image","create","F","push","isBitmap","source","filename","load","createImage","path","inertBitmapIntoCaches","images_1","filename_1","arguments","images","_this2","type","length","undefined","_regenerator","m","_callee","imageAwaits","imageFilename","w","_context","n","concat","replace","Object","entries","forEach","_ref","_ref2","_slicedToArray","name","Uint8Array","byteLength","p","set","all","a","_step","_iterator","_createForOfIteratorHelper","s","releaseOne","err","f","clear","globals","env","cleanup","tidyUp","Array","from","Set","ImageBitmap","close","src","includes","USER_DATA_PATH","local","remove","release","dataViewPool","currentViewIndex","readFloatLE","fill","map","DataView","ArrayBuffer","buf","pos","RangeError","view","u8","buffer","getFloat32","Preflight","count","get","size","reader","end","startPos","endPos","Math","min","len","buff","start","hash","i","toString","calculateHash","max","floor","hit","has","Reader","preflight","writeLength","byte","indexOutOfRange","readVarint32Slow","uint32","_this$getBytesRange2","getBytesRange","EMPTY_UINT8ARRAY","subarray","_this$getBytesRange4","decode","utf8","Error","wireType","skip","skipType","Layout","x","y","width","height","calculate","tag","message","float","format","_message$x","_message$y","_message$width","_message$height","Transform","b","c","d","tx","ty","ShapeArgs","string","RectArgs","cornerRadius","EllipseArgs","radiusX","radiusY","RGBAColor","r","g","ShapeStyle","stroke","strokeWidth","lineCap","lineJoin","miterLimit","lineDashI","lineDashII","lineDashIII","int32","lineDash","ShapeEntity","shape","rect","ellipse","styles","transform","FrameEntity","shapes","alpha","layout","clipPath","HIDDEN_FRAME","SpriteEntity","frames","imageKey","matteKey","MovieParams","viewBoxWidth","viewBoxHeight","fps","MovieEntity","version","params","sprites","end2","tag2","EMPTY_U8","bytes","_message$params","locked","dynamicElements","PointPool","pool","pop","x1","y1","x2","y2","Renderer2D","context","pointPool","lastResizeKey","globalTransform","currentPoint","acquire","save","resetShapeStyles","setTransform","beginPath","parseSVGPath","_step$value","command","args","SVG_PATH","drawBezierElement","split","filter","Boolean","fillOrStroke","restore","method","moveTo","lineTo","bezierCurveTo","quadraticCurveTo","closePath","h","kappa","ox","oy","xe","ye","xm","ym","radius","arcTo","drawBezier","drawEllipse","_a","_b","_c","_d","drawRect","_e","_f","_g","_h","_j","frame","bitmap","dynamicElement","_ref$a","_ref$b","_ref$c","_ref$d","_ref$tx","_ref$ty","globalAlpha","drawImage","drawShape","contentMode","videoSize","canvasSize","canvasWidth","canvasHeight","videoWidth","videoHeight","resizeKey","lastTransform","scale","scaleX","scaleY","translateX","translateY","calculateScale","videoEntity","currentFrame","head","tail","sprite","drawSprite","SVG_LETTER_REGEXP","currentIndex","state","currentCommand","currentArgs","char","test","trim","strokeStyle","lineWidth","fillStyle","setLineDash","imageRatio","viewRatio","isAspectFit","createTransform","Animator","isRunning","startTime","duration","loopStart","pauseTime","loopDuration","onAnimate","onStart","onUpdate","onEnd","loop","fillValue","now","doFrame","doDeltaTime","deltaTime","percent","ended","stop","u16","Uint16Array","i32","Int32Array","fleb","fdeb","clim","freb","eb","j","_freb","fl","revfl","_freb2","fd","revfd","rev","hMap","cd","mb","l","co","le","rvb","sv","v","flt","fdt","flm","flrm","fdm","fdrm","bits","o","bits16","shft","slc","ec","ind","msg","nt","code","captureStackTrace","wbits","wbits16","hTree","t","t2","slice","et","sort","i0","i1","i2","maxSym","tr","mbt","ln","dt","lft","cst","lc","cl","cli","cln","cls","clen","cf","wfblk","out","dat","wblk","final","syms","lf","df","li","bs","bl","_hTree","dlt","mlb","_hTree2","ddt","mdb","_lc","lclt","nlc","_lc2","lcdt","ndc","lcfreq","_hTree3","lct","mlcb","nlcc","lm","ll","dm","dl","flen","ftlen","dtlen","llm","lcts","it","clct","sym","dst","deo","adler","dopt","opt","pre","post","st","dictionary","dict","newDat","lvl","plvl","z","ceil","lst","msk","prev","bs1","bs2","hsh","wi","hv","imod","pimod","rem","ch","dif","maxn","maxd","ml","nl","mmd","md","ti","lin","din","dflt","level","mem","log","wbytes","zlibSync","data","opts","lv","zlh","unzlibSync","sl","noBuf","resize","noSt","cbuf","nbuf","bt","lbt","dbt","tbts","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","lms","dms","lpos","add","dsym","dend","inflt","CRC32","TypeError","bytesToString","crc","WHITE_COLOR","table","Uint32Array","_","PNGEncoder","crc32","setUint32","chunkType","charCodeAt","partialChunk","ihdrData","setUint8","createChunk","startIdx","srcStart","validRowSize","rowSize","pixelsData","pixel","pixels","setPixel","iHDRChunk","createIHDRChunk","iDATChunk","createIDATChunk","iENDChunk","pngData","offset","BitBuffer","lengthInBits","bufIndex","num","putBit","bit","QRMode","QRErrorCorrectLevel","L","M","Q","H","QRMaskPattern","BitByte","parsedData","byteArray","flat","unshift","put","RS_BLOCK_TABLE","RSBlock","typeNumber","errorCorrectLevel","rsBlock","getRSBlockTable","list","totalCount","dataCount","EXP_TABLE","LOG_TABLE","QRMath","Polynomial","glog","gexp","getAt","ratio","mod","PATTERN_POSITION_TABLE","genBCHDigit","log2","BCH_G15","BCH_G18","Util","maskPattern","_i","errorCorrectLength","multiply","mode","MODE_NUMBER","MODE_ALPHA_NUM","MODE_8BIT_BYTE","MODE_KANJI","qr","moduleCount","getModuleCount","lostPoint","row","col","dark","isDark","sameCount","nRow","nCol","darkCount","abs","pow","QRCode","modules","dataCache","dataList","setupPositionProbePattern","setupPositionAdjustPattern","setupTimingPattern","setupTypeInfo","setupTypeNumber","createData","mapData","nr","nc","minLostPoint","pattern","makeImpl","rsBlocks","getRSBlocks","write","totalDataCount","createBytes","maskFunc","inc","bitIndex","byteIndex","bitBuffer","dcdata","ecdata","maxDcCount","maxEcCount","dcCount","ecCount","rsPoly","modPoly","modIndex","totalCodeCount","index","getBestMaskPattern","Parser","url","video","createVideoEntity","decompress","remote","supportLocal","filepath","is","exists","read","fetch","_t","console","error","_context2","download","_t3","_t4","_t2","parseVideo","call","_callee2","Painter","FC","B","BC","model","clearContainer","clearSecondary","dpr","W","navigator","userAgent","selector","ofsSelector","component","getCanvas","getOfsCanvas","globalThis","_getOfsCanvas","canvas","setActionModel","_yield$getCanvas","clearRect","stick","ofsResult","_getOfsCanvas2","Config","fillMode","playMode","startFrame","endFrame","loopStartFrame","config","register","_defineProperty","entity","spriteCount","frameDuration","currFrame","extFrame","totalFrame","aniConfig","Infinity","Player","resource","animator","renderer","options","container","secondary","rAF","bind","setItem","loadImagesWithRecord","startAnimation","resume","onResume","pause","onPause","onStop","destroy","andPlay","round","stepToFrame","nextTail","latestFrame","nextFrame","exactFrame","hasRemained","_config$getConfig","getConfig","isReverseMode","setConfig","chunk","elapsed","dynamicChunkSize","timePercent","before","render","patchDraw","onProcess","Poster","isConfigured","assign","_context3","_callee3","_this$painter","getImageData","generateImageBufferFromCode","_parseOptions","correctLevel","codeColor","backgroundColor","parseOptions","addData","make","callee","_calcCellSizeAndPaddi","cellSize","padding","calcCellSizeAndPadding","CODE_COLOR","BACKGROUND_COLOR","png","flush","createBufferOfImageData","imageData","getBufferFromImageData","createImageDataUrl","toDataURL","getDataURLFromImageData","VideoManager","loadMode","maxRemain","remainStart","remainEnd","buckets","preprocess","bucket","origin","postprocess","bucket_1","needParse","needDownloadAndParse","promise","downloadAndParseVideo","includeRemainRange","urls_1","urls","preloadBucket","updateRemainRange","createBucket","_context4","_this3","_callee4","_context5","_this4","_callee5","_this5","needRemoveFiles","_callee6","_context6","VideoEditor","key_1","value_1","hasOwn","prototype","hasOwnProperty","loadExtImage","startsWith","_t5","_t6","exports","generateImageFromCode","isZlibCompressed","cmf","flg","adler32Bytes","adler32","defineProperty"],"mappings":"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C,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,EAAG,IAAK,IAAK,EAAG,IAAK,KACtB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,EAAG,IAAK,IAAK,GAAI,IAAK,KACvB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,EAAG,IAAK,IAAK,EAAG,IAAK,KACtB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,EAAG,IAAK,IAAK,GAAI,IAAK,KACvB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,IAAK,IAAK,EAAG,IAAK,KACvB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,IAAK,KACV,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,IAAK,IAAK,EAAG,IAAK,KACvB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,IAAK,IAAK,EAAG,IAAK,KACvB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,I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","x_google_ignoreList":[0]}