{"version":3,"file":"index.js","sources":["../src/platform.ts","../src/index.ts"],"sourcesContent":["import {\n  OctopusPlatform,\n  installPlugin,\n  type OctopusPlatformPlugins,\n  type OctopusPlatformPluginOptions,\n  pluginNow,\n} from \"octopus-platform\";\n\nexport type PlatformProperties = \"now\";\n\nclass EnhancedPlatform extends OctopusPlatform<PlatformProperties> {\n  now!: OctopusPlatformPlugins[\"now\"];\n\n  constructor() {\n    super([pluginNow], __VERSION__);\n\n    this.init();\n  }\n\n  installPlugin(plugin: OctopusPlatformPluginOptions<PlatformProperties>) {\n    installPlugin<PlatformProperties>(this, plugin);\n  }\n}\n\nexport const platform = new EnhancedPlatform();\n","import { platform } from \"./platform\";\n\nconst logBadge = [\n  \"%cBENCHMARK\",\n  \"padding: 2px 4px; background: #68B984; color: #FFFFFF; border-radius: 4px;\",\n];\nconst infoBadge = [\n  \"%cBENCHMARK\",\n  \"padding: 2px 4px; background: #89CFF0; color: #FFFFFF; border-radius: 4px;\",\n]\n\nclass Stopwatch {\n  private readonly timeLabels: Map<string, number> = new Map();\n\n  private readonly markLabels: Map<string, number> = new Map();\n\n  start(label: string) {\n    this.timeLabels.set(label, platform.now());\n  }\n\n  stop(label: string) {\n    const nowTime = platform.now();\n    const { timeLabels } = this;\n\n    if (timeLabels.has(label)) {\n      console.log(`${label}: ${nowTime - timeLabels.get(label)!} ms`);\n      timeLabels.delete(label);\n    }\n  }\n\n  mark(label: string) {\n    const nowTime = platform.now();\n    const { markLabels } = this;\n\n    if (markLabels.has(label)) {\n      console.log(`${label}: ${nowTime - markLabels.get(label)!} ms`);\n    }\n\n    markLabels.set(label, nowTime);\n  }\n\n  reset(label: string) {\n    this.markLabels.delete(label);\n  }\n\n  clear() {\n    this.timeLabels.clear();\n    this.markLabels.clear();\n  }\n}\n\nexport interface Benchmark extends Stopwatch {\n  now: () => number;\n  time: <T extends any = any>(\n    label: string,\n    callback: () => Promise<T> | T\n  ) => Promise<T>;\n  line: (size: number) => void;\n  log: (...message: unknown[]) => void;\n  info: (...message: unknown[]) => void;\n}\n\nconst stopwatch = new Stopwatch();\nconst benchmark: Benchmark = Object.create(stopwatch);\n\nbenchmark.now = () => platform.now();\n\nbenchmark.time = async (label, callback) => {\n  stopwatch.start(label);\n  const result = await callback();\n  stopwatch.stop(label);\n\n  return result;\n};\n\nbenchmark.line = (size = 40) => {\n  console.log(\"-\".repeat(size));\n};\n\nbenchmark.log = (...message) => {\n  console.log(...logBadge, ...message);\n};\n\nbenchmark.info = (...message) => {\n  console.info(...infoBadge, ...message);\n};\n\nexport { benchmark };\n"],"names":[],"mappings":"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"}