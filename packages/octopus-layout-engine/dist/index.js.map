{"version":3,"file":"index.js","sources":["../../src/types/index.ts","../../src/core/LayoutContext.ts","../../src/core/LayoutNode.ts","../../src/core/LayoutRenderer.ts","../../src/core/LayoutEngine.ts"],"sourcesContent":[null,null,null,null,null],"names":["NodeType","TextAlign","VerticalAlign","FlexDirection","JustifyContent","AlignItems","FlexWrap","LayoutContext","context","constructor","this","calculateLayout","node","measure","style","display","calculateFlexLayout","calculateFlowLayout","rect","children","length","flexDirection","ROW","justifyContent","FLEX_START","alignItems","flexWrap","NOWRAP","paddingLeft","paddingTop","paddingRight","paddingBottom","innerWidth","width","innerHeight","height","isHorizontal","ROW_REVERSE","mainAxisSize","crossAxisSize","isReverse","COLUMN_REVERSE","totalFixedMainSize","child","childStyle","childRect","flexGrow","flexShrink","mainSize","marginMain","marginLeft","marginRight","marginTop","marginBottom","remainingSpace","mainAxisPos","FLEX_END","CENTER","SPACE_BETWEEN","SPACE_AROUND","SPACE_EVENLY","crossSize","childMainPos","childCrossPos","STRETCH","childX","childY","finalX","x","finalY","y","setPosition","currentY","currentLineHeight","Math","max","measureText","text","fontSize","fontFamily","maxWidth","lineHeight","lines","actualLineHeight","font","metrics","breakTextIntoLines","words","split","currentLine","maxLineWidth","i","word","testLine","push","measureCJKText","breakCJKTextIntoLines","chars","Array","from","char","LayoutNode","type","content","parent","textMetrics","options","map","childOptions","getTextMetrics","setTextMetrics","LayoutRenderer","devicePixelRatio","canvas","scale","clear","clearRect","render","rootNode","renderNode","getCanvas","getContext","backgroundColor","fillStyle","fillRect","TEXT","renderText","IMAGE","renderImage","color","textBaseline","textAlign","line","fillText","image","Image","onload","drawImage","src","LayoutEngine","renderer","createLayoutTree","layout","Error","layoutAndRender"],"mappings":"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"}